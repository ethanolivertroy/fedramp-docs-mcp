{
  "$schema": "./evidence-examples.schema.json",
  "disclaimer": "These evidence examples are community suggestions to help with FedRAMP compliance automation. They are NOT official FedRAMP guidance. Always verify requirements with official FedRAMP documentation at https://fedramp.gov",
  "version": "1.0.0",
  "lastUpdated": "2025-12-29",
  "examples": {
    "KSI-AFR-01": {
      "name": "Minimum Assessment Scope",
      "evidence": [
        {
          "type": "documentation",
          "description": "System boundary documentation",
          "sources": [
            {"provider": "manual", "artifact": "System Security Plan (SSP) boundary diagrams"},
            {"provider": "aws", "command": "aws organizations describe-organization", "description": "AWS Organization structure"},
            {"provider": "azure", "command": "az account list --query '[].{name:name,id:id}'", "description": "Azure subscription inventory"}
          ]
        },
        {
          "type": "inventory",
          "description": "Asset inventory within assessment scope",
          "sources": [
            {"provider": "aws", "command": "aws resourcegroupstaggingapi get-resources --tag-filters Key=FedRAMP,Values=InScope", "description": "Tagged in-scope resources"},
            {"provider": "azure", "command": "az resource list --tag FedRAMP=InScope", "description": "Tagged Azure resources"}
          ]
        }
      ]
    },
    "KSI-AFR-02": {
      "name": "Key Security Indicators",
      "evidence": [
        {
          "type": "report",
          "description": "KSI implementation tracking",
          "sources": [
            {"provider": "manual", "artifact": "KSI compliance matrix with status for each indicator"},
            {"provider": "api", "description": "This MCP server's analyze_control_coverage output"}
          ]
        }
      ]
    },
    "KSI-AFR-03": {
      "name": "Authorization Data Sharing",
      "evidence": [
        {
          "type": "configuration",
          "description": "Data sharing agreements and configurations",
          "sources": [
            {"provider": "manual", "artifact": "Authorization Data Sharing (ADS) agreements"},
            {"provider": "aws", "command": "aws ram list-resources --resource-owner SELF", "description": "AWS Resource Access Manager shares"}
          ]
        }
      ]
    },
    "KSI-AFR-04": {
      "name": "Vulnerability Detection and Response",
      "evidence": [
        {
          "type": "scan",
          "description": "Vulnerability scan results",
          "tip": "Scans must cover all assets: VMs, containers, serverless, and web apps. FedRAMP requires authenticated scanning for accurate results. Verify scan coverage matches your asset inventory.",
          "sources": [
            {"provider": "gcp", "command": "gcloud scc findings list --organization=<org> --filter='category=\"VULNERABILITY\"' --format='table(finding.name,finding.severity,finding.state)'", "description": "GCP Security Command Center vulnerability findings"},
            {"provider": "gcp", "api": "containeranalysis.googleapis.com/v1/projects/{project}/occurrences?filter=kind=\"VULNERABILITY\"", "description": "GCP Container Analysis API vulnerabilities"},
            {"provider": "gcp", "command": "gcloud artifacts docker images list <repo> --include-tags --show-occurrences --occurrence-filter='kind=\"VULNERABILITY\"'", "description": "GCP Artifact Registry container vulnerabilities"},
            {"provider": "aws", "command": "aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}'", "description": "AWS Inspector findings"},
            {"provider": "azure", "command": "az security assessment list --query '[?status.code==`Unhealthy`].{name:displayName,severity:metadata.severity,resource:resourceDetails.Id}'", "description": "Azure Defender assessments"},
            {"provider": "qualys", "api": "/api/2.0/fo/scan/", "description": "Qualys scan results"},
            {"provider": "nessus", "api": "/scans/{scan_id}/export", "description": "Nessus scan export"},
            {"provider": "trivy", "command": "trivy image --format json <image>", "description": "Container vulnerability scan"},
            {"provider": "snyk", "api": "/org/{orgId}/projects", "description": "Snyk vulnerability findings across projects"}
          ]
        },
        {
          "type": "metrics",
          "description": "Vulnerability remediation SLA compliance",
          "tip": "FedRAMP remediation SLAs: Critical/High within 30 days, Medium within 90 days, Low within 180 days. Track Mean Time to Remediate (MTTR) and percentage meeting SLA.",
          "sources": [
            {"provider": "gcp", "api": "securitycenter.googleapis.com/v1/organizations/{org}/findings?filter=state=\"ACTIVE\" AND category=\"VULNERABILITY\"", "description": "GCP SCC open vulnerability count over time"},
            {"provider": "jira", "api": "/rest/api/3/search?jql=labels=vulnerability", "description": "Vulnerability remediation tickets"},
            {"provider": "servicenow", "api": "/api/now/table/sn_vul_vulnerable_item", "description": "ServiceNow vulnerability records"},
            {"provider": "defectdojo", "api": "/api/v2/findings/?active=true", "description": "DefectDojo active findings with SLA tracking"}
          ]
        },
        {
          "type": "report",
          "description": "Vulnerability trending and risk posture",
          "tip": "Demonstrate risk reduction over time. Show trending charts of open vulnerabilities by severity. Sudden spikes may indicate new attack surface or scanning gaps.",
          "sources": [
            {"provider": "gcp", "command": "gcloud scc findings list --organization=<org> --filter='category=\"VULNERABILITY\" AND state=\"ACTIVE\"' --format='table(finding.severity)' | sort | uniq -c", "description": "GCP vulnerability severity distribution"},
            {"provider": "aws", "command": "aws inspector2 list-finding-aggregations --aggregationType SEVERITY", "description": "AWS Inspector severity aggregation"},
            {"provider": "qualys", "api": "/api/2.0/fo/report/", "description": "Qualys trend reports"},
            {"provider": "tenable", "api": "/workbenches/vulnerabilities", "description": "Tenable.io vulnerability workbench"}
          ]
        },
        {
          "type": "configuration",
          "description": "Automated scanning configuration",
          "tip": "Verify continuous/automated scanning is enabled (not just periodic). Check that all asset types are covered and new resources are automatically enrolled.",
          "sources": [
            {"provider": "gcp", "command": "gcloud services list --filter='config.name:containerscanning.googleapis.com OR config.name:websecurityscanner.googleapis.com'", "description": "GCP security scanning services enabled"},
            {"provider": "aws", "command": "aws inspector2 batch-get-account-status --query 'accounts[].resourceState'", "description": "AWS Inspector resource scanning status"},
            {"provider": "azure", "command": "az security auto-provisioning-setting list", "description": "Azure Defender auto-provisioning"},
            {"provider": "snyk", "api": "/org/{orgId}/settings", "description": "Snyk organization scanning settings"}
          ]
        }
      ]
    },
    "KSI-AFR-05": {
      "name": "Significant Change Notifications",
      "evidence": [
        {
          "type": "log",
          "description": "Change notification records",
          "sources": [
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateChangeSet", "description": "CloudFormation changes"},
            {"provider": "github", "api": "/repos/{owner}/{repo}/releases", "description": "Release notifications"},
            {"provider": "manual", "artifact": "Significant Change Request (SCR) log"}
          ]
        }
      ]
    },
    "KSI-AFR-06": {
      "name": "Collaborative Continuous Monitoring",
      "evidence": [
        {
          "type": "report",
          "description": "Continuous monitoring reports",
          "sources": [
            {"provider": "manual", "artifact": "Monthly/Quarterly ConMon reports"},
            {"provider": "aws", "command": "aws securityhub get-findings --filters '{\"ComplianceStatus\":[{\"Value\":\"FAILED\",\"Comparison\":\"EQUALS\"}]}'", "description": "Security Hub compliance findings"}
          ]
        }
      ]
    },
    "KSI-AFR-07": {
      "name": "Recommended Secure Configuration",
      "evidence": [
        {
          "type": "configuration",
          "description": "Secure configuration baselines",
          "sources": [
            {"provider": "aws", "command": "aws ssm list-documents --filters Key=DocumentType,Values=Package", "description": "SSM configuration documents"},
            {"provider": "cis", "artifact": "CIS Benchmark compliance reports"},
            {"provider": "manual", "artifact": "Secure Configuration Guide for customers"}
          ]
        }
      ]
    },
    "KSI-AFR-08": {
      "name": "FedRAMP Security Inbox",
      "evidence": [
        {
          "type": "configuration",
          "description": "Security inbox configuration",
          "sources": [
            {"provider": "manual", "artifact": "Security inbox procedures and monitoring evidence"},
            {"provider": "email", "description": "Security inbox activity logs (fedramp-security@company.com)"}
          ]
        }
      ]
    },
    "KSI-AFR-09": {
      "name": "Persistent Validation and Assessment",
      "evidence": [
        {
          "type": "report",
          "description": "Automated compliance validation results",
          "sources": [
            {"provider": "aws", "command": "aws configservice get-compliance-summary-by-config-rule", "description": "AWS Config compliance"},
            {"provider": "azure", "command": "az policy state summarize", "description": "Azure Policy compliance"},
            {"provider": "checkov", "command": "checkov -d . --output json", "description": "IaC compliance scan"}
          ]
        }
      ]
    },
    "KSI-AFR-10": {
      "name": "Incident Communications Procedures",
      "evidence": [
        {
          "type": "documentation",
          "description": "Incident communication procedures",
          "sources": [
            {"provider": "manual", "artifact": "Incident Response Plan with FedRAMP ICP integration"},
            {"provider": "pagerduty", "api": "/incidents", "description": "Incident notification records"}
          ]
        }
      ]
    },
    "KSI-AFR-11": {
      "name": "Using Cryptographic Modules",
      "evidence": [
        {
          "type": "configuration",
          "description": "FIPS 140-2/3 module inventory",
          "sources": [
            {"provider": "aws", "command": "aws kms describe-key --key-id <key-id> --query 'KeyMetadata.KeySpec'", "description": "KMS key configuration"},
            {"provider": "manual", "artifact": "FIPS 140-2/3 validated module certificates"},
            {"provider": "openssl", "command": "openssl version -a", "description": "OpenSSL FIPS status"}
          ]
        }
      ]
    },
    "KSI-CED-01": {
      "name": "General Education",
      "evidence": [
        {
          "type": "report",
          "description": "Security awareness training completion",
          "sources": [
            {"provider": "knowbe4", "api": "/v1/training/enrollments", "description": "KnowBe4 training status"},
            {"provider": "workday", "api": "/learning/v1/completions", "description": "Workday Learning completions"},
            {"provider": "manual", "artifact": "LMS training completion report"}
          ]
        }
      ]
    },
    "KSI-CED-02": {
      "name": "Role-Specific Education",
      "evidence": [
        {
          "type": "report",
          "description": "Role-based training completion for privileged users",
          "sources": [
            {"provider": "manual", "artifact": "Privileged user training matrix"},
            {"provider": "lms", "description": "Role-specific course completion records"}
          ]
        }
      ]
    },
    "KSI-CED-03": {
      "name": "Development and Engineering Education",
      "evidence": [
        {
          "type": "report",
          "description": "Secure development training",
          "sources": [
            {"provider": "manual", "artifact": "OWASP/secure coding training records"},
            {"provider": "github", "api": "/orgs/{org}/dependabot/alerts", "description": "Developer security alert acknowledgments"}
          ]
        }
      ]
    },
    "KSI-CED-04": {
      "name": "Incident Response and Disaster Recovery Education",
      "evidence": [
        {
          "type": "report",
          "description": "IR/DR training and drill participation",
          "sources": [
            {"provider": "manual", "artifact": "Tabletop exercise attendance records"},
            {"provider": "manual", "artifact": "DR drill participation logs"}
          ]
        }
      ]
    },
    "KSI-CMT-01": {
      "name": "Log and Monitor Changes",
      "evidence": [
        {
          "type": "log",
          "description": "Change audit logs",
          "sources": [
            {"provider": "aws", "command": "aws cloudtrail lookup-events --start-time <date> --end-time <date>", "description": "CloudTrail change events"},
            {"provider": "azure", "command": "az monitor activity-log list --start-time <date>", "description": "Azure Activity Log"},
            {"provider": "github", "api": "/repos/{owner}/{repo}/commits", "description": "Git commit history"}
          ]
        }
      ]
    },
    "KSI-CMT-02": {
      "name": "Redeployment",
      "evidence": [
        {
          "type": "configuration",
          "description": "Immutable infrastructure deployment evidence",
          "sources": [
            {"provider": "argocd", "api": "/api/v1/applications", "description": "ArgoCD deployment history"},
            {"provider": "aws", "command": "aws ecs describe-services --cluster <cluster> --services <service>", "description": "ECS deployment configuration"},
            {"provider": "terraform", "command": "terraform state list", "description": "Terraform managed resources"}
          ]
        }
      ]
    },
    "KSI-CMT-03": {
      "name": "Automated Testing and Validation",
      "evidence": [
        {
          "type": "report",
          "description": "CI/CD pipeline test results",
          "sources": [
            {"provider": "github", "api": "/repos/{owner}/{repo}/actions/runs", "description": "GitHub Actions workflow runs"},
            {"provider": "gitlab", "api": "/projects/{id}/pipelines", "description": "GitLab CI pipeline history"},
            {"provider": "jenkins", "api": "/job/{name}/api/json", "description": "Jenkins build history"}
          ]
        }
      ]
    },
    "KSI-CMT-04": {
      "name": "Change Management Procedure",
      "evidence": [
        {
          "type": "documentation",
          "description": "Change management records",
          "sources": [
            {"provider": "servicenow", "api": "/api/now/table/change_request", "description": "ServiceNow change requests"},
            {"provider": "jira", "api": "/rest/api/3/search?jql=type=Change", "description": "Jira change tickets"},
            {"provider": "manual", "artifact": "Change Advisory Board (CAB) meeting minutes"}
          ]
        }
      ]
    },
    "KSI-CMT-05": {
      "name": "Emergency Changes",
      "evidence": [
        {
          "type": "documentation",
          "description": "Emergency change procedures and logs",
          "sources": [
            {"provider": "servicenow", "api": "/api/now/table/change_request?sysparm_query=type=emergency", "description": "Emergency change records"},
            {"provider": "manual", "artifact": "Emergency change authorization logs"}
          ]
        }
      ]
    },
    "KSI-CNA-01": {
      "name": "Restrict Network Traffic",
      "evidence": [
        {
          "type": "configuration",
          "description": "Network security configuration",
          "tip": "Look for overly permissive rules: 0.0.0.0/0 ingress, any-to-any rules, or unused open ports. Both ingress AND egress should be restricted to least privilege.",
          "sources": [
            {"provider": "aws", "command": "aws ec2 describe-security-groups --query 'SecurityGroups[*].{ID:GroupId,Name:GroupName,Ingress:IpPermissions,Egress:IpPermissionsEgress}'", "description": "Security group rules with ingress/egress details"},
            {"provider": "aws", "command": "aws ec2 describe-network-acls --query 'NetworkAcls[*].{ID:NetworkAclId,Entries:Entries}'", "description": "Network ACL rules"},
            {"provider": "azure", "command": "az network nsg list --query '[].{name:name,rules:securityRules}'", "description": "NSG rules"},
            {"provider": "azure", "command": "az network nsg rule list --nsg-name <nsg> --resource-group <rg>", "description": "Detailed NSG rule analysis"},
            {"provider": "gcp", "command": "gcloud compute firewall-rules list --format='table(name,network,direction,priority,sourceRanges,allowed)'", "description": "GCP firewall rules with source ranges"},
            {"provider": "gcp", "command": "gcloud compute firewall-rules describe <rule> --format=json", "description": "Detailed firewall rule config"},
            {"provider": "kubernetes", "command": "kubectl get networkpolicies --all-namespaces -o yaml", "description": "Kubernetes NetworkPolicies"}
          ]
        },
        {
          "type": "scan",
          "description": "Public exposure analysis",
          "tip": "Scan for unintended public exposure. Any resource reachable from 0.0.0.0/0 should be explicitly justified in documentation.",
          "sources": [
            {"provider": "aws", "command": "aws ec2 describe-instances --query 'Reservations[].Instances[?PublicIpAddress!=null].{ID:InstanceId,PublicIP:PublicIpAddress}'", "description": "EC2 instances with public IPs"},
            {"provider": "prowler", "command": "prowler aws --check ec2_securitygroup_allow_ingress_from_internet_to_any_port", "description": "Prowler public exposure check"},
            {"provider": "gcp", "command": "gcloud compute instances list --filter='networkInterfaces.accessConfigs:*' --format='table(name,zone,networkInterfaces[0].accessConfigs[0].natIP)'", "description": "GCP VMs with external IPs"},
            {"provider": "azure", "command": "az vm list-ip-addresses --query '[].{VM:virtualMachine.name,PublicIP:virtualMachine.network.publicIpAddresses[0].ipAddress}'", "description": "Azure VMs with public IPs"},
            {"provider": "shodan", "api": "/shodan/host/{ip}", "description": "External view of exposed services"}
          ]
        },
        {
          "type": "report",
          "description": "Network segmentation compliance",
          "tip": "Verify network segmentation between security zones (DMZ, app tier, data tier). Document trust boundaries and justify any cross-zone traffic.",
          "sources": [
            {"provider": "aws", "command": "aws ec2 describe-vpcs --query 'Vpcs[*].{ID:VpcId,CIDR:CidrBlock,Tags:Tags}'", "description": "VPC inventory with CIDR blocks"},
            {"provider": "aws", "command": "aws ec2 describe-subnets --query 'Subnets[*].{SubnetId:SubnetId,VpcId:VpcId,CIDR:CidrBlock,AZ:AvailabilityZone}'", "description": "Subnet segmentation"},
            {"provider": "gcp", "command": "gcloud compute networks subnets list --format='table(name,region,ipCidrRange,network)'", "description": "GCP subnet inventory"},
            {"provider": "manual", "artifact": "Network architecture diagram showing security zones and trust boundaries"}
          ]
        }
      ]
    },
    "KSI-CNA-02": {
      "name": "Minimize the Attack Surface",
      "evidence": [
        {
          "type": "scan",
          "description": "Attack surface analysis",
          "tip": "Identify all external-facing assets and open ports. Every public endpoint is attack surface. Regularly audit for unintended exposure and unused services.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute instances list --filter='networkInterfaces.accessConfigs:*' --format='table(name,zone,networkInterfaces[0].accessConfigs[0].natIP)'", "description": "GCP VMs with external IPs"},
            {"provider": "gcp", "command": "gcloud compute forwarding-rules list --format='table(name,IPAddress,target)'", "description": "GCP load balancer external IPs"},
            {"provider": "gcp", "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=category=\"PUBLIC_IP_ADDRESS\"", "description": "GCP SCC public IP findings"},
            {"provider": "trivy", "command": "trivy image --severity HIGH,CRITICAL <image>", "description": "Container vulnerability scan"},
            {"provider": "aws", "command": "aws ec2 describe-instances --query 'Reservations[].Instances[].{id:InstanceId,ports:SecurityGroups}'", "description": "Exposed instance analysis"},
            {"provider": "shodan", "api": "/shodan/host/{ip}", "description": "External exposure analysis"},
            {"provider": "nuclei", "command": "nuclei -l urls.txt -t cves/", "description": "Nuclei vulnerability scanning"}
          ]
        },
        {
          "type": "inventory",
          "description": "Public asset inventory",
          "tip": "Maintain a complete inventory of externally accessible resources. Compare against intended public assets - any delta is a risk.",
          "sources": [
            {"provider": "gcp", "command": "gcloud asset search-all-resources --scope=organizations/<org> --query='networkTags:public OR labels.public:*'", "description": "GCP Cloud Asset Inventory search"},
            {"provider": "aws", "command": "aws ec2 describe-instances --filters 'Name=ip-address,Values=*' --query 'Reservations[].Instances[].PublicIpAddress'", "description": "AWS public IP inventory"},
            {"provider": "azure", "command": "az network public-ip list --query '[].{name:name,ip:ipAddress,resource:id}'", "description": "Azure public IP inventory"}
          ]
        }
      ]
    },
    "KSI-CNA-03": {
      "name": "Enforce Traffic Flow",
      "evidence": [
        {
          "type": "log",
          "description": "Network flow logs",
          "tip": "VPC Flow Logs must be enabled on all subnets. Retain logs for at least 1 year. Analyze for unauthorized traffic patterns and denied connections.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute networks subnets list --format='table(name,region,enableFlowLogs,logConfig.aggregationInterval)'", "description": "GCP VPC Flow Logs configuration per subnet"},
            {"provider": "gcp", "command": "gcloud logging read 'resource.type=\"gce_subnetwork\" AND logName:\"logs/compute.googleapis.com%2Fvpc_flows\"' --limit=100 --format=json", "description": "GCP VPC Flow Logs sample"},
            {"provider": "aws", "command": "aws ec2 describe-flow-logs", "description": "VPC Flow Logs configuration"},
            {"provider": "azure", "command": "az network watcher flow-log list", "description": "Azure Network Watcher flow logs"},
            {"provider": "manual", "artifact": "Network segmentation diagrams"}
          ]
        },
        {
          "type": "configuration",
          "description": "Traffic enforcement policies",
          "tip": "Default deny should be enforced. All allowed traffic should be explicitly documented with business justification. East-west traffic should be as restricted as north-south.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute firewall-rules list --format='table(name,network,direction,priority,denied)'", "description": "GCP deny rules"},
            {"provider": "gcp", "command": "gcloud compute firewall-policies rules list --firewall-policy=<policy>", "description": "GCP hierarchical firewall policies"},
            {"provider": "kubernetes", "command": "kubectl get networkpolicies --all-namespaces -o yaml", "description": "Kubernetes NetworkPolicies"},
            {"provider": "calico", "command": "calicoctl get globalnetworkpolicies -o yaml", "description": "Calico network policies"}
          ]
        }
      ]
    },
    "KSI-CNA-04": {
      "name": "Immutable Infrastructure",
      "evidence": [
        {
          "type": "configuration",
          "description": "Immutable infrastructure evidence",
          "tip": "Verify infrastructure is replaced, not modified. No SSH/RDP access in production. All changes via IaC pipeline. Container images should use digests, not mutable tags.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute instance-templates list --format='table(name,creationTimestamp,properties.disks[0].source)'", "description": "GCP instance templates for immutable VMs"},
            {"provider": "gcp", "command": "gcloud container images list-tags <image> --format='table(digest,timestamp)'", "description": "GCP Container Registry image digests"},
            {"provider": "gcp", "command": "gcloud compute instances list --format='table(name,creationTimestamp,scheduling.preemptible)'", "description": "GCP VM creation dates (old VMs may indicate drift)"},
            {"provider": "aws", "command": "aws ec2 describe-launch-templates", "description": "EC2 launch templates"},
            {"provider": "docker", "command": "docker images --format '{{.Repository}}:{{.Tag}}@{{.Digest}}'", "description": "Immutable container images"},
            {"provider": "terraform", "command": "terraform show -json", "description": "Infrastructure as Code state"}
          ]
        },
        {
          "type": "log",
          "description": "Infrastructure change audit",
          "tip": "Monitor for manual changes that bypass IaC. Any drift from declared state is a compliance risk. Alert on SSH/RDP connections to production.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName:(\"compute.instances.insert\" OR \"compute.instances.setMetadata\")' --format=json", "description": "GCP Compute Engine change audit"},
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventSource,AttributeValue=ec2.amazonaws.com", "description": "AWS EC2 API calls"},
            {"provider": "driftctl", "command": "driftctl scan --from tfstate://terraform.tfstate", "description": "Driftctl IaC drift detection"}
          ]
        }
      ]
    },
    "KSI-CNA-05": {
      "name": "Unwanted Activity",
      "evidence": [
        {
          "type": "configuration",
          "description": "DDoS and abuse protection",
          "tip": "All external endpoints should have DDoS protection (Cloud Armor, Shield, Cloudflare). WAF should block OWASP Top 10. Rate limiting should be enabled.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute security-policies list --format='table(name,type,rules.len())'", "description": "GCP Cloud Armor security policies"},
            {"provider": "gcp", "command": "gcloud compute security-policies describe <policy> --format=json", "description": "GCP Cloud Armor policy rules detail"},
            {"provider": "gcp", "command": "gcloud compute backend-services list --format='table(name,securityPolicy)'", "description": "GCP backend services with Cloud Armor"},
            {"provider": "aws", "command": "aws shield describe-protection", "description": "AWS Shield protection status"},
            {"provider": "cloudflare", "api": "/zones/{zone_id}/settings/security_level", "description": "Cloudflare security settings"},
            {"provider": "aws", "command": "aws wafv2 list-web-acls --scope REGIONAL", "description": "WAF configuration"}
          ]
        },
        {
          "type": "log",
          "description": "Attack and abuse detection logs",
          "tip": "Monitor blocked requests, rate limit triggers, and bot detection. Correlate with threat intelligence. Alert on sustained attack patterns.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'resource.type=\"http_load_balancer\" AND jsonPayload.enforcedSecurityPolicy.outcome=\"DENY\"' --format=json", "description": "GCP Cloud Armor blocked requests"},
            {"provider": "aws", "command": "aws wafv2 get-sampled-requests --web-acl-arn <arn> --rule-metric-name ALL --scope REGIONAL --time-window Start=<start>,End=<end> --max-items 100", "description": "AWS WAF sampled requests"},
            {"provider": "cloudflare", "api": "/zones/{zone_id}/firewall/events", "description": "Cloudflare firewall events"}
          ]
        },
        {
          "type": "metrics",
          "description": "Attack volume and mitigation metrics",
          "tip": "Track attack frequency, types, and sources. Measure time to detect and mitigate. Report on false positive rates to ensure legitimate traffic isn't blocked.",
          "sources": [
            {"provider": "gcp", "command": "gcloud monitoring metrics list --filter='metric.type=starts_with(\"loadbalancing.googleapis.com/\")'", "description": "GCP LB metrics including Cloud Armor"},
            {"provider": "datadog", "api": "/api/v1/query?query=sum:waf.blocked_requests{*}", "description": "WAF blocked request trends"}
          ]
        }
      ]
    },
    "KSI-CNA-06": {
      "name": "High Availability",
      "evidence": [
        {
          "type": "configuration",
          "description": "High availability configuration",
          "sources": [
            {"provider": "aws", "command": "aws rds describe-db-clusters --query 'DBClusters[].{id:DBClusterIdentifier,multiAZ:MultiAZ}'", "description": "RDS Multi-AZ status"},
            {"provider": "aws", "command": "aws elbv2 describe-target-health --target-group-arn <arn>", "description": "Load balancer health"},
            {"provider": "kubernetes", "command": "kubectl get deployments -o json | jq '.items[].spec.replicas'", "description": "Kubernetes replica counts"}
          ]
        }
      ]
    },
    "KSI-CNA-07": {
      "name": "Best Practices",
      "evidence": [
        {
          "type": "report",
          "description": "Cloud best practices compliance",
          "sources": [
            {"provider": "aws", "command": "aws securityhub get-findings --filters '{\"ProductName\":[{\"Value\":\"AWS Foundational Security Best Practices\",\"Comparison\":\"EQUALS\"}]}'", "description": "AWS FSBP findings"},
            {"provider": "prowler", "command": "prowler aws --output-formats json", "description": "Prowler CIS benchmark scan"},
            {"provider": "azure", "command": "az security assessment list", "description": "Azure Security Center assessments"}
          ]
        }
      ]
    },
    "KSI-CNA-08": {
      "name": "Persistent Assessment and Automated Enforcement",
      "evidence": [
        {
          "type": "report",
          "description": "CSPM findings and auto-remediation",
          "sources": [
            {"provider": "aws", "command": "aws configservice get-compliance-details-by-config-rule --config-rule-name <rule>", "description": "AWS Config rule compliance"},
            {"provider": "wiz", "api": "/api/v1/issues", "description": "Wiz CSPM findings"},
            {"provider": "prisma", "api": "/v2/alert", "description": "Prisma Cloud alerts"}
          ]
        }
      ]
    },
    "KSI-IAM-01": {
      "name": "Phishing-Resistant MFA",
      "evidence": [
        {
          "type": "configuration",
          "description": "MFA enforcement policy",
          "tip": "Verify policy REQUIRES phishing-resistant MFA (FIDO2, WebAuthn, passkeys, PIV/CAC). SMS, TOTP, and push notifications do NOT qualify as phishing-resistant under FedRAMP 20x.",
          "sources": [
            {"provider": "okta", "api": "/api/v1/policies?type=MFA_ENROLL", "description": "Okta MFA policy - check for WebAuthn/FIDO2 requirement"},
            {"provider": "azure", "api": "/v1.0/policies/authenticationStrengthPolicies", "description": "Entra ID authentication strength - look for 'phishingResistant' strength"},
            {"provider": "azure", "api": "/v1.0/policies/conditionalAccessPolicies", "description": "Conditional Access policies with authentication strength requirements"},
            {"provider": "aws", "command": "aws iam get-account-summary --query 'SummaryMap.AccountMFAEnabled'", "description": "AWS account MFA status"},
            {"provider": "aws", "command": "aws iam list-virtual-mfa-devices", "description": "List MFA devices (check for hardware keys vs virtual)"},
            {"provider": "gcp", "command": "gcloud identity groups memberships list --group-email=<group>", "description": "GCP Cloud Identity group membership with 2SV status"},
            {"provider": "gcp", "api": "admin.googleapis.com/admin/directory/v1/users", "description": "Google Workspace Admin SDK - user 2SV enrollment"},
            {"provider": "duo", "api": "/admin/v1/users", "description": "Duo Admin API - user enrollment and auth methods"}
          ]
        },
        {
          "type": "report",
          "description": "MFA enrollment status",
          "tip": "100% of users must have phishing-resistant MFA enrolled. Generate reports showing enrollment coverage and the specific MFA type per user.",
          "sources": [
            {"provider": "aws", "command": "aws iam generate-credential-report && aws iam get-credential-report --output text --query 'Content' | base64 -d", "description": "IAM credential report - check mfa_active and hardware_mfa columns"},
            {"provider": "okta", "api": "/api/v1/users?filter=status eq \"ACTIVE\"", "description": "User MFA enrollment - check embedded factors for WebAuthn"},
            {"provider": "azure", "command": "az ad user list --query '[].{UPN:userPrincipalName,authMethods:authenticationMethods}'", "description": "Entra ID user authentication methods"},
            {"provider": "gcp", "command": "gcloud identity users describe <user> --format='value(twoStepVerification)'", "description": "GCP user 2-step verification status"},
            {"provider": "crowdstrike", "api": "/identity-protection/entities/users/v1", "description": "CrowdStrike Identity - MFA status across IdPs"}
          ]
        },
        {
          "type": "log",
          "description": "MFA authentication events",
          "tip": "Monitor for successful authentications that bypass MFA or use non-compliant methods. Alert on any fallback to SMS/TOTP.",
          "sources": [
            {"provider": "okta", "api": "/api/v1/logs?filter=eventType eq \"user.authentication.auth_via_mfa\"", "description": "Okta MFA authentication logs"},
            {"provider": "azure", "api": "/v1.0/auditLogs/signIns", "description": "Entra ID sign-in logs - filter by authenticationMethodsUsed"},
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ConsoleLogin", "description": "CloudTrail console login events with MFA info"},
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName=\"google.login.LoginService.loginSuccess\"' --format=json", "description": "GCP login audit logs"}
          ]
        }
      ]
    },
    "KSI-IAM-02": {
      "name": "Passwordless Authentication",
      "evidence": [
        {
          "type": "configuration",
          "description": "Passwordless authentication settings",
          "tip": "Passwordless methods must still be phishing-resistant. FIDO2/WebAuthn qualifies; magic links and SMS OTP do not. Verify fallback methods don't reintroduce password risk.",
          "sources": [
            {"provider": "gcp", "api": "admin.googleapis.com/admin/directory/v1/users/{userKey}/twoStepVerification", "description": "Google Workspace passwordless (passkeys) enrollment"},
            {"provider": "gcp", "command": "gcloud identity groups memberships list --group-email=<group> --format='table(preferredMemberKey.id,roles)'", "description": "GCP Cloud Identity member authentication status"},
            {"provider": "azure", "api": "/v1.0/policies/authenticationMethodsPolicy", "description": "Entra ID passwordless methods"},
            {"provider": "okta", "api": "/api/v1/authenticators", "description": "Okta authenticator configuration"},
            {"provider": "duo", "api": "/admin/v1/users/{user_id}/webauthncredentials", "description": "Duo WebAuthn credentials"}
          ]
        },
        {
          "type": "metrics",
          "description": "Passwordless adoption rate",
          "tip": "Track percentage of users on passwordless vs password-based auth. Goal should be 100% passwordless for privileged users, high adoption for all users.",
          "sources": [
            {"provider": "azure", "api": "/v1.0/reports/authenticationMethods/usersRegisteredByMethod", "description": "Entra ID authentication method registration stats"},
            {"provider": "okta", "api": "/api/v1/org/factors/catalog", "description": "Okta factor enrollment statistics"}
          ]
        }
      ]
    },
    "KSI-IAM-03": {
      "name": "Non-User Accounts",
      "evidence": [
        {
          "type": "inventory",
          "description": "Service account inventory",
          "tip": "Every service account needs an owner and documented purpose. Flag accounts with no recent activity (stale) or overly broad permissions. Workload identity (no keys) is preferred over key-based auth.",
          "sources": [
            {"provider": "gcp", "command": "gcloud iam service-accounts list --format='table(email,displayName,disabled)'", "description": "GCP service account inventory"},
            {"provider": "gcp", "command": "gcloud asset search-all-iam-policies --query='policy:serviceAccount' --format=json", "description": "GCP service account IAM bindings"},
            {"provider": "aws", "command": "aws iam list-roles --query 'Roles[?contains(RoleName,`service`)]'", "description": "AWS service roles"},
            {"provider": "azure", "command": "az ad sp list --filter \"servicePrincipalType eq 'Application'\"", "description": "Azure service principals"},
            {"provider": "kubernetes", "command": "kubectl get serviceaccounts --all-namespaces -o json", "description": "Kubernetes service accounts"}
          ]
        },
        {
          "type": "log",
          "description": "Service account key usage",
          "tip": "Monitor for service account key creation/download events - prefer workload identity over keys. Alert on keys older than 90 days.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName:(\"CreateServiceAccountKey\" OR \"google.iam.admin.v1.GetServiceAccountKey\")' --format=json", "description": "GCP service account key operations"},
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateAccessKey", "description": "AWS access key creation events"}
          ]
        },
        {
          "type": "configuration",
          "description": "Workload identity configuration",
          "tip": "Workload Identity Federation eliminates long-lived credentials. Verify GKE workloads use Workload Identity, not node service accounts.",
          "sources": [
            {"provider": "gcp", "command": "gcloud container clusters describe <cluster> --format='value(workloadIdentityConfig)'", "description": "GKE Workload Identity status"},
            {"provider": "gcp", "command": "gcloud iam workload-identity-pools list --location=global", "description": "GCP Workload Identity Federation pools"},
            {"provider": "aws", "command": "aws iam list-open-id-connect-providers", "description": "AWS OIDC providers for workload identity"}
          ]
        }
      ]
    },
    "KSI-IAM-04": {
      "name": "Just-in-Time Authorization",
      "evidence": [
        {
          "type": "log",
          "description": "JIT access requests and approvals",
          "tip": "JIT access should require approval for privileged roles, have short TTLs (1-8 hours typical), and auto-revoke. Verify no standing admin access exists.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName:(\"google.cloud.policytroubleshooter\" OR \"SetIamPolicy\") AND protoPayload.request.policy.bindings.condition' --format=json", "description": "GCP conditional IAM bindings (time-based access)"},
            {"provider": "gcp", "api": "iam.googleapis.com/v1/projects/{project}/serviceAccounts/{sa}:getIamPolicy", "description": "GCP IAM policy with conditions"},
            {"provider": "cyberark", "api": "/PasswordVault/API/AccountsRequests", "description": "CyberArk access requests"},
            {"provider": "azure", "api": "/v1.0/identityGovernance/privilegedAccess/group/assignmentRequests", "description": "Azure PIM requests"},
            {"provider": "hashicorp", "api": "/v1/sys/leases/lookup", "description": "Vault lease information"},
            {"provider": "teleport", "api": "/v1/accessrequests", "description": "Teleport access requests"}
          ]
        },
        {
          "type": "configuration",
          "description": "JIT policy configuration",
          "tip": "Verify JIT is required for all admin/privileged roles. Maximum session duration should align with policy (typically 1-8 hours). Approval workflows should require manager or security approval.",
          "sources": [
            {"provider": "azure", "api": "/v1.0/policies/roleManagementPolicies", "description": "Azure PIM role settings"},
            {"provider": "gcp", "command": "gcloud organizations get-iam-policy <org> --format=json | jq '.bindings[] | select(.condition != null)'", "description": "GCP org-level conditional bindings"},
            {"provider": "beyondtrust", "api": "/api/v3/access-policies", "description": "BeyondTrust Privilege Management policies"}
          ]
        },
        {
          "type": "metrics",
          "description": "Standing privilege elimination",
          "tip": "Track percentage of admin access that is JIT vs standing. Goal is 0% standing admin access. Measure average access duration and approval times.",
          "sources": [
            {"provider": "azure", "api": "/v1.0/reports/authenticationMethods/usersRegisteredByFeature", "description": "PIM usage statistics"},
            {"provider": "manual", "artifact": "JIT adoption metrics dashboard"}
          ]
        }
      ]
    },
    "KSI-IAM-05": {
      "name": "Least Privilege",
      "evidence": [
        {
          "type": "report",
          "description": "Access review and permission analysis",
          "tip": "Look for overly permissive policies: '*' actions, unused permissions, cross-account access. IAM Recommender and Access Analyzer identify these automatically.",
          "sources": [
            {"provider": "gcp", "command": "gcloud recommender recommendations list --recommender=google.iam.policy.Recommender --project=<project> --format='table(name,description,primaryImpact.category)'", "description": "GCP IAM Recommender suggestions"},
            {"provider": "gcp", "command": "gcloud policy-intelligence query-activity --project=<project> --limit=100", "description": "GCP Policy Intelligence activity analysis"},
            {"provider": "gcp", "api": "recommender.googleapis.com/v1/projects/{project}/locations/global/recommenders/google.iam.policy.Recommender/recommendations", "description": "GCP IAM policy recommendations API"},
            {"provider": "aws", "command": "aws accessanalyzer list-findings --analyzer-arn <arn>", "description": "IAM Access Analyzer findings"},
            {"provider": "azure", "command": "az role assignment list --all", "description": "Azure RBAC assignments"},
            {"provider": "manual", "artifact": "Quarterly access review records"}
          ]
        },
        {
          "type": "configuration",
          "description": "Role and permission definitions",
          "tip": "Custom roles should be preferred over primitive roles (Owner/Editor/Viewer). Verify no users have Owner role in production projects.",
          "sources": [
            {"provider": "gcp", "command": "gcloud projects get-iam-policy <project> --format='table(bindings.role,bindings.members)'", "description": "GCP project IAM policy"},
            {"provider": "gcp", "command": "gcloud iam roles list --project=<project> --format='table(name,title,stage)'", "description": "GCP custom roles inventory"},
            {"provider": "aws", "command": "aws iam list-attached-user-policies --user-name <user>", "description": "AWS user attached policies"},
            {"provider": "azure", "command": "az role definition list --custom-role-only", "description": "Azure custom role definitions"}
          ]
        },
        {
          "type": "scan",
          "description": "Excessive permission detection",
          "tip": "Scan for dormant permissions (granted but never used), admin access to non-admin resources, and service accounts with user-level roles.",
          "sources": [
            {"provider": "gcp", "command": "gcloud asset search-all-iam-policies --query='policy.role.permissions:*' --format=json", "description": "GCP Cloud Asset Inventory IAM search"},
            {"provider": "aws", "command": "aws iam generate-service-last-accessed-details --arn <arn>", "description": "AWS service last accessed details"},
            {"provider": "bridgecrew", "api": "/api/v1/suppressions", "description": "Bridgecrew/Checkov least privilege findings"}
          ]
        }
      ]
    },
    "KSI-IAM-06": {
      "name": "Suspicious Activity",
      "evidence": [
        {
          "type": "configuration",
          "description": "Automated account protection rules",
          "sources": [
            {"provider": "okta", "api": "/api/v1/behaviors", "description": "Okta behavior detection rules"},
            {"provider": "azure", "api": "/v1.0/identityProtection/riskDetections", "description": "Entra ID risk detections"},
            {"provider": "aws", "command": "aws guardduty list-findings --detector-id <id>", "description": "GuardDuty IAM-related findings"}
          ]
        }
      ]
    },
    "KSI-IAM-07": {
      "name": "Automated Account Management",
      "evidence": [
        {
          "type": "log",
          "description": "Account lifecycle automation logs",
          "sources": [
            {"provider": "okta", "api": "/api/v1/logs?filter=eventType eq \"user.lifecycle.create\"", "description": "Okta user lifecycle events"},
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateUser", "description": "IAM user creation events"},
            {"provider": "scim", "description": "SCIM provisioning logs"}
          ]
        }
      ]
    },
    "KSI-INR-01": {
      "name": "Incident Response Procedure",
      "evidence": [
        {
          "type": "documentation",
          "description": "Incident response procedures",
          "sources": [
            {"provider": "manual", "artifact": "Incident Response Plan document"},
            {"provider": "pagerduty", "api": "/response_plays", "description": "PagerDuty response plays"},
            {"provider": "opsgenie", "api": "/v2/policies", "description": "Opsgenie escalation policies"}
          ]
        }
      ]
    },
    "KSI-INR-02": {
      "name": "Incident Logging",
      "evidence": [
        {
          "type": "log",
          "description": "Incident records",
          "sources": [
            {"provider": "servicenow", "api": "/api/now/table/incident", "description": "ServiceNow incidents"},
            {"provider": "jira", "api": "/rest/api/3/search?jql=type=Incident", "description": "Jira incident tickets"},
            {"provider": "pagerduty", "api": "/incidents", "description": "PagerDuty incident history"}
          ]
        }
      ]
    },
    "KSI-INR-03": {
      "name": "Incident After Action Reports",
      "evidence": [
        {
          "type": "documentation",
          "description": "Post-incident reviews",
          "sources": [
            {"provider": "manual", "artifact": "Post-mortem/After Action Report documents"},
            {"provider": "blameless", "api": "/api/v1/incidents/{id}/retrospective", "description": "Blameless retrospectives"},
            {"provider": "incidentio", "api": "/v2/post_incident_tasks", "description": "Incident.io follow-up tasks"}
          ]
        }
      ]
    },
    "KSI-MLA-01": {
      "name": "Security Information and Event Management (SIEM)",
      "evidence": [
        {
          "type": "configuration",
          "description": "SIEM configuration and coverage",
          "tip": "SIEM must be centralized and tamper-resistant. Verify all log sources are connected and retention meets FedRAMP requirements (typically 1 year online, 3 years archived for moderate).",
          "sources": [
            {"provider": "splunk", "api": "/services/data/inputs", "description": "Splunk data inputs - verify all critical sources"},
            {"provider": "splunk", "api": "/services/saved/searches", "description": "Splunk correlation rules and alerts"},
            {"provider": "azure", "command": "az sentinel data-connector list --workspace-name <ws> --resource-group <rg>", "description": "Sentinel data connectors"},
            {"provider": "azure", "command": "az monitor log-analytics workspace show --workspace-name <ws> --query 'retentionInDays'", "description": "Log Analytics retention setting"},
            {"provider": "elastic", "api": "/_cat/indices?v", "description": "Elasticsearch log indices"},
            {"provider": "gcp", "command": "gcloud logging sinks list --format='table(name,destination,filter)'", "description": "GCP Cloud Logging sinks"},
            {"provider": "gcp", "command": "gcloud logging buckets describe _Default --location=global --format='value(retentionDays)'", "description": "GCP log bucket retention"},
            {"provider": "aws", "command": "aws logs describe-log-groups --query 'logGroups[*].{Name:logGroupName,Retention:retentionInDays}'", "description": "CloudWatch Logs retention settings"},
            {"provider": "chronicle", "api": "/v1/detect/rules", "description": "Google Chronicle detection rules"}
          ]
        },
        {
          "type": "inventory",
          "description": "Log source coverage",
          "tip": "Document all systems in scope and verify each has log forwarding enabled. Missing sources = compliance gaps.",
          "sources": [
            {"provider": "splunk", "api": "/services/data/indexes", "description": "Splunk index inventory with sourcetypes"},
            {"provider": "aws", "command": "aws cloudtrail describe-trails --query 'trailList[*].{Name:Name,S3Bucket:S3BucketName,IsMultiRegion:IsMultiRegionTrail}'", "description": "CloudTrail configuration"},
            {"provider": "gcp", "command": "gcloud logging logs list --format='table(name)'", "description": "GCP log types being captured"},
            {"provider": "azure", "command": "az monitor diagnostic-settings list --resource <resource-id>", "description": "Azure diagnostic settings per resource"},
            {"provider": "manual", "artifact": "Log source matrix mapping systems to SIEM data sources"}
          ]
        },
        {
          "type": "log",
          "description": "SIEM operational health",
          "tip": "Monitor SIEM itself for gaps in ingestion. Alert on missing data or ingestion delays.",
          "sources": [
            {"provider": "splunk", "api": "/services/server/introspection/indexer", "description": "Splunk indexer health metrics"},
            {"provider": "datadog", "api": "/api/v1/logs/analytics/aggregate", "description": "Datadog log analytics"},
            {"provider": "sumo", "api": "/api/v1/collectors", "description": "Sumo Logic collector status"}
          ]
        }
      ]
    },
    "KSI-MLA-02": {
      "name": "Audit Logging",
      "evidence": [
        {
          "type": "log",
          "description": "Log review evidence",
          "tip": "Log reviews should be documented with findings, actions taken, and sign-off. Automated anomaly detection supplements but doesn't replace human review.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'logName:\"logs/cloudaudit.googleapis.com\"' --limit=100 --format=json", "description": "GCP Cloud Audit Logs"},
            {"provider": "gcp", "command": "gcloud logging sinks list --format='table(name,destination,filter)'", "description": "GCP audit log export sinks"},
            {"provider": "splunk", "api": "/services/saved/searches", "description": "Splunk scheduled searches"},
            {"provider": "manual", "artifact": "Log review records and findings"},
            {"provider": "azure", "command": "az monitor log-analytics query -w <workspace-id> --analytics-query <query>", "description": "Log Analytics query results"}
          ]
        },
        {
          "type": "configuration",
          "description": "Audit log configuration",
          "tip": "Verify audit logs capture all admin actions, authentication events, and data access. GCP Data Access logs may need explicit enablement.",
          "sources": [
            {"provider": "gcp", "command": "gcloud projects get-iam-policy <project> --format=json | jq '.auditConfigs'", "description": "GCP Data Access audit log configuration"},
            {"provider": "gcp", "command": "gcloud organizations get-iam-policy <org> --format=json | jq '.auditConfigs'", "description": "GCP org-level audit config"}
          ]
        }
      ]
    },
    "KSI-MLA-03": {
      "name": "Log Integrity",
      "evidence": [
        {
          "type": "configuration",
          "description": "Log tamper protection",
          "tip": "Logs must be immutable - use locked retention policies, write-once storage, or cryptographic validation. No one (including admins) should be able to delete or modify historical logs.",
          "sources": [
            {"provider": "gcp", "command": "gcloud storage buckets describe gs://<bucket> --format='value(retentionPolicy,iamConfiguration.bucketPolicyOnly)'", "description": "GCP Cloud Storage retention policy"},
            {"provider": "gcp", "command": "gcloud logging buckets describe <bucket> --location=<location> --format='value(locked,retentionDays)'", "description": "GCP Log bucket lock status"},
            {"provider": "gcp", "command": "gcloud logging buckets update <bucket> --location=<location> --locked", "description": "GCP Lock log bucket (prevents deletion)"},
            {"provider": "aws", "command": "aws cloudtrail describe-trails --query 'trailList[].{Name:Name,LogFileValidation:LogFileValidationEnabled}'", "description": "CloudTrail log validation"},
            {"provider": "aws", "command": "aws s3api get-bucket-versioning --bucket <bucket>", "description": "S3 log bucket versioning"},
            {"provider": "azure", "command": "az storage account show --name <account> --query 'immutableStorageWithVersioning'", "description": "Azure immutable storage"}
          ]
        },
        {
          "type": "log",
          "description": "Log integrity validation evidence",
          "tip": "Regularly validate log integrity (hashes, checksums). Alert on any validation failures or gaps in log continuity.",
          "sources": [
            {"provider": "aws", "command": "aws cloudtrail validate-logs --trail-arn <arn> --start-time <start>", "description": "CloudTrail log validation results"},
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName:\"storage.objects.delete\" AND resource.labels.bucket_name:<log-bucket>'", "description": "GCP log deletion attempt monitoring"}
          ]
        }
      ]
    },
    "KSI-MLA-04": {
      "name": "Log Retention",
      "evidence": [
        {
          "type": "configuration",
          "description": "Log retention policies",
          "tip": "FedRAMP requirements: Low=90 days, Moderate=1 year online + 3 years archived, High=1 year online + 6 years archived. Verify ALL log sources meet these thresholds.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging buckets list --format='table(name,retentionDays,locked)'", "description": "GCP Log bucket retention settings"},
            {"provider": "gcp", "command": "gcloud storage buckets describe gs://<bucket> --format='value(lifecycle)'", "description": "GCP Cloud Storage lifecycle (for archived logs)"},
            {"provider": "aws", "command": "aws logs describe-log-groups --query 'logGroups[].{name:logGroupName,retention:retentionInDays}'", "description": "CloudWatch Logs retention"},
            {"provider": "splunk", "api": "/services/data/indexes", "description": "Splunk index retention settings"},
            {"provider": "azure", "command": "az monitor log-analytics workspace show --workspace-name <ws> --query 'retentionInDays'", "description": "Log Analytics retention"}
          ]
        },
        {
          "type": "inventory",
          "description": "Log source retention mapping",
          "tip": "Document retention period for each log source. Any source below required threshold is a compliance gap. Include archived/cold storage in retention calculations.",
          "sources": [
            {"provider": "manual", "artifact": "Log retention matrix by source and impact level"},
            {"provider": "gcp", "command": "gcloud logging sinks list --format='table(name,destination)'", "description": "GCP log export destinations (for retention verification)"}
          ]
        }
      ]
    },
    "KSI-MLA-05": {
      "name": "Infrastructure as Code",
      "evidence": [
        {
          "type": "scan",
          "description": "IaC security scanning results",
          "tip": "IaC scanning should run on every PR/commit. Block merges on HIGH/CRITICAL findings. Track findings over time to show improvement.",
          "sources": [
            {"provider": "gcp", "command": "gcloud builds list --filter='substitutions.TRIGGER_NAME:*security*' --format='table(id,status,createTime)'", "description": "GCP Cloud Build security scan runs"},
            {"provider": "checkov", "command": "checkov -d . --output json", "description": "Checkov IaC scan"},
            {"provider": "tfsec", "command": "tfsec . --format json", "description": "tfsec Terraform scan"},
            {"provider": "kics", "command": "kics scan -p . -o json", "description": "KICS IaC scan"},
            {"provider": "snyk", "command": "snyk iac test --json", "description": "Snyk IaC scanning"}
          ]
        },
        {
          "type": "configuration",
          "description": "IaC pipeline integration",
          "tip": "Verify IaC scanning is mandatory in CI/CD. Check that bypass requires approval. All infrastructure changes should flow through IaC (no manual changes).",
          "sources": [
            {"provider": "gcp", "command": "gcloud builds triggers list --format='table(name,github.owner,github.name)'", "description": "GCP Cloud Build triggers"},
            {"provider": "github", "api": "/repos/{owner}/{repo}/branches/{branch}/protection", "description": "GitHub branch protection with required checks"},
            {"provider": "gitlab", "api": "/projects/{id}/merge_request_approval_rules", "description": "GitLab MR approval rules"}
          ]
        },
        {
          "type": "metrics",
          "description": "IaC scan findings trends",
          "tip": "Show declining trend in IaC findings over time. Track time-to-remediate for identified issues. Report on scan coverage (% of repos scanned).",
          "sources": [
            {"provider": "bridgecrew", "api": "/api/v1/suppressions/justifications", "description": "Bridgecrew suppression justifications"},
            {"provider": "snyk", "api": "/org/{orgId}/project/{projectId}/history", "description": "Snyk project issue history"}
          ]
        }
      ]
    },
    "KSI-MLA-06": {
      "name": "Alerting",
      "evidence": [
        {
          "type": "configuration",
          "description": "Security alerting configuration",
          "tip": "Critical security alerts should page on-call 24/7. Verify escalation paths exist. Test alerting regularly (fire drills). Alert fatigue indicates tuning needed.",
          "sources": [
            {"provider": "gcp", "command": "gcloud monitoring alert-policies list --format='table(displayName,enabled,notificationChannels)'", "description": "GCP Cloud Monitoring alert policies"},
            {"provider": "gcp", "command": "gcloud monitoring channels list --format='table(displayName,type,enabled)'", "description": "GCP notification channels"},
            {"provider": "gcp", "api": "securitycenter.googleapis.com/v1/organizations/{org}/notificationConfigs", "description": "GCP SCC notification configs"},
            {"provider": "aws", "command": "aws cloudwatch describe-alarms --alarm-types MetricAlarm", "description": "CloudWatch alarms"},
            {"provider": "pagerduty", "api": "/services", "description": "PagerDuty service integrations"},
            {"provider": "splunk", "api": "/services/alerts/fired_alerts", "description": "Splunk alert history"}
          ]
        },
        {
          "type": "log",
          "description": "Alert response evidence",
          "tip": "Document response to every critical alert. Track Mean Time to Acknowledge (MTTA) and Mean Time to Resolve (MTTR). Alerts without response are compliance gaps.",
          "sources": [
            {"provider": "pagerduty", "api": "/incidents", "description": "PagerDuty incident history with response times"},
            {"provider": "opsgenie", "api": "/v2/alerts", "description": "OpsGenie alert history"},
            {"provider": "gcp", "command": "gcloud logging read 'resource.type=\"cloud_function\" AND severity>=ERROR'", "description": "GCP alert function executions"}
          ]
        },
        {
          "type": "metrics",
          "description": "Alerting health metrics",
          "tip": "Track alert volume, false positive rate, and response times. High volume or low response rate indicates problems. Report on alert coverage (% of critical systems monitored).",
          "sources": [
            {"provider": "gcp", "command": "gcloud monitoring alert-policies list --filter='enabled=true' --format='value(displayName)' | wc -l", "description": "GCP active alert count"},
            {"provider": "datadog", "api": "/api/v1/monitor", "description": "Datadog monitor inventory"}
          ]
        }
      ]
    },
    "KSI-MLA-07": {
      "name": "Event Types",
      "evidence": [
        {
          "type": "documentation",
          "description": "Monitored event types documentation",
          "sources": [
            {"provider": "aws", "command": "aws cloudtrail get-event-selectors --trail-name <trail>", "description": "CloudTrail event selectors"},
            {"provider": "manual", "artifact": "Log source inventory with event types"},
            {"provider": "splunk", "api": "/services/data/inputs", "description": "Splunk input configurations"}
          ]
        }
      ]
    },
    "KSI-MLA-08": {
      "name": "Log Data Access",
      "evidence": [
        {
          "type": "configuration",
          "description": "Log access controls",
          "sources": [
            {"provider": "splunk", "api": "/services/authorization/roles", "description": "Splunk role-based access"},
            {"provider": "aws", "command": "aws logs describe-resource-policies", "description": "CloudWatch Logs resource policies"},
            {"provider": "elastic", "api": "/_security/role", "description": "Elasticsearch security roles"}
          ]
        }
      ]
    },
    "KSI-PIY-01": {
      "name": "Automated Inventory",
      "evidence": [
        {
          "type": "inventory",
          "description": "Real-time asset inventory",
          "sources": [
            {"provider": "aws", "command": "aws configservice list-discovered-resources --resource-type AWS::EC2::Instance", "description": "AWS Config discovered resources"},
            {"provider": "azure", "command": "az graph query -q 'Resources | summarize count() by type'", "description": "Azure Resource Graph inventory"},
            {"provider": "servicenow", "api": "/api/now/table/cmdb_ci", "description": "ServiceNow CMDB"}
          ]
        }
      ]
    },
    "KSI-PIY-02": {
      "name": "Security Objectives and Requirements",
      "evidence": [
        {
          "type": "documentation",
          "description": "Security requirements documentation",
          "sources": [
            {"provider": "manual", "artifact": "System Security Plan security objectives"},
            {"provider": "jira", "api": "/rest/api/3/search?jql=labels=security-requirement", "description": "Security requirements in Jira"}
          ]
        }
      ]
    },
    "KSI-PIY-03": {
      "name": "Vulnerability Disclosure Program",
      "evidence": [
        {
          "type": "report",
          "description": "VDP submissions and status",
          "sources": [
            {"provider": "hackerone", "api": "/v1/reports", "description": "HackerOne reports"},
            {"provider": "bugcrowd", "api": "/submissions", "description": "Bugcrowd submissions"},
            {"provider": "manual", "artifact": "security.txt file and VDP policy"}
          ]
        }
      ]
    },
    "KSI-PIY-04": {
      "name": "CISA Secure By Design",
      "evidence": [
        {
          "type": "documentation",
          "description": "Secure by Design practices",
          "sources": [
            {"provider": "manual", "artifact": "SDLC documentation with security integration"},
            {"provider": "github", "api": "/repos/{owner}/{repo}/code-scanning/alerts", "description": "GitHub code scanning alerts"},
            {"provider": "sonarqube", "api": "/api/issues/search", "description": "SonarQube security hotspots"}
          ]
        }
      ]
    },
    "KSI-PIY-05": {
      "name": "Evaluate Implementations",
      "evidence": [
        {
          "type": "documentation",
          "description": "Implementation evaluation methods",
          "sources": [
            {"provider": "manual", "artifact": "Security assessment methodology documentation"},
            {"provider": "manual", "artifact": "Penetration test reports"}
          ]
        }
      ]
    },
    "KSI-PIY-06": {
      "name": "Security Investment Effectiveness",
      "evidence": [
        {
          "type": "metrics",
          "description": "Security metrics and KPIs",
          "sources": [
            {"provider": "manual", "artifact": "Security metrics dashboard"},
            {"provider": "manual", "artifact": "Security program effectiveness reports"}
          ]
        }
      ]
    },
    "KSI-PIY-07": {
      "name": "Supply Chain Risk Management",
      "evidence": [
        {
          "type": "report",
          "description": "Software supply chain security",
          "sources": [
            {"provider": "syft", "command": "syft <image> -o spdx-json", "description": "SBOM generation"},
            {"provider": "grype", "command": "grype sbom:<sbom-file> -o json", "description": "SBOM vulnerability scan"},
            {"provider": "github", "api": "/repos/{owner}/{repo}/dependency-graph/sbom", "description": "GitHub SBOM export"}
          ]
        }
      ]
    },
    "KSI-PIY-08": {
      "name": "Executive Support",
      "evidence": [
        {
          "type": "documentation",
          "description": "Executive security engagement",
          "sources": [
            {"provider": "manual", "artifact": "Security steering committee meeting minutes"},
            {"provider": "manual", "artifact": "Executive security briefing records"}
          ]
        }
      ]
    },
    "KSI-RPL-01": {
      "name": "Recovery Objectives",
      "evidence": [
        {
          "type": "documentation",
          "description": "RTO/RPO definitions",
          "sources": [
            {"provider": "manual", "artifact": "Business Impact Analysis with RTO/RPO"},
            {"provider": "manual", "artifact": "Disaster Recovery Plan"}
          ]
        }
      ]
    },
    "KSI-RPL-02": {
      "name": "Recovery Plan",
      "evidence": [
        {
          "type": "documentation",
          "description": "Recovery procedures",
          "sources": [
            {"provider": "manual", "artifact": "Disaster Recovery Plan document"},
            {"provider": "manual", "artifact": "Business Continuity Plan"}
          ]
        }
      ]
    },
    "KSI-RPL-03": {
      "name": "System Backups",
      "evidence": [
        {
          "type": "report",
          "description": "Backup status and compliance",
          "sources": [
            {"provider": "aws", "command": "aws backup list-backup-jobs --by-state COMPLETED", "description": "AWS Backup job status"},
            {"provider": "azure", "command": "az backup job list --resource-group <rg> --vault-name <vault>", "description": "Azure Backup jobs"},
            {"provider": "veeam", "api": "/api/v1/backupServers/{id}/sessions", "description": "Veeam backup sessions"}
          ]
        }
      ]
    },
    "KSI-RPL-04": {
      "name": "Recovery Testing",
      "evidence": [
        {
          "type": "report",
          "description": "DR test results",
          "sources": [
            {"provider": "manual", "artifact": "DR test execution records and results"},
            {"provider": "aws", "command": "aws drs describe-recovery-instances", "description": "AWS Elastic Disaster Recovery status"},
            {"provider": "manual", "artifact": "Chaos engineering experiment results"}
          ]
        }
      ]
    },
    "KSI-SVC-01": {
      "name": "Continuous Improvement",
      "evidence": [
        {
          "type": "documentation",
          "description": "Security improvement tracking",
          "tip": "Demonstrate ongoing security maturity improvements. Track POA&M closures, vulnerability reduction trends, and security control enhancements over time.",
          "sources": [
            {"provider": "gcp", "command": "gcloud scc findings list --organization=<org> --filter='state=\"INACTIVE\"' --format='table(finding.category,finding.eventTime)'", "description": "GCP SCC resolved findings (improvements)"},
            {"provider": "jira", "api": "/rest/api/3/search?jql=labels=security-improvement", "description": "Security improvement tickets"},
            {"provider": "manual", "artifact": "Security roadmap and improvement plans"},
            {"provider": "manual", "artifact": "POA&M closure reports"}
          ]
        },
        {
          "type": "metrics",
          "description": "Security posture improvement metrics",
          "tip": "Show measurable improvement: fewer vulnerabilities, faster remediation, better coverage. Compare current state to baseline from 6-12 months ago.",
          "sources": [
            {"provider": "gcp", "api": "securitycenter.googleapis.com/v1/organizations/{org}/securityHealthAnalyticsSettings", "description": "GCP Security Health Analytics posture"},
            {"provider": "qualys", "api": "/api/2.0/fo/report/scorecards/", "description": "Qualys security scorecard trends"}
          ]
        }
      ]
    },
    "KSI-SVC-02": {
      "name": "Network Encryption",
      "evidence": [
        {
          "type": "scan",
          "description": "TLS/encryption configuration",
          "tip": "Minimum TLS 1.2 required, TLS 1.3 preferred. Verify no weak ciphers (RC4, DES, export ciphers). Certificate chains must be valid and not expiring soon.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute ssl-policies list --format='table(name,minTlsVersion,profile)'", "description": "GCP SSL policies with TLS version"},
            {"provider": "gcp", "command": "gcloud compute target-https-proxies list --format='table(name,sslPolicy)'", "description": "GCP HTTPS proxies SSL policy assignment"},
            {"provider": "ssllabs", "api": "/api/v3/analyze?host=<domain>", "description": "SSL Labs scan results"},
            {"provider": "testssl", "command": "testssl.sh --json <domain>", "description": "testssl.sh scan"},
            {"provider": "aws", "command": "aws elbv2 describe-listeners --load-balancer-arn <arn> --query 'Listeners[].{Port:Port,Protocol:Protocol}'", "description": "Load balancer TLS configuration"}
          ]
        },
        {
          "type": "configuration",
          "description": "Internal service encryption",
          "tip": "Internal service-to-service communication should also use TLS/mTLS. Verify mesh encryption if using service mesh. Check for any plaintext internal traffic.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute backend-services describe <service> --format='value(securitySettings)'", "description": "GCP backend service security settings"},
            {"provider": "istio", "command": "istioctl analyze --all-namespaces", "description": "Istio mTLS analysis"},
            {"provider": "kubernetes", "command": "kubectl get peerauthentication --all-namespaces -o yaml", "description": "Kubernetes mTLS policies"}
          ]
        }
      ]
    },
    "KSI-SVC-03": {
      "name": "Data Encryption",
      "evidence": [
        {
          "type": "configuration",
          "description": "Data-at-rest encryption",
          "tip": "All data stores must be encrypted. Use customer-managed keys (CMEK) for FedRAMP High. Verify encryption covers databases, file storage, backups, and logs.",
          "sources": [
            {"provider": "gcp", "command": "gcloud sql instances list --format='table(name,settings.ipConfiguration.requireSsl,settings.dataDiskSizeGb)'", "description": "GCP Cloud SQL encryption (default encrypted)"},
            {"provider": "gcp", "command": "gcloud storage buckets describe gs://<bucket> --format='value(encryption)'", "description": "GCP Cloud Storage CMEK configuration"},
            {"provider": "gcp", "command": "gcloud kms keys list --location=<location> --keyring=<keyring> --format='table(name,purpose,primary.state)'", "description": "GCP Cloud KMS keys"},
            {"provider": "aws", "command": "aws rds describe-db-instances --query 'DBInstances[].{id:DBInstanceIdentifier,encrypted:StorageEncrypted}'", "description": "RDS encryption status"},
            {"provider": "aws", "command": "aws s3api get-bucket-encryption --bucket <bucket>", "description": "S3 encryption configuration"},
            {"provider": "azure", "command": "az storage account show --name <account> --query 'encryption'", "description": "Azure storage encryption"}
          ]
        },
        {
          "type": "inventory",
          "description": "Data store encryption inventory",
          "tip": "Maintain inventory of all data stores with encryption status. Any unencrypted data store is a compliance gap. Include ephemeral storage and caches.",
          "sources": [
            {"provider": "gcp", "command": "gcloud asset search-all-resources --asset-types='sqladmin.googleapis.com/Instance,storage.googleapis.com/Bucket,compute.googleapis.com/Disk'", "description": "GCP data store inventory"},
            {"provider": "aws", "command": "aws resourcegroupstaggingapi get-resources --tag-filters Key=DataClassification", "description": "AWS tagged data resources"}
          ]
        }
      ]
    },
    "KSI-SVC-04": {
      "name": "Configuration Automation",
      "evidence": [
        {
          "type": "configuration",
          "description": "Configuration management automation",
          "tip": "100% of systems should be under configuration management. No manual configuration changes. Verify drift detection is enabled and alerts on changes.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute instances list --format='table(name,metadata.items[0].value)'", "description": "GCP VM metadata (startup scripts)"},
            {"provider": "gcp", "command": "gcloud deployment-manager deployments list --format='table(name,operation.status)'", "description": "GCP Deployment Manager deployments"},
            {"provider": "gcp", "command": "gcloud config configurations list", "description": "GCP config configurations"},
            {"provider": "ansible", "command": "ansible-inventory --list", "description": "Ansible managed inventory"},
            {"provider": "aws", "command": "aws ssm describe-instance-information", "description": "SSM managed instances"},
            {"provider": "puppet", "api": "/pdb/query/v4/nodes", "description": "Puppet managed nodes"}
          ]
        },
        {
          "type": "log",
          "description": "Configuration drift detection",
          "tip": "Monitor for configuration drift. Any manual changes should be flagged and reverted. Track compliance percentage over time.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName:(\"compute.instances.setMetadata\" OR \"compute.instances.setTags\")' --format=json", "description": "GCP VM configuration change audit"},
            {"provider": "aws", "command": "aws config get-compliance-details-by-config-rule --config-rule-name <rule>", "description": "AWS Config compliance details"},
            {"provider": "chef", "api": "/compliance/reporting/nodes", "description": "Chef InSpec compliance reports"}
          ]
        }
      ]
    },
    "KSI-SVC-05": {
      "name": "Resource Integrity",
      "evidence": [
        {
          "type": "scan",
          "description": "File and resource integrity monitoring",
          "tip": "FIM should cover critical system files, binaries, and configurations. Alert on any unexpected changes. Container images should be immutable and verified with signatures.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute instances describe <instance> --format='value(shieldedInstanceConfig)'", "description": "GCP Shielded VM integrity monitoring"},
            {"provider": "gcp", "command": "gcloud container images describe <image> --format='value(image_summary.fully_qualified_digest)'", "description": "GCP container image digest verification"},
            {"provider": "gcp", "api": "binaryauthorization.googleapis.com/v1/projects/{project}/policy", "description": "GCP Binary Authorization policy"},
            {"provider": "aws", "command": "aws configservice get-resource-config-history --resource-type AWS::EC2::Instance --resource-id <id>", "description": "AWS Config resource history"},
            {"provider": "tripwire", "api": "/api/v1/elements", "description": "Tripwire element status"},
            {"provider": "ossec", "artifact": "OSSEC syscheck reports"},
            {"provider": "sigstore", "command": "cosign verify <image>", "description": "Sigstore container signature verification"}
          ]
        },
        {
          "type": "log",
          "description": "Integrity violation alerts",
          "tip": "Track integrity alerts over time. Any alert should trigger investigation. Repeated alerts on same resource indicate potential compromise or misconfiguration.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'resource.type=\"gce_instance\" AND jsonPayload.event_type=\"integrity_violation\"'", "description": "GCP Shielded VM integrity violation logs"},
            {"provider": "aws", "command": "aws guardduty list-findings --detector-id <id> --finding-criteria '{\"Criterion\":{\"type\":{\"Eq\":[\"Persistence:IAMUser/UserPermissions\"]}}}'", "description": "AWS GuardDuty persistence findings"},
            {"provider": "crowdstrike", "api": "/detects/queries/detects/v1", "description": "CrowdStrike detection events"}
          ]
        }
      ]
    },
    "KSI-SVC-06": {
      "name": "Secret Management",
      "evidence": [
        {
          "type": "configuration",
          "description": "Secret management policy and rotation settings",
          "tip": "Verify automatic rotation is enabled. For high-impact systems, secrets should rotate at least every 90 days. Service account keys should rotate more frequently (30-60 days).",
          "sources": [
            {"provider": "gcp", "command": "gcloud secrets list --format='table(name,replication.automatic,rotation.nextRotationTime,rotation.rotationPeriod)'", "description": "GCP Secret Manager with rotation config"},
            {"provider": "gcp", "command": "gcloud secrets describe <secret> --format='value(rotation)'", "description": "GCP secret rotation policy details"},
            {"provider": "aws", "command": "aws secretsmanager describe-secret --secret-id <id> --query '{Name:Name,RotationEnabled:RotationEnabled,RotationRules:RotationRules}'", "description": "AWS Secrets Manager rotation config"},
            {"provider": "azure", "command": "az keyvault secret show --vault-name <vault> --name <secret> --query '{expires:attributes.expires,enabled:attributes.enabled}'", "description": "Key Vault secret attributes"},
            {"provider": "hashicorp", "api": "/v1/sys/mounts/<mount>/tune", "description": "Vault mount configuration and TTL settings"},
            {"provider": "cyberark", "api": "/PasswordVault/api/Safes/<safe>/Members", "description": "CyberArk safe membership and permissions"}
          ]
        },
        {
          "type": "log",
          "description": "Secret access and rotation audit logs",
          "tip": "Monitor for unauthorized access attempts, failed retrievals, and verify rotation events occur on schedule. Alert on any manual secret access by humans (should be rare).",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'resource.type=\"secretmanager.googleapis.com/Secret\" AND protoPayload.methodName:(\"AccessSecretVersion\" OR \"AddSecretVersion\")' --format=json", "description": "GCP Secret Manager access logs"},
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventSource,AttributeValue=secretsmanager.amazonaws.com --query 'Events[].{Time:EventTime,Event:CloudTrailEvent}'", "description": "AWS Secrets Manager CloudTrail events"},
            {"provider": "hashicorp", "api": "/v1/sys/audit", "description": "Vault audit logs"},
            {"provider": "azure", "command": "az monitor activity-log list --resource-group <rg> --resource-type Microsoft.KeyVault/vaults --query '[].{time:eventTimestamp,operation:operationName.localizedValue,status:status.localizedValue}'", "description": "Key Vault activity logs"}
          ]
        },
        {
          "type": "inventory",
          "description": "Secret inventory and ownership",
          "tip": "Maintain a complete inventory of all secrets with clear ownership. Identify any secrets that haven't rotated recently or have no defined owner - these are compliance risks.",
          "sources": [
            {"provider": "gcp", "command": "gcloud secrets list --format='table(name,createTime,labels)'", "description": "GCP Secret Manager inventory with labels"},
            {"provider": "aws", "command": "aws secretsmanager list-secrets --query 'SecretList[].{Name:Name,LastRotatedDate:LastRotatedDate,Tags:Tags}'", "description": "AWS Secrets Manager inventory"},
            {"provider": "azure", "command": "az keyvault secret list --vault-name <vault> --query '[].{name:name,created:attributes.created,updated:attributes.updated}'", "description": "Key Vault secret inventory"},
            {"provider": "hashicorp", "api": "/v1/secret/metadata?list=true", "description": "Vault secrets list with metadata"}
          ]
        },
        {
          "type": "scan",
          "description": "Secret exposure detection",
          "tip": "Continuously scan for exposed secrets in code, logs, and configuration. Any detected exposure requires immediate rotation and incident response.",
          "sources": [
            {"provider": "gcp", "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=category=\"SECRETS_IN_SOURCE_CODE\"", "description": "GCP Security Command Center secret findings"},
            {"provider": "github", "api": "/repos/{owner}/{repo}/secret-scanning/alerts", "description": "GitHub secret scanning alerts"},
            {"provider": "gitleaks", "command": "gitleaks detect --source <repo> --report-format json", "description": "Gitleaks secret detection"},
            {"provider": "trufflehog", "command": "trufflehog git file://<repo> --json", "description": "TruffleHog secret scanning"}
          ]
        }
      ]
    },
    "KSI-SVC-07": {
      "name": "Patching",
      "evidence": [
        {
          "type": "report",
          "description": "Patch compliance status",
          "tip": "FedRAMP patch SLAs: Critical within 30 days, High within 30 days, Moderate within 90 days. Track percentage of systems at 100% compliance. Containerized workloads need image update tracking.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute instances os-inventory list-instances --format='table(instance,shortName,installedPackages)'", "description": "GCP OS inventory for patch status"},
            {"provider": "gcp", "command": "gcloud container images list-tags <image> --format='table(digest,timestamp)'", "description": "GCP container image update history"},
            {"provider": "aws", "command": "aws ssm describe-instance-patch-states", "description": "SSM Patch Manager status"},
            {"provider": "azure", "command": "az vm assess-patches --resource-group <rg> --name <vm>", "description": "Azure Update Manager assessment"},
            {"provider": "qualys", "api": "/api/2.0/fo/scan/compliance/", "description": "Qualys patch compliance"}
          ]
        },
        {
          "type": "metrics",
          "description": "Patch SLA compliance metrics",
          "tip": "Track Mean Time to Patch (MTTP) by severity. Report on percentage meeting SLA and any exceptions. Show trending improvement over time.",
          "sources": [
            {"provider": "gcp", "api": "osconfig.googleapis.com/v1/projects/{project}/patchJobs", "description": "GCP OS Config patch job history"},
            {"provider": "tenable", "api": "/workbenches/assets", "description": "Tenable asset patch status"},
            {"provider": "manual", "artifact": "Patch compliance dashboard with SLA tracking"}
          ]
        }
      ]
    },
    "KSI-SVC-08": {
      "name": "Shared Resources",
      "evidence": [
        {
          "type": "configuration",
          "description": "Multi-tenant isolation configuration",
          "tip": "Verify strong isolation between tenants. GCP uses projects, AWS uses accounts, K8s uses namespaces+NetworkPolicies. Shared resources need additional controls.",
          "sources": [
            {"provider": "gcp", "command": "gcloud projects list --format='table(projectId,parent)'", "description": "GCP project hierarchy (isolation boundary)"},
            {"provider": "gcp", "command": "gcloud resource-manager folders list --organization=<org>", "description": "GCP folder structure for tenant isolation"},
            {"provider": "gcp", "command": "gcloud compute sole-tenancy node-templates list", "description": "GCP sole-tenant nodes (dedicated hardware)"},
            {"provider": "aws", "command": "aws ec2 describe-instances --query 'Reservations[].Instances[].{id:InstanceId,tenancy:Placement.Tenancy}'", "description": "EC2 tenancy configuration"},
            {"provider": "kubernetes", "command": "kubectl get networkpolicies --all-namespaces -o json", "description": "Kubernetes network policies for isolation"},
            {"provider": "kubernetes", "command": "kubectl get resourcequotas --all-namespaces -o yaml", "description": "Kubernetes resource quotas per namespace"}
          ]
        },
        {
          "type": "documentation",
          "description": "Tenant isolation architecture",
          "tip": "Document isolation boundaries between tenants. Include network, compute, storage, and data isolation. Shared services should be explicitly called out with additional controls.",
          "sources": [
            {"provider": "manual", "artifact": "Multi-tenancy architecture diagram"},
            {"provider": "manual", "artifact": "Shared services risk assessment"}
          ]
        }
      ]
    },
    "KSI-SVC-09": {
      "name": "Communication Integrity",
      "evidence": [
        {
          "type": "configuration",
          "description": "Service-to-service communication security",
          "tip": "All internal service communication should use mTLS. Verify mutual authentication (both sides validate certificates). Check for any plaintext internal traffic.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute backend-services list --format='table(name,protocol,securitySettings)'", "description": "GCP backend service security settings"},
            {"provider": "gcp", "command": "gcloud anthos auth describe <membership>", "description": "GCP Anthos service mesh mTLS status"},
            {"provider": "istio", "command": "istioctl proxy-config cluster <pod>", "description": "Istio service mesh mTLS"},
            {"provider": "aws", "command": "aws appmesh describe-virtual-service --mesh-name <mesh> --virtual-service-name <svc>", "description": "App Mesh TLS configuration"},
            {"provider": "kubernetes", "command": "kubectl get peerauthentication --all-namespaces -o json", "description": "Istio PeerAuthentication policies"},
            {"provider": "linkerd", "command": "linkerd viz stat deploy -n <namespace>", "description": "Linkerd mTLS status"}
          ]
        },
        {
          "type": "scan",
          "description": "Internal traffic encryption verification",
          "tip": "Periodically verify no plaintext internal traffic. Network captures should show only encrypted payloads between services.",
          "sources": [
            {"provider": "gcp", "command": "gcloud compute packet-mirrorings list", "description": "GCP packet mirroring for traffic analysis"},
            {"provider": "istio", "command": "istioctl analyze --all-namespaces", "description": "Istio configuration analysis for mTLS gaps"}
          ]
        }
      ]
    },
    "KSI-SVC-10": {
      "name": "Data Destruction",
      "evidence": [
        {
          "type": "log",
          "description": "Data deletion records",
          "tip": "Maintain audit trail of all data deletion requests and completions. Include requestor, approval, execution, and verification. Cryptographic erasure may be used for encrypted data.",
          "sources": [
            {"provider": "gcp", "command": "gcloud logging read 'protoPayload.methodName:(\"storage.objects.delete\" OR \"bigquery.tables.delete\")' --format=json", "description": "GCP data deletion audit logs"},
            {"provider": "gcp", "command": "gcloud kms keys versions destroy <version> --key=<key> --keyring=<ring> --location=<location>", "description": "GCP crypto-shredding via key destruction"},
            {"provider": "aws", "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=DeleteObject", "description": "S3 deletion events"},
            {"provider": "manual", "artifact": "Data destruction certificates"},
            {"provider": "manual", "artifact": "Customer data deletion request logs"}
          ]
        },
        {
          "type": "documentation",
          "description": "Data destruction procedures",
          "tip": "Document data destruction procedures including media sanitization, verification, and certificate issuance. Procedures should cover all data locations including backups.",
          "sources": [
            {"provider": "manual", "artifact": "Data destruction policy and procedures"},
            {"provider": "manual", "artifact": "Backup data retention and destruction schedule"}
          ]
        }
      ]
    },
    "KSI-TPR-01": {
      "name": "Third-Party Dependencies",
      "evidence": [
        {
          "type": "inventory",
          "description": "Third-party service inventory",
          "sources": [
            {"provider": "manual", "artifact": "Third-party vendor inventory"},
            {"provider": "manual", "artifact": "Vendor risk assessments"}
          ]
        }
      ]
    },
    "KSI-TPR-02": {
      "name": "Third-Party Access",
      "evidence": [
        {
          "type": "configuration",
          "description": "Third-party access controls",
          "sources": [
            {"provider": "aws", "command": "aws iam list-roles --query 'Roles[?contains(AssumeRolePolicyDocument,`sts:AssumeRole`)]'", "description": "Cross-account IAM roles"},
            {"provider": "okta", "api": "/api/v1/apps", "description": "Third-party app integrations"}
          ]
        }
      ]
    },
    "KSI-TPR-03": {
      "name": "Supply Chain Risk Management",
      "evidence": [
        {
          "type": "report",
          "description": "Vendor security assessments",
          "sources": [
            {"provider": "securityscorecard", "api": "/portfolios/{id}/companies", "description": "SecurityScorecard vendor ratings"},
            {"provider": "bitsight", "api": "/ratings/v1/companies", "description": "BitSight vendor ratings"},
            {"provider": "manual", "artifact": "Vendor security questionnaire responses"}
          ]
        }
      ]
    },
    "KSI-TPR-04": {
      "name": "Supply Chain Risk Monitoring",
      "evidence": [
        {
          "type": "scan",
          "description": "Dependency vulnerability monitoring",
          "sources": [
            {"provider": "github", "api": "/repos/{owner}/{repo}/dependabot/alerts", "description": "Dependabot alerts"},
            {"provider": "snyk", "api": "/org/{orgId}/projects", "description": "Snyk project vulnerabilities"},
            {"provider": "dependencycheck", "command": "dependency-check --scan . --format JSON", "description": "OWASP Dependency-Check scan"}
          ]
        }
      ]
    }
  }
}
