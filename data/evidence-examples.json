{
  "$schema": "./evidence-examples.schema.json",
  "disclaimer": "These evidence examples are community suggestions to help with FedRAMP compliance automation. They are NOT official FedRAMP guidance. Always verify requirements with official FedRAMP documentation at https://fedramp.gov",
  "version": "1.0.0",
  "lastUpdated": "2025-12-29",
  "examples": {
    "KSI-AFR-01": {
      "name": "Minimum Assessment Scope",
      "evidence": [
        {
          "type": "documentation",
          "description": "System boundary documentation",
          "tip": "Boundary must include all components that process, store, or transmit federal data. Include inherited controls from CSP. Document interconnections explicitly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud organizations describe <org-id> --format='table(displayName,directoryCustomerId)'",
              "description": "GCP Organization structure",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/organizations/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud projects list --format='table(projectId,name,parent.id)'",
              "description": "GCP project inventory",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/projects/list"
            },
            {
              "provider": "manual",
              "artifact": "System Security Plan (SSP) boundary diagrams"
            },
            {
              "provider": "aws",
              "command": "aws organizations describe-organization",
              "description": "AWS Organization structure",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/organizations/describe-organization.html"
            },
            {
              "provider": "azure",
              "command": "az account list --query '[].{name:name,id:id}'",
              "description": "Azure subscription inventory",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/account"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Asset inventory within assessment scope",
          "tip": "Every asset in the boundary must be inventoried with owner, classification, and function. Use tagging to identify in-scope vs out-of-scope resources.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-resources --scope=organizations/<org> --query='labels.fedramp:inscope'",
              "description": "GCP Cloud Asset Inventory with FedRAMP tags",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-resources"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute instances list --format='table(name,zone,labels)'",
              "description": "GCP VM inventory with labels",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/list"
            },
            {
              "provider": "aws",
              "command": "aws resourcegroupstaggingapi get-resources --tag-filters Key=FedRAMP,Values=InScope",
              "description": "Tagged in-scope resources",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/resourcegroupstaggingapi/get-resources.html"
            },
            {
              "provider": "azure",
              "command": "az resource list --tag FedRAMP=InScope",
              "description": "Tagged Azure resources",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/resource"
            }
          ]
        }
      ]
    },
    "KSI-AFR-02": {
      "name": "Key Security Indicators",
      "evidence": [
        {
          "type": "report",
          "description": "KSI implementation tracking",
          "tip": "All 72 KSIs must be addressed. Document implementation status, evidence sources, and any gaps. Review KSI status monthly and report quarterly.",
          "sources": [
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=category:*",
              "description": "GCP SCC findings mapped to KSIs"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"GeneratorId\":[{\"Value\":\"security-control\",\"Comparison\":\"PREFIX\"}]}'",
              "description": "AWS Security Hub control findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security secure-score-controls list --query '[].{name:displayName,score:current,max:max}'",
              "description": "Azure Secure Score controls",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Security/secureScores",
              "description": "Azure Security Center scores API"
            },
            {
              "provider": "manual",
              "artifact": "KSI compliance matrix with status for each indicator"
            },
            {
              "provider": "api",
              "description": "This MCP server's analyze_control_coverage output"
            },
            {
              "provider": "manual",
              "artifact": "KSI gap analysis and remediation plan"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "KSI compliance metrics",
          "tip": "Track percentage of KSIs fully implemented vs partial vs not started. Show improvement trend over time.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='state=\"ACTIVE\"' --format='value(finding.category)' | sort | uniq -c",
              "description": "GCP findings by category (KSI mapping)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"ComplianceStatus\":[{\"Value\":\"PASSED\",\"Comparison\":\"EQUALS\"}]}' --query 'length(Findings)'",
              "description": "AWS passing controls count",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security assessment list --query 'length([?status.code==`Healthy`])'",
              "description": "Azure healthy assessments count",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "manual",
              "artifact": "KSI dashboard with implementation percentages"
            },
            {
              "provider": "api",
              "description": "This MCP server's get_theme_summary for each theme"
            }
          ]
        }
      ]
    },
    "KSI-AFR-03": {
      "name": "Authorization Data Sharing",
      "evidence": [
        {
          "type": "configuration",
          "description": "Data sharing agreements and configurations",
          "tip": "Document all data sharing with other FedRAMP systems. Include interconnection security agreements (ISAs) for system-to-system connections.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-iam-policies --scope=organizations/<org> --query='policy.bindings.members:*' --format=json | jq '.[] | select(.policy.bindings[].members[] | contains(\"@\"))'",
              "description": "GCP cross-org IAM bindings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-iam-policies"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute shared-vpc list-associated-resources <host-project>",
              "description": "GCP Shared VPC associations",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/shared-vpc/list-associated-resources"
            },
            {
              "provider": "aws",
              "command": "aws ram list-resources --resource-owner SELF",
              "description": "AWS Resource Access Manager shares",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ram/list-resources.html"
            },
            {
              "provider": "azure",
              "command": "az role assignment list --query '[?principalType==`ServicePrincipal`].{principal:principalName,role:roleDefinitionName,scope:scope}'",
              "description": "Azure cross-tenant service principals",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/role"
            },
            {
              "provider": "azure",
              "command": "az network private-endpoint-connection list --name <resource> --resource-group <rg> --type <type>",
              "description": "Azure Private Endpoint connections",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "manual",
              "artifact": "Authorization Data Sharing (ADS) agreements"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Interconnection agreements",
          "tip": "Each interconnection needs an ISA or MOU documenting security responsibilities, data types, and incident response procedures.",
          "sources": [
            {
              "provider": "azure",
              "command": "az network vnet-peering list --resource-group <rg> --vnet-name <vnet>",
              "description": "Azure VNet peering (cross-network connections)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "manual",
              "artifact": "Interconnection Security Agreements (ISAs)"
            },
            {
              "provider": "manual",
              "artifact": "Memoranda of Understanding (MOUs) for data sharing"
            }
          ]
        }
      ]
    },
    "KSI-AFR-04": {
      "name": "Vulnerability Detection and Response",
      "evidence": [
        {
          "type": "scan",
          "description": "Vulnerability scan results",
          "tip": "Scans must cover all assets: VMs, containers, serverless, and web apps. FedRAMP requires authenticated scanning for accurate results. Verify scan coverage matches your asset inventory.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category=\"VULNERABILITY\"' --format='table(finding.name,finding.severity,finding.state)'",
              "description": "GCP Security Command Center vulnerability findings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "containeranalysis.googleapis.com/v1/projects/{project}/occurrences?filter=kind=\"VULNERABILITY\"",
              "description": "GCP Container Analysis API vulnerabilities"
            },
            {
              "provider": "gcp",
              "command": "gcloud artifacts docker images list <repo> --include-tags --show-occurrences --occurrence-filter='kind=\"VULNERABILITY\"'",
              "description": "GCP Artifact Registry container vulnerabilities",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/docker/images/list"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 list-findings --filter-criteria '{\"findingStatus\":[{\"comparison\":\"EQUALS\",\"value\":\"ACTIVE\"}]}'",
              "description": "AWS Inspector findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security assessment list --query '[?status.code==`Unhealthy`].{name:displayName,severity:metadata.severity,resource:resourceDetails.Id}'",
              "description": "Azure Defender assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "qualys",
              "api": "/api/2.0/fo/scan/",
              "description": "Qualys scan results"
            },
            {
              "provider": "nessus",
              "api": "/scans/{scan_id}/export",
              "description": "Nessus scan export"
            },
            {
              "provider": "trivy",
              "command": "trivy image --format json <image>",
              "description": "Container vulnerability scan"
            },
            {
              "provider": "snyk",
              "api": "/org/{orgId}/projects",
              "description": "Snyk vulnerability findings across projects"
            },
            {
              "provider": "paloalto",
              "api": "api.prismacloud.io/v2/alert",
              "description": "Prisma Cloud alerts",
              "docsUrl": "https://pan.dev/prisma-cloud/api/cspm/get-alerts-v2/"
            },
            {
              "provider": "microsoft365",
              "api": "security.microsoft.com/api/alerts",
              "description": "Microsoft Defender alerts",
              "docsUrl": "https://learn.microsoft.com/en-us/microsoft-365/security/defender/api-list-alerts"
            },
            {
              "provider": "sumologic",
              "api": "/api/sec/v1/threat-intel-sources",
              "description": "Sumo Logic Cloud SIEM",
              "docsUrl": "https://help.sumologic.com/docs/cse/"
            },
            {
              "provider": "crowdstrike",
              "api": "/detects/queries/detects/v1",
              "description": "CrowdStrike Falcon detections",
              "docsUrl": "https://falcon.crowdstrike.com/documentation/85/detection-and-prevention-policies-apis"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Vulnerability remediation SLA compliance",
          "tip": "FedRAMP remediation SLAs: Critical/High within 30 days, Medium within 90 days, Low within 180 days. Track Mean Time to Remediate (MTTR) and percentage meeting SLA.",
          "sources": [
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/findings?filter=state=\"ACTIVE\" AND category=\"VULNERABILITY\"",
              "description": "GCP SCC open vulnerability count over time"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=vulnerability",
              "description": "Vulnerability remediation tickets"
            },
            {
              "provider": "servicenow",
              "api": "/api/now/table/sn_vul_vulnerable_item",
              "description": "ServiceNow vulnerability records"
            },
            {
              "provider": "defectdojo",
              "api": "/api/v2/findings/?active=true",
              "description": "DefectDojo active findings with SLA tracking"
            },
            {
              "provider": "paloalto",
              "api": "api.prismacloud.io/v2/alert",
              "description": "Prisma Cloud alerts",
              "docsUrl": "https://pan.dev/prisma-cloud/api/cspm/get-alerts-v2/"
            }
          ]
        },
        {
          "type": "report",
          "description": "Vulnerability trending and risk posture",
          "tip": "Demonstrate risk reduction over time. Show trending charts of open vulnerabilities by severity. Sudden spikes may indicate new attack surface or scanning gaps.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category=\"VULNERABILITY\" AND state=\"ACTIVE\"' --format='table(finding.severity)' | sort | uniq -c",
              "description": "GCP vulnerability severity distribution",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 list-finding-aggregations --aggregationType SEVERITY",
              "description": "AWS Inspector severity aggregation",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/list-finding-aggregations.html"
            },
            {
              "provider": "qualys",
              "api": "/api/2.0/fo/report/",
              "description": "Qualys trend reports"
            },
            {
              "provider": "tenable",
              "api": "/workbenches/vulnerabilities",
              "description": "Tenable.io vulnerability workbench"
            },
            {
              "provider": "paloalto",
              "api": "api.prismacloud.io/v2/alert",
              "description": "Prisma Cloud alerts",
              "docsUrl": "https://pan.dev/prisma-cloud/api/cspm/get-alerts-v2/"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Automated scanning configuration",
          "tip": "Verify continuous/automated scanning is enabled (not just periodic). Check that all asset types are covered and new resources are automatically enrolled.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud services list --filter='config.name:containerscanning.googleapis.com OR config.name:websecurityscanner.googleapis.com'",
              "description": "GCP security scanning services enabled",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/services/list"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 batch-get-account-status --query 'accounts[].resourceState'",
              "description": "AWS Inspector resource scanning status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/batch-get-account-status.html"
            },
            {
              "provider": "azure",
              "command": "az security auto-provisioning-setting list",
              "description": "Azure Defender auto-provisioning",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "snyk",
              "api": "/org/{orgId}/settings",
              "description": "Snyk organization scanning settings"
            },
            {
              "provider": "paloalto",
              "api": "api.prismacloud.io/v2/alert",
              "description": "Prisma Cloud alerts",
              "docsUrl": "https://pan.dev/prisma-cloud/api/cspm/get-alerts-v2/"
            }
          ]
        }
      ]
    },
    "KSI-AFR-05": {
      "name": "Significant Change Notifications",
      "evidence": [
        {
          "type": "log",
          "description": "Change notification records",
          "tip": "Significant changes require notification to FedRAMP within 30 days. Changes include: new services, major architecture changes, boundary modifications, or security-impacting updates.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"CreateDeployment\" OR \"UpdateDeployment\")' --format=json",
              "description": "GCP Deployment Manager changes",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "command": "gcloud builds list --filter='status=SUCCESS' --format='table(id,createTime,source.repoSource.repoName)'",
              "description": "GCP Cloud Build deployments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/builds/list"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateChangeSet",
              "description": "CloudFormation changes",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?operationName.value contains `deployments/write`].{time:eventTimestamp,resource:resourceId,status:status.value}'",
              "description": "Azure ARM deployment changes",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az deployment group list --resource-group <rg> --query '[].{name:name,time:timestamp,state:properties.provisioningState}'",
              "description": "Azure deployment history",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/deployment"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/releases",
              "description": "Release notifications"
            },
            {
              "provider": "manual",
              "artifact": "Significant Change Request (SCR) log"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "SCR tracking",
          "tip": "Maintain log of all Significant Change Requests with impact analysis, approval, and notification status. Include evidence of FedRAMP notification.",
          "sources": [
            {
              "provider": "azure",
              "command": "az tag list --resource-id <resource> --query 'properties.tags'",
              "description": "Azure resource tags (change tracking)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/tag"
            },
            {
              "provider": "manual",
              "artifact": "SCR register with dates and approvals"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=significant-change",
              "description": "JIRA SCR tickets"
            }
          ]
        }
      ]
    },
    "KSI-AFR-06": {
      "name": "Collaborative Continuous Monitoring",
      "evidence": [
        {
          "type": "report",
          "description": "Continuous monitoring reports",
          "tip": "ConMon deliverables include monthly vulnerability scans, POA&M updates, and incident reports. Annual assessments must cover all controls. Collaborate with 3PAO on assessment schedule.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='state=\"ACTIVE\"' --format='table(finding.category,finding.severity,finding.createTime)'",
              "description": "GCP SCC active findings for ConMon",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/findings:group",
              "description": "GCP SCC findings grouped by category"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"ComplianceStatus\":[{\"Value\":\"FAILED\",\"Comparison\":\"EQUALS\"}]}'",
              "description": "Security Hub compliance findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security assessment list --query '[?status.code==`Unhealthy`].{name:displayName,severity:metadata.severity}'",
              "description": "Azure Defender unhealthy assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "command": "az security task list --query '[].{name:name,state:state,severity:securityTaskParameters.severity}'",
              "description": "Azure security tasks (ConMon action items)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "manual",
              "artifact": "Monthly/Quarterly ConMon reports"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "ConMon metrics dashboard",
          "tip": "Track POA&M aging, vulnerability trends, and control assessment status. Report on percentage of controls validated and any deferred assessments.",
          "sources": [
            {
              "provider": "azure",
              "command": "az security secure-score list --query '[].{name:displayName,current:current,max:max,percentage:percentage}'",
              "description": "Azure Secure Score trends",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "manual",
              "artifact": "ConMon dashboard with KPIs"
            },
            {
              "provider": "manual",
              "artifact": "POA&M aging report"
            }
          ]
        }
      ]
    },
    "KSI-AFR-07": {
      "name": "Recommended Secure Configuration",
      "evidence": [
        {
          "type": "configuration",
          "description": "Secure configuration baselines",
          "tip": "Document secure configuration recommendations for customer implementations. Include hardening guides, reference architectures, and secure defaults.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute project-info describe --format='value(commonInstanceMetadata.items)'",
              "description": "GCP project-level secure defaults",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/project-info/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud resource-manager org-policies list --organization=<org>",
              "description": "GCP Organization policies (security guardrails)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/resource-manager/org-policies/list"
            },
            {
              "provider": "aws",
              "command": "aws ssm list-documents --filters Key=DocumentType,Values=Package",
              "description": "SSM configuration documents",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ssm/list-documents.html"
            },
            {
              "provider": "azure",
              "command": "az policy definition list --query '[?policyType==`BuiltIn`].{name:displayName,category:metadata.category}'",
              "description": "Azure built-in security policies",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "azure",
              "command": "az policy assignment list --query '[].{name:displayName,policy:policyDefinitionId}'",
              "description": "Azure policy assignments (secure defaults)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "cis",
              "artifact": "CIS Benchmark compliance reports"
            },
            {
              "provider": "manual",
              "artifact": "Secure Configuration Guide for customers"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Customer security guidance",
          "tip": "Provide customers with clear security configuration guidance. Include shared responsibility matrix and recommended security settings.",
          "sources": [
            {
              "provider": "azure",
              "command": "az blueprint list --query '[].{name:name,status:status}'",
              "description": "Azure Blueprints (security templates)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/blueprint"
            },
            {
              "provider": "manual",
              "artifact": "Customer Security Configuration Guide"
            },
            {
              "provider": "manual",
              "artifact": "Shared Responsibility Matrix"
            }
          ]
        }
      ]
    },
    "KSI-AFR-08": {
      "name": "FedRAMP Security Inbox",
      "evidence": [
        {
          "type": "configuration",
          "description": "Security inbox configuration",
          "tip": "Dedicated security@company.com or fedramp-security@company.com inbox must be monitored 24/7. Response SLA: acknowledge within 24 hours, initial response within 48 hours.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring alert-policies list --filter='displayName:security-inbox'",
              "description": "GCP alerting for security inbox monitoring",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/alert-policies/list"
            },
            {
              "provider": "aws",
              "command": "aws ses get-identity-verification-attributes --identities security@company.com",
              "description": "AWS SES verified security inbox",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ses/get-identity-verification-attributes.html"
            },
            {
              "provider": "azure",
              "command": "az monitor action-group list --query '[?contains(name,`security`)].{name:name,email:emailReceivers}'",
              "description": "Azure action groups for security alerting",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Security inbox procedures and monitoring evidence"
            },
            {
              "provider": "email",
              "description": "Security inbox activity logs (fedramp-security@company.com)"
            },
            {
              "provider": "pagerduty",
              "api": "/services",
              "description": "PagerDuty escalation for security inbox"
            }
          ]
        },
        {
          "type": "log",
          "description": "Security inbox response tracking",
          "tip": "Log all security inbox communications with timestamps, responders, and resolution. Track response time metrics.",
          "sources": [
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?contains(caller,`security`)].{time:eventTimestamp,caller:caller,operation:operationName.localizedValue}'",
              "description": "Azure security inbox activity",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "zendesk",
              "api": "/api/v2/tickets.json?query=type:ticket",
              "description": "Security ticket tracking"
            },
            {
              "provider": "manual",
              "artifact": "Security inbox response log"
            }
          ]
        }
      ]
    },
    "KSI-AFR-09": {
      "name": "Persistent Validation and Assessment",
      "evidence": [
        {
          "type": "report",
          "description": "Automated compliance validation results",
          "tip": "Implement continuous compliance monitoring. Automate control validation where possible. Alert on compliance drift. Annual 3PAO assessment validates ongoing compliance.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc posture-deployments list --organization=<org>",
              "description": "GCP Security Command Center posture deployments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/posture-deployments/list"
            },
            {
              "provider": "gcp",
              "api": "securityposture.googleapis.com/v1/organizations/{org}/postureDeployments",
              "description": "GCP Security Posture API"
            },
            {
              "provider": "aws",
              "command": "aws configservice get-compliance-summary-by-config-rule",
              "description": "AWS Config compliance",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/configservice/get-compliance-summary-by-config-rule.html"
            },
            {
              "provider": "azure",
              "command": "az policy state summarize",
              "description": "Azure Policy compliance",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "checkov",
              "command": "checkov -d . --output json",
              "description": "IaC compliance scan"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Control validation coverage",
          "tip": "Track percentage of controls with automated validation vs manual. Goal is maximum automation. Report on validation frequency and results.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category:\"COMPLIANCE\"'",
              "description": "GCP compliance findings count",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "manual",
              "artifact": "Control automation coverage report"
            }
          ]
        }
      ]
    },
    "KSI-AFR-10": {
      "name": "Incident Communications Procedures",
      "evidence": [
        {
          "type": "documentation",
          "description": "Incident communication procedures",
          "tip": "FedRAMP requires incident notification within 1 hour of detection for significant incidents. Document escalation paths to FedRAMP PMO and US-CERT.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'severity>=ERROR AND resource.type=\"project\"' --limit=10 --format=json",
              "description": "GCP security event logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws events list-rules --query 'Rules[?contains(Name,`incident`)].{name:Name,state:State}'",
              "description": "AWS EventBridge incident rules",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/events/list-rules.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log alert list --query '[?contains(name,`incident`)].{name:name,enabled:enabled}'",
              "description": "Azure incident alert rules",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Incident Response Plan with FedRAMP ICP integration"
            },
            {
              "provider": "pagerduty",
              "api": "/incidents",
              "description": "Incident notification records"
            },
            {
              "provider": "manual",
              "artifact": "FedRAMP incident notification templates"
            }
          ]
        },
        {
          "type": "log",
          "description": "Incident communication records",
          "tip": "Log all incident communications with timestamps. Include evidence of FedRAMP and US-CERT notifications for reportable incidents.",
          "sources": [
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?level==`Critical` || level==`Error`].{time:eventTimestamp,level:level,description:description}'",
              "description": "Azure critical/error events",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Incident communication log with FedRAMP notifications"
            },
            {
              "provider": "opsgenie",
              "api": "/v2/incidents",
              "description": "OpsGenie incident records"
            }
          ]
        }
      ]
    },
    "KSI-AFR-11": {
      "name": "Using Cryptographic Modules",
      "evidence": [
        {
          "type": "configuration",
          "description": "FIPS 140-2/3 module inventory",
          "tip": "All cryptographic modules must be FIPS 140-2 or 140-3 validated. For FedRAMP High, use FIPS 140-3. Maintain inventory of all crypto modules with certificate numbers.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud kms keys list --location=<location> --keyring=<keyring> --format='table(name,purpose,algorithm)'",
              "description": "GCP Cloud KMS keys (FIPS 140-2 Level 3)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/kms/keys/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud kms keys describe <key> --keyring=<ring> --location=<loc> --format='value(primary.protectionLevel)'",
              "description": "GCP KMS protection level (HSM = FIPS)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/kms/keys/describe"
            },
            {
              "provider": "aws",
              "command": "aws kms describe-key --key-id <key-id> --query 'KeyMetadata.KeySpec'",
              "description": "KMS key configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/kms/describe-key.html"
            },
            {
              "provider": "azure",
              "command": "az keyvault key list --vault-name <vault> --query '[].{name:kid,type:kty}'",
              "description": "Azure Key Vault keys",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "azure",
              "command": "az keyvault show --name <vault> --query 'properties.sku.name'",
              "description": "Azure Key Vault SKU (premium = HSM)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "manual",
              "artifact": "FIPS 140-2/3 validated module certificates"
            },
            {
              "provider": "openssl",
              "command": "openssl version -a",
              "description": "OpenSSL FIPS status"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Cryptographic module inventory",
          "tip": "Document all FIPS modules in use: cloud KMS, HSMs, TLS libraries, encryption software. Include NIST CAVP certificate numbers.",
          "sources": [
            {
              "provider": "azure",
              "command": "az keyvault list --query '[].{name:name,sku:properties.sku.name}'",
              "description": "Azure Key Vaults inventory",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "manual",
              "artifact": "FIPS module inventory with certificate numbers"
            },
            {
              "provider": "nist",
              "artifact": "NIST CAVP certificate verification"
            }
          ]
        }
      ]
    },
    "KSI-CED-01": {
      "name": "General Education",
      "evidence": [
        {
          "type": "report",
          "description": "Security awareness training completion",
          "tip": "All personnel must complete security awareness training within 30 days of onboarding and annually thereafter. Track completion rates - target is 100%.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud identity groups memberships list --group-email=security-trained@<domain>",
              "description": "GCP Cloud Identity group for trained users",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/identity/groups/memberships/list"
            },
            {
              "provider": "aws",
              "command": "aws iam list-users --query 'Users[].{user:UserName,created:CreateDate}'",
              "description": "AWS IAM users (cross-reference with training records)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-users.html"
            },
            {
              "provider": "azure",
              "command": "az ad user list --query '[].{name:displayName,created:createdDateTime}'",
              "description": "Azure AD users for training tracking",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "knowbe4",
              "api": "/v1/training/enrollments",
              "description": "KnowBe4 training status"
            },
            {
              "provider": "workday",
              "api": "/learning/v1/completions",
              "description": "Workday Learning completions"
            },
            {
              "provider": "manual",
              "artifact": "LMS training completion report"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Training compliance metrics",
          "tip": "Report on completion rates, overdue training, and phishing simulation results. Track improvement in phishing click rates over time.",
          "sources": [
            {
              "provider": "azure",
              "command": "az ad user list --query 'length([?accountEnabled==`true`])'",
              "description": "Azure AD active user count (training denominator)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "knowbe4",
              "api": "/v1/phishing/security_tests",
              "description": "KnowBe4 phishing test results"
            },
            {
              "provider": "manual",
              "artifact": "Training compliance dashboard"
            }
          ]
        }
      ]
    },
    "KSI-CED-02": {
      "name": "Role-Specific Education",
      "evidence": [
        {
          "type": "report",
          "description": "Role-based training completion for privileged users",
          "tip": "Privileged users (admins, developers, security) need additional role-specific training. Document training requirements by role and track completion.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-iam-policies --query='policy.bindings.role:roles/owner OR policy.bindings.role:roles/editor' --format=json",
              "description": "GCP privileged users for training tracking",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-iam-policies"
            },
            {
              "provider": "aws",
              "command": "aws iam list-attached-user-policies --user-name <user> --query 'AttachedPolicies[?contains(PolicyName,`Admin`)].PolicyName'",
              "description": "AWS users with admin policies",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-attached-user-policies.html"
            },
            {
              "provider": "azure",
              "command": "az role assignment list --query '[?contains(roleDefinitionName,`Owner`) || contains(roleDefinitionName,`Contributor`)].{user:principalName,role:roleDefinitionName}'",
              "description": "Azure privileged role assignments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/role"
            },
            {
              "provider": "manual",
              "artifact": "Privileged user training matrix"
            },
            {
              "provider": "lms",
              "description": "Role-specific course completion records"
            },
            {
              "provider": "manual",
              "artifact": "Role-based training requirements document"
            }
          ]
        }
      ]
    },
    "KSI-CED-03": {
      "name": "Development and Engineering Education",
      "evidence": [
        {
          "type": "report",
          "description": "Secure development training",
          "tip": "Developers must complete secure coding training (OWASP Top 10, secure SDLC) annually. Track training tied to code commit access.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud source repos list --format='table(name)'",
              "description": "GCP Cloud Source Repos (developers who need training)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/source/repos/list"
            },
            {
              "provider": "aws",
              "command": "aws codecommit list-repositories --query 'repositories[].repositoryName'",
              "description": "AWS CodeCommit repos (developers who need training)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/codecommit/list-repositories.html"
            },
            {
              "provider": "azure",
              "command": "az repos list --query '[].{name:name,project:project.name}'",
              "description": "Azure DevOps repos (developers who need training)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/repos"
            },
            {
              "provider": "manual",
              "artifact": "OWASP/secure coding training records"
            },
            {
              "provider": "github",
              "api": "/orgs/{org}/dependabot/alerts",
              "description": "Developer security alert acknowledgments"
            },
            {
              "provider": "snyk",
              "api": "/org/{orgId}/audit",
              "description": "Snyk developer activity (training triggers)"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Training-gated access",
          "tip": "Consider requiring completed security training before granting commit access to production repositories.",
          "sources": [
            {
              "provider": "azure",
              "command": "az devops security permission list --namespace-id <git-namespace>",
              "description": "Azure DevOps repo permissions",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/devops"
            },
            {
              "provider": "github",
              "api": "/orgs/{org}/teams",
              "description": "GitHub team membership (training-gated)"
            },
            {
              "provider": "manual",
              "artifact": "Access control policy requiring training completion"
            }
          ]
        }
      ]
    },
    "KSI-CED-04": {
      "name": "Incident Response and Disaster Recovery Education",
      "evidence": [
        {
          "type": "report",
          "description": "IR/DR training and drill participation",
          "tip": "IR/DR team members must participate in tabletop exercises at least annually. Document drill scenarios, participants, lessons learned, and action items.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring alert-policies list --filter='userLabels.drill:true'",
              "description": "GCP alert policies used in DR drills",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/alert-policies/list"
            },
            {
              "provider": "aws",
              "command": "aws fis list-experiments --query 'experiments[].{id:id,state:state.status}'",
              "description": "AWS Fault Injection Simulator experiments (chaos engineering)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/fis/list-experiments.html"
            },
            {
              "provider": "azure",
              "command": "az monitor action-group list --query '[?contains(name,`incident`)].{name:name,email:emailReceivers}'",
              "description": "Azure incident action groups",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Tabletop exercise attendance records"
            },
            {
              "provider": "manual",
              "artifact": "DR drill participation logs"
            },
            {
              "provider": "pagerduty",
              "api": "/oncalls",
              "description": "PagerDuty on-call roster (IR team)"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Drill lessons learned",
          "tip": "Document lessons learned from each drill. Track remediation of identified gaps. Use findings to improve IR/DR procedures.",
          "sources": [
            {
              "provider": "azure",
              "command": "az backup job list --query '[?operation==`Restore`].{name:name,status:status,time:startTime}'",
              "description": "Azure backup restore jobs (DR tests)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/backup"
            },
            {
              "provider": "manual",
              "artifact": "Tabletop exercise after-action reports"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=drill-action-item",
              "description": "JIRA drill action items"
            }
          ]
        }
      ]
    },
    "KSI-CMT-01": {
      "name": "Log and Monitor Changes",
      "evidence": [
        {
          "type": "log",
          "description": "Change audit logs",
          "tip": "All infrastructure and application changes must be logged with who, what, when, and why. Enable immutable audit logging. Alert on unauthorized or unexpected changes.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"insert\" OR \"update\" OR \"delete\" OR \"patch\" OR \"create\")' --format=json",
              "description": "GCP Admin Activity audit logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging read 'logName:\"logs/cloudaudit.googleapis.com%2Factivity\"' --format='table(timestamp,protoPayload.methodName,protoPayload.authenticationInfo.principalEmail)'",
              "description": "GCP Cloud Audit activity",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --start-time <date> --end-time <date>",
              "description": "CloudTrail change events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --start-time <date>",
              "description": "Azure Activity Log",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/commits",
              "description": "Git commit history"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Change monitoring alerts",
          "tip": "Configure alerts for high-risk changes: IAM policy modifications, network rule changes, encryption settings, and security group updates.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring alert-policies list --filter='displayName:*change*'",
              "description": "GCP change monitoring alerts",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/alert-policies/list"
            },
            {
              "provider": "aws",
              "command": "aws cloudwatch describe-alarms --alarm-name-prefix security",
              "description": "AWS security change alarms",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/describe-alarms.html"
            }
          ]
        }
      ]
    },
    "KSI-CMT-02": {
      "name": "Redeployment",
      "evidence": [
        {
          "type": "configuration",
          "description": "Immutable infrastructure deployment evidence",
          "tip": "Changes should result in new deployments, not in-place modifications. Use blue-green or canary deployments. Rollback capability is essential.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud run revisions list --format='table(name,status,createTime)'",
              "description": "GCP Cloud Run revisions (immutable deployments)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/run/revisions/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud container clusters get-credentials <cluster> && kubectl rollout history deployment/<name>",
              "description": "GKE deployment rollout history",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/clusters/get-credentials"
            },
            {
              "provider": "aws",
              "command": "aws ecs describe-services --cluster <cluster> --services <service>",
              "description": "ECS deployment configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ecs/describe-services.html"
            },
            {
              "provider": "azure",
              "command": "az webapp deployment list --resource-group <rg> --name <app> --query '[].{id:id,status:status,time:received_time}'",
              "description": "Azure App Service deployment slots",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/webapp"
            },
            {
              "provider": "azure",
              "command": "az aks show --resource-group <rg> --name <cluster> --query 'agentPoolProfiles[].{name:name,count:count}'",
              "description": "Azure AKS cluster (container deployments)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/aks"
            },
            {
              "provider": "argocd",
              "api": "/api/v1/applications",
              "description": "ArgoCD deployment history"
            },
            {
              "provider": "terraform",
              "command": "terraform state list",
              "description": "Terraform managed resources"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Deployment success metrics",
          "tip": "Track deployment frequency, success rate, and rollback frequency. Failed deployments should auto-rollback. Mean time to recovery (MTTR) should be minutes.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud deploy releases list --delivery-pipeline=<pipeline> --format='table(name,renderState,createTime)'",
              "description": "GCP Cloud Deploy release history",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/deploy/releases/list"
            },
            {
              "provider": "azure",
              "command": "az pipelines runs list --query '[].{id:id,result:result,finishTime:finishTime}'",
              "description": "Azure Pipelines deployment runs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/pipelines"
            },
            {
              "provider": "datadog",
              "api": "/api/v1/events",
              "description": "Datadog deployment events"
            }
          ]
        }
      ]
    },
    "KSI-CMT-03": {
      "name": "Automated Testing and Validation",
      "evidence": [
        {
          "type": "report",
          "description": "CI/CD pipeline test results",
          "tip": "All changes must pass automated tests before deployment. Include unit tests, integration tests, security scans, and compliance checks. Block deployments on test failures.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud builds list --format='table(id,status,createTime,source.repoSource.repoName)'",
              "description": "GCP Cloud Build pipeline runs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/builds/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud builds describe <build-id> --format='value(results.images,results.buildStepImages)'",
              "description": "GCP Cloud Build results",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/builds/describe"
            },
            {
              "provider": "aws",
              "command": "aws codepipeline list-pipeline-executions --pipeline-name <pipeline>",
              "description": "AWS CodePipeline execution history",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/codepipeline/list-pipeline-executions.html"
            },
            {
              "provider": "azure",
              "command": "az pipelines runs list --query '[].{id:id,result:result,sourceBranch:sourceBranch}'",
              "description": "Azure Pipelines runs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/pipelines"
            },
            {
              "provider": "azure",
              "command": "az pipelines build list --query '[].{id:id,result:result,buildNumber:buildNumber}'",
              "description": "Azure DevOps build history",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/pipelines"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/actions/runs",
              "description": "GitHub Actions workflow runs"
            },
            {
              "provider": "gitlab",
              "api": "/projects/{id}/pipelines",
              "description": "GitLab CI pipeline history"
            },
            {
              "provider": "jenkins",
              "api": "/job/{name}/api/json",
              "description": "Jenkins build history"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Pipeline security gates",
          "tip": "Require security scan pass, code review approval, and test coverage thresholds before merge. Document bypass procedures for emergencies.",
          "sources": [
            {
              "provider": "azure",
              "command": "az repos policy list --query '[].{type:type.displayName,enabled:isEnabled}'",
              "description": "Azure DevOps branch policies",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/repos"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/branches/{branch}/protection",
              "description": "GitHub branch protection rules"
            },
            {
              "provider": "gcp",
              "command": "gcloud deploy delivery-pipelines describe <pipeline> --format='value(serialPipeline.stages)'",
              "description": "GCP Cloud Deploy pipeline stages",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/deploy/delivery-pipelines/describe"
            }
          ]
        }
      ]
    },
    "KSI-CMT-04": {
      "name": "Change Management Procedure",
      "evidence": [
        {
          "type": "documentation",
          "description": "Change management records",
          "tip": "All changes require a change request with impact analysis, approval, and testing plan. CAB reviews high-risk changes. Document change window and rollback plan.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.request.@type:\"type.googleapis.com/google.iam.admin.v1.CreateRoleRequest\"' --format=json",
              "description": "GCP role change requests",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateChangeSet",
              "description": "AWS CloudFormation change sets",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?operationName.value contains `write`].{time:eventTimestamp,resource:resourceId,caller:caller}'",
              "description": "Azure resource changes",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "servicenow",
              "api": "/api/now/table/change_request",
              "description": "ServiceNow change requests"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=type=Change",
              "description": "Jira change tickets"
            },
            {
              "provider": "manual",
              "artifact": "Change Advisory Board (CAB) meeting minutes"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Change success metrics",
          "tip": "Track change success rate, failed changes, and unplanned changes. High failure rate indicates process issues. Target >95% success rate.",
          "sources": [
            {
              "provider": "azure",
              "command": "az pipelines runs list --query 'length([?result==`succeeded`])' ",
              "description": "Azure successful deployment count",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/pipelines"
            },
            {
              "provider": "servicenow",
              "api": "/api/now/stats/change_request",
              "description": "ServiceNow change metrics"
            },
            {
              "provider": "manual",
              "artifact": "Change management dashboard"
            }
          ]
        }
      ]
    },
    "KSI-CMT-05": {
      "name": "Emergency Changes",
      "retired": {
        "version": "25.12A",
        "note": "Retired in FedRAMP 25.12A release. Emergency change procedures remain important but are now covered under other change management KSIs."
      },
      "evidence": [
        {
          "type": "documentation",
          "description": "Emergency change procedures and logs",
          "tip": "Emergency changes bypass normal approval but require post-implementation review within 24-48 hours. Document justification, authorization, and retrospective.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.authorizationInfo.granted=true AND severity>=WARNING' --format=json",
              "description": "GCP emergency access grants",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=Username,AttributeValue=break-glass",
              "description": "AWS break-glass access events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?authorization.action contains `elevate`].{time:eventTimestamp,caller:caller}'",
              "description": "Azure PIM elevation events",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "servicenow",
              "api": "/api/now/table/change_request?sysparm_query=type=emergency",
              "description": "Emergency change records"
            },
            {
              "provider": "manual",
              "artifact": "Emergency change authorization logs"
            },
            {
              "provider": "pagerduty",
              "api": "/incidents?statuses[]=resolved",
              "description": "PagerDuty incidents triggering emergency changes"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Emergency change tracking",
          "tip": "Track frequency of emergency changes. High rate indicates systemic issues. Each emergency change should have a follow-up to prevent recurrence.",
          "sources": [
            {
              "provider": "azure",
              "command": "az ad pim-assignment list --query '[?state==`Active`].{user:principalName,role:roleDefinitionName}'",
              "description": "Azure PIM active assignments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "manual",
              "artifact": "Emergency change frequency report"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=emergency-change",
              "description": "Emergency change follow-up tickets"
            }
          ]
        }
      ]
    },
    "KSI-CNA-01": {
      "name": "Restrict Network Traffic",
      "evidence": [
        {
          "type": "configuration",
          "description": "Network security configuration",
          "tip": "Look for overly permissive rules: 0.0.0.0/0 ingress, any-to-any rules, or unused open ports. Both ingress AND egress should be restricted to least privilege.",
          "sources": [
            {
              "provider": "aws",
              "command": "aws ec2 describe-security-groups --query 'SecurityGroups[*].{ID:GroupId,Name:GroupName,Ingress:IpPermissions,Egress:IpPermissionsEgress}'",
              "description": "Security group rules with ingress/egress details",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-security-groups.html"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-network-acls --query 'NetworkAcls[*].{ID:NetworkAclId,Entries:Entries}'",
              "description": "Network ACL rules",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-network-acls.html"
            },
            {
              "provider": "azure",
              "command": "az network nsg list --query '[].{name:name,rules:securityRules}'",
              "description": "NSG rules",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "azure",
              "command": "az network nsg rule list --nsg-name <nsg> --resource-group <rg>",
              "description": "Detailed NSG rule analysis",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute firewall-rules list --format='table(name,network,direction,priority,sourceRanges,allowed)'",
              "description": "GCP firewall rules with source ranges",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/firewall-rules/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute firewall-rules describe <rule> --format=json",
              "description": "Detailed firewall rule config",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/firewall-rules/describe"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get networkpolicies --all-namespaces -o yaml",
              "description": "Kubernetes NetworkPolicies"
            },
            {
              "provider": "paloalto",
              "api": "api.xdr.paloaltonetworks.com/public_api/v1/endpoints/get_endpoints",
              "description": "Cortex XDR endpoints",
              "docsUrl": "https://cortex-xdr.pan.dev/docs/endpoint-management/get-endpoints/"
            }
          ]
        },
        {
          "type": "scan",
          "description": "Public exposure analysis",
          "tip": "Scan for unintended public exposure. Any resource reachable from 0.0.0.0/0 should be explicitly justified in documentation.",
          "sources": [
            {
              "provider": "aws",
              "command": "aws ec2 describe-instances --query 'Reservations[].Instances[?PublicIpAddress!=null].{ID:InstanceId,PublicIP:PublicIpAddress}'",
              "description": "EC2 instances with public IPs",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html"
            },
            {
              "provider": "prowler",
              "command": "prowler aws --check ec2_securitygroup_allow_ingress_from_internet_to_any_port",
              "description": "Prowler public exposure check"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute instances list --filter='networkInterfaces.accessConfigs:*' --format='table(name,zone,networkInterfaces[0].accessConfigs[0].natIP)'",
              "description": "GCP VMs with external IPs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/list"
            },
            {
              "provider": "azure",
              "command": "az vm list-ip-addresses --query '[].{VM:virtualMachine.name,PublicIP:virtualMachine.network.publicIpAddresses[0].ipAddress}'",
              "description": "Azure VMs with public IPs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "shodan",
              "api": "/shodan/host/{ip}",
              "description": "External view of exposed services"
            },
            {
              "provider": "paloalto",
              "api": "api.xdr.paloaltonetworks.com/public_api/v1/endpoints/get_endpoints",
              "description": "Cortex XDR endpoints",
              "docsUrl": "https://cortex-xdr.pan.dev/docs/endpoint-management/get-endpoints/"
            }
          ]
        },
        {
          "type": "report",
          "description": "Network segmentation compliance",
          "tip": "Verify network segmentation between security zones (DMZ, app tier, data tier). Document trust boundaries and justify any cross-zone traffic.",
          "sources": [
            {
              "provider": "aws",
              "command": "aws ec2 describe-vpcs --query 'Vpcs[*].{ID:VpcId,CIDR:CidrBlock,Tags:Tags}'",
              "description": "VPC inventory with CIDR blocks",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-vpcs.html"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-subnets --query 'Subnets[*].{SubnetId:SubnetId,VpcId:VpcId,CIDR:CidrBlock,AZ:AvailabilityZone}'",
              "description": "Subnet segmentation",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-subnets.html"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute networks subnets list --format='table(name,region,ipCidrRange,network)'",
              "description": "GCP subnet inventory",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/networks/subnets/list"
            },
            {
              "provider": "manual",
              "artifact": "Network architecture diagram showing security zones and trust boundaries"
            },
            {
              "provider": "paloalto",
              "api": "api.xdr.paloaltonetworks.com/public_api/v1/endpoints/get_endpoints",
              "description": "Cortex XDR endpoints",
              "docsUrl": "https://cortex-xdr.pan.dev/docs/endpoint-management/get-endpoints/"
            }
          ]
        }
      ]
    },
    "KSI-CNA-02": {
      "name": "Minimize the Attack Surface",
      "evidence": [
        {
          "type": "scan",
          "description": "Attack surface analysis",
          "tip": "Identify all external-facing assets and open ports. Every public endpoint is attack surface. Regularly audit for unintended exposure and unused services.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instances list --filter='networkInterfaces.accessConfigs:*' --format='table(name,zone,networkInterfaces[0].accessConfigs[0].natIP)'",
              "description": "GCP VMs with external IPs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute forwarding-rules list --format='table(name,IPAddress,target)'",
              "description": "GCP load balancer external IPs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/forwarding-rules/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=category=\"PUBLIC_IP_ADDRESS\"",
              "description": "GCP SCC public IP findings"
            },
            {
              "provider": "trivy",
              "command": "trivy image --severity HIGH,CRITICAL <image>",
              "description": "Container vulnerability scan"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-instances --query 'Reservations[].Instances[].{id:InstanceId,ports:SecurityGroups}'",
              "description": "Exposed instance analysis",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html"
            },
            {
              "provider": "shodan",
              "api": "/shodan/host/{ip}",
              "description": "External exposure analysis"
            },
            {
              "provider": "nuclei",
              "command": "nuclei -l urls.txt -t cves/",
              "description": "Nuclei vulnerability scanning"
            },
            {
              "provider": "paloalto",
              "api": "api.xdr.paloaltonetworks.com/public_api/v1/incidents/get_incidents",
              "description": "Cortex XDR incidents",
              "docsUrl": "https://cortex-xdr.pan.dev/docs/incident-management/get-incidents/"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Public asset inventory",
          "tip": "Maintain a complete inventory of externally accessible resources. Compare against intended public assets - any delta is a risk.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-resources --scope=organizations/<org> --query='networkTags:public OR labels.public:*'",
              "description": "GCP Cloud Asset Inventory search",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-resources"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-instances --filters 'Name=ip-address,Values=*' --query 'Reservations[].Instances[].PublicIpAddress'",
              "description": "AWS public IP inventory",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html"
            },
            {
              "provider": "azure",
              "command": "az network public-ip list --query '[].{name:name,ip:ipAddress,resource:id}'",
              "description": "Azure public IP inventory",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "paloalto",
              "api": "api.xdr.paloaltonetworks.com/public_api/v1/incidents/get_incidents",
              "description": "Cortex XDR incidents",
              "docsUrl": "https://cortex-xdr.pan.dev/docs/incident-management/get-incidents/"
            }
          ]
        }
      ]
    },
    "KSI-CNA-03": {
      "name": "Enforce Traffic Flow",
      "evidence": [
        {
          "type": "log",
          "description": "Network flow logs",
          "tip": "VPC Flow Logs must be enabled on all subnets. Retain logs for at least 1 year. Analyze for unauthorized traffic patterns and denied connections.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute networks subnets list --format='table(name,region,enableFlowLogs,logConfig.aggregationInterval)'",
              "description": "GCP VPC Flow Logs configuration per subnet",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/networks/subnets/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging read 'resource.type=\"gce_subnetwork\" AND logName:\"logs/compute.googleapis.com%2Fvpc_flows\"' --limit=100 --format=json",
              "description": "GCP VPC Flow Logs sample",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-flow-logs",
              "description": "VPC Flow Logs configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-flow-logs.html"
            },
            {
              "provider": "azure",
              "command": "az network watcher flow-log list",
              "description": "Azure Network Watcher flow logs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "manual",
              "artifact": "Network segmentation diagrams"
            },
            {
              "provider": "crowdstrike",
              "api": "/scanner/queries/scans/v1",
              "description": "CrowdStrike vulnerability scans",
              "docsUrl": "https://falcon.crowdstrike.com/documentation/98/spotlight-apis"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Traffic enforcement policies",
          "tip": "Default deny should be enforced. All allowed traffic should be explicitly documented with business justification. East-west traffic should be as restricted as north-south.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute firewall-rules list --format='table(name,network,direction,priority,denied)'",
              "description": "GCP deny rules",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/firewall-rules/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute firewall-policies rules list --firewall-policy=<policy>",
              "description": "GCP hierarchical firewall policies",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/firewall-policies/rules/list"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get networkpolicies --all-namespaces -o yaml",
              "description": "Kubernetes NetworkPolicies"
            },
            {
              "provider": "calico",
              "command": "calicoctl get globalnetworkpolicies -o yaml",
              "description": "Calico network policies"
            },
            {
              "provider": "crowdstrike",
              "api": "/scanner/queries/scans/v1",
              "description": "CrowdStrike vulnerability scans",
              "docsUrl": "https://falcon.crowdstrike.com/documentation/98/spotlight-apis"
            }
          ]
        }
      ]
    },
    "KSI-CNA-04": {
      "name": "Immutable Infrastructure",
      "evidence": [
        {
          "type": "configuration",
          "description": "Immutable infrastructure evidence",
          "tip": "Verify infrastructure is replaced, not modified. No SSH/RDP access in production. All changes via IaC pipeline. Container images should use digests, not mutable tags.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instance-templates list --format='table(name,creationTimestamp,properties.disks[0].source)'",
              "description": "GCP instance templates for immutable VMs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instance-templates/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud container images list-tags <image> --format='table(digest,timestamp)'",
              "description": "GCP Container Registry image digests",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/images/list-tags"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute instances list --format='table(name,creationTimestamp,scheduling.preemptible)'",
              "description": "GCP VM creation dates (old VMs may indicate drift)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/list"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-launch-templates",
              "description": "EC2 launch templates",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-launch-templates.html"
            },
            {
              "provider": "azure",
              "command": "az vm image list --publisher <publisher> --offer <offer> --sku <sku> --all",
              "description": "Azure VM image versions",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "azure",
              "command": "az acr repository show-manifests --name <registry> --repository <repo>",
              "description": "Azure Container Registry manifests/digests",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "docker",
              "command": "docker images --format '{{.Repository}}:{{.Tag}}@{{.Digest}}'",
              "description": "Immutable container images"
            },
            {
              "provider": "terraform",
              "command": "terraform show -json",
              "description": "Infrastructure as Code state"
            }
          ]
        },
        {
          "type": "log",
          "description": "Infrastructure change audit",
          "tip": "Monitor for manual changes that bypass IaC. Any drift from declared state is a compliance risk. Alert on SSH/RDP connections to production.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"compute.instances.insert\" OR \"compute.instances.setMetadata\")' --format=json",
              "description": "GCP Compute Engine change audit",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventSource,AttributeValue=ec2.amazonaws.com",
              "description": "AWS EC2 API calls",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --resource-type Microsoft.Compute/virtualMachines --query '[].{time:eventTimestamp,operation:operationName.value}'",
              "description": "Azure VM change audit",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "driftctl",
              "command": "driftctl scan --from tfstate://terraform.tfstate",
              "description": "Driftctl IaC drift detection"
            }
          ]
        }
      ]
    },
    "KSI-CNA-05": {
      "name": "Unwanted Activity",
      "evidence": [
        {
          "type": "configuration",
          "description": "DDoS and abuse protection",
          "tip": "All external endpoints should have DDoS protection (Cloud Armor, Shield, Cloudflare). WAF should block OWASP Top 10. Rate limiting should be enabled.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute security-policies list --format='table(name,type,rules.len())'",
              "description": "GCP Cloud Armor security policies",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/security-policies/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute security-policies describe <policy> --format=json",
              "description": "GCP Cloud Armor policy rules detail",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/security-policies/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute backend-services list --format='table(name,securityPolicy)'",
              "description": "GCP backend services with Cloud Armor",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/backend-services/list"
            },
            {
              "provider": "aws",
              "command": "aws shield describe-protection",
              "description": "AWS Shield protection status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/shield/describe-protection.html"
            },
            {
              "provider": "aws",
              "command": "aws wafv2 list-web-acls --scope REGIONAL",
              "description": "WAF configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/wafv2/list-web-acls.html"
            },
            {
              "provider": "azure",
              "command": "az network ddos-protection list --query '[].{name:name,state:provisioningState}'",
              "description": "Azure DDoS Protection Plans",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "azure",
              "command": "az network application-gateway waf-policy list --query '[].{name:name,mode:policySettings.mode}'",
              "description": "Azure WAF policies",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "cloudflare",
              "api": "/zones/{zone_id}/settings/security_level",
              "description": "Cloudflare security settings"
            },
            {
              "provider": "akamai",
              "api": "/appsec/v1/configs",
              "description": "Akamai Web Application Firewall configurations"
            },
            {
              "provider": "akamai",
              "api": "/network-lists/v2/network-lists",
              "description": "Akamai network lists (IP blocking)"
            },
            {
              "provider": "akamai",
              "api": "/siteshield/v1/maps",
              "description": "Akamai Site Shield origin protection"
            },
            {
              "provider": "zscaler",
              "api": "/urlFilteringRules",
              "description": "Zscaler ZIA URL filtering rules"
            },
            {
              "provider": "zscaler",
              "api": "/firewallPolicies",
              "description": "Zscaler ZIA firewall policies"
            },
            {
              "provider": "zscaler",
              "api": "/advancedThreatProtection",
              "description": "Zscaler advanced threat protection settings"
            }
          ]
        },
        {
          "type": "log",
          "description": "Attack and abuse detection logs",
          "tip": "Monitor blocked requests, rate limit triggers, and bot detection. Correlate with threat intelligence. Alert on sustained attack patterns.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'resource.type=\"http_load_balancer\" AND jsonPayload.enforcedSecurityPolicy.outcome=\"DENY\"' --format=json",
              "description": "GCP Cloud Armor blocked requests",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws wafv2 get-sampled-requests --web-acl-arn <arn> --rule-metric-name ALL --scope REGIONAL --time-window Start=<start>,End=<end> --max-items 100",
              "description": "AWS WAF sampled requests",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/wafv2/get-sampled-requests.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --resource-provider Microsoft.Network --query '[?contains(operationName.value,`DDoS`)].{time:eventTimestamp,operation:operationName.value}'",
              "description": "Azure DDoS events",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "cloudflare",
              "api": "/zones/{zone_id}/firewall/events",
              "description": "Cloudflare firewall events"
            },
            {
              "provider": "akamai",
              "api": "/siem/v1/configs/{configId}/events",
              "description": "Akamai SIEM security events"
            },
            {
              "provider": "akamai",
              "api": "/appsec/v1/security-events",
              "description": "Akamai WAF attack logs"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Attack volume and mitigation metrics",
          "tip": "Track attack frequency, types, and sources. Measure time to detect and mitigate. Report on false positive rates to ensure legitimate traffic isn't blocked.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring metrics list --filter='metric.type=starts_with(\"loadbalancing.googleapis.com/\")'",
              "description": "GCP LB metrics including Cloud Armor",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/metrics/list"
            },
            {
              "provider": "azure",
              "command": "az network watcher flow-log list --query '[].{name:name,enabled:enabled}'",
              "description": "Azure Network Watcher flow logs for traffic analysis",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "datadog",
              "api": "/api/v1/query?query=sum:waf.blocked_requests{*}",
              "description": "WAF blocked request trends"
            }
          ]
        }
      ]
    },
    "KSI-CNA-06": {
      "name": "High Availability",
      "evidence": [
        {
          "type": "configuration",
          "description": "High availability configuration",
          "tip": "Verify multi-AZ/multi-region deployment for critical services. Load balancers should have health checks. Databases should have failover configured. Target 99.9%+ uptime.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instance-groups managed list --format='table(name,zone,targetSize,autoscaled)'",
              "description": "GCP managed instance groups (HA compute)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instance-groups/managed/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud sql instances describe <instance> --format='value(settings.availabilityType)'",
              "description": "GCP Cloud SQL availability type (REGIONAL = HA)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/sql/instances/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute backend-services list --format='table(name,backends[].group)'",
              "description": "GCP load balancer backends (multi-zone)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/backend-services/list"
            },
            {
              "provider": "aws",
              "command": "aws rds describe-db-clusters --query 'DBClusters[].{id:DBClusterIdentifier,multiAZ:MultiAZ}'",
              "description": "RDS Multi-AZ status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-clusters.html"
            },
            {
              "provider": "aws",
              "command": "aws elbv2 describe-target-health --target-group-arn <arn>",
              "description": "Load balancer health",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/elbv2/describe-target-health.html"
            },
            {
              "provider": "azure",
              "command": "az vm availability-set list --query '[].{name:name,faultDomainCount:platformFaultDomainCount}'",
              "description": "Azure availability sets",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "azure",
              "command": "az sql db show --name <db> --server <server> --resource-group <rg> --query 'zoneRedundant'",
              "description": "Azure SQL zone redundancy",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/sql"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get deployments -o json | jq '.items[].spec.replicas'",
              "description": "Kubernetes replica counts"
            }
          ]
        }
      ]
    },
    "KSI-CNA-07": {
      "name": "Best Practices",
      "evidence": [
        {
          "type": "report",
          "description": "Cloud best practices compliance",
          "tip": "Follow CIS benchmarks and cloud-native security best practices. Address findings from cloud security posture management tools. Prioritize critical/high severity.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category=\"CIS_BENCHMARK\"' --format='table(finding.category,finding.severity,finding.state)'",
              "description": "GCP SCC CIS benchmark findings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/securityHealthAnalyticsSettings",
              "description": "GCP Security Health Analytics settings"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"ProductName\":[{\"Value\":\"AWS Foundational Security Best Practices\",\"Comparison\":\"EQUALS\"}]}'",
              "description": "AWS FSBP findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security assessment list",
              "description": "Azure Security Center assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "prowler",
              "command": "prowler aws --output-formats json",
              "description": "Prowler CIS benchmark scan"
            }
          ]
        }
      ]
    },
    "KSI-CNA-08": {
      "name": "Persistent Assessment and Automated Enforcement",
      "evidence": [
        {
          "type": "report",
          "description": "CSPM findings and auto-remediation",
          "tip": "Enable continuous security posture assessment. Configure auto-remediation for common misconfigurations. Alert on policy violations. Review drift reports weekly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc posture-deployments list --organization=<org>",
              "description": "GCP Security Posture deployments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/posture-deployments/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud resource-manager org-policies list --organization=<org> --format='table(constraint,listPolicy,booleanPolicy)'",
              "description": "GCP Organization Policy enforcement",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/resource-manager/org-policies/list"
            },
            {
              "provider": "aws",
              "command": "aws configservice get-compliance-details-by-config-rule --config-rule-name <rule>",
              "description": "AWS Config rule compliance",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/configservice/get-compliance-details-by-config-rule.html"
            },
            {
              "provider": "azure",
              "command": "az policy state list --query '[?complianceState==`NonCompliant`].{policy:policyDefinitionName,resource:resourceId}'",
              "description": "Azure Policy non-compliant resources",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "azure",
              "command": "az policy remediation list --query '[].{name:name,state:provisioningState}'",
              "description": "Azure Policy auto-remediation tasks",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "wiz",
              "api": "/api/v1/issues",
              "description": "Wiz CSPM findings"
            },
            {
              "provider": "prisma",
              "api": "/v2/alert",
              "description": "Prisma Cloud alerts"
            }
          ]
        }
      ]
    },
    "KSI-IAM-01": {
      "name": "Phishing-Resistant MFA",
      "evidence": [
        {
          "type": "configuration",
          "description": "MFA enforcement policy",
          "tip": "Verify policy REQUIRES phishing-resistant MFA (FIDO2, WebAuthn, passkeys, PIV/CAC). SMS, TOTP, and push notifications do NOT qualify as phishing-resistant under FedRAMP 20x.",
          "sources": [
            {
              "provider": "okta",
              "api": "/api/v1/policies?type=MFA_ENROLL",
              "description": "Okta MFA policy - check for WebAuthn/FIDO2 requirement",
              "docsUrl": "https://developer.okta.com/docs/reference/api/"
            },
            {
              "provider": "azure",
              "api": "/v1.0/policies/authenticationStrengthPolicies",
              "description": "Entra ID authentication strength - look for 'phishingResistant' strength"
            },
            {
              "provider": "azure",
              "api": "/v1.0/policies/conditionalAccessPolicies",
              "description": "Conditional Access policies with authentication strength requirements"
            },
            {
              "provider": "aws",
              "command": "aws iam get-account-summary --query 'SummaryMap.AccountMFAEnabled'",
              "description": "AWS account MFA status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/get-account-summary.html"
            },
            {
              "provider": "aws",
              "command": "aws iam list-virtual-mfa-devices",
              "description": "List MFA devices (check for hardware keys vs virtual)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-virtual-mfa-devices.html"
            },
            {
              "provider": "gcp",
              "command": "gcloud identity groups memberships list --group-email=<group>",
              "description": "GCP Cloud Identity group membership with 2SV status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/identity/groups/memberships/list"
            },
            {
              "provider": "gcp",
              "api": "admin.googleapis.com/admin/directory/v1/users",
              "description": "Google Workspace Admin SDK - user 2SV enrollment"
            },
            {
              "provider": "duo",
              "api": "/admin/v1/users",
              "description": "Duo Admin API - user enrollment and auth methods"
            },
            {
              "provider": "oracle",
              "command": "oci iam user list --compartment-id <tenancy-ocid>",
              "description": "OCI IAM user list",
              "docsUrl": "https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/user/list.html"
            }
          ]
        },
        {
          "type": "report",
          "description": "MFA enrollment status",
          "tip": "100% of users must have phishing-resistant MFA enrolled. Generate reports showing enrollment coverage and the specific MFA type per user.",
          "sources": [
            {
              "provider": "aws",
              "command": "aws iam generate-credential-report && aws iam get-credential-report --output text --query 'Content' | base64 -d",
              "description": "IAM credential report - check mfa_active and hardware_mfa columns",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/generate-credential-report.html"
            },
            {
              "provider": "okta",
              "api": "/api/v1/users?filter=status eq \"ACTIVE\"",
              "description": "User MFA enrollment - check embedded factors for WebAuthn",
              "docsUrl": "https://developer.okta.com/docs/reference/api/users/"
            },
            {
              "provider": "azure",
              "command": "az ad user list --query '[].{UPN:userPrincipalName,authMethods:authenticationMethods}'",
              "description": "Entra ID user authentication methods",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "gcp",
              "command": "gcloud identity users describe <user> --format='value(twoStepVerification)'",
              "description": "GCP user 2-step verification status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/identity/users/describe"
            },
            {
              "provider": "crowdstrike",
              "api": "/identity-protection/entities/users/v1",
              "description": "CrowdStrike Identity - MFA status across IdPs"
            },
            {
              "provider": "oracle",
              "command": "oci iam user list --compartment-id <tenancy-ocid>",
              "description": "OCI IAM user list",
              "docsUrl": "https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/user/list.html"
            }
          ]
        },
        {
          "type": "log",
          "description": "MFA authentication events",
          "tip": "Monitor for successful authentications that bypass MFA or use non-compliant methods. Alert on any fallback to SMS/TOTP.",
          "sources": [
            {
              "provider": "okta",
              "api": "/api/v1/logs?filter=eventType eq \"user.authentication.auth_via_mfa\"",
              "description": "Okta MFA authentication logs",
              "docsUrl": "https://developer.okta.com/docs/reference/api/system-log/"
            },
            {
              "provider": "azure",
              "api": "/v1.0/auditLogs/signIns",
              "description": "Entra ID sign-in logs - filter by authenticationMethodsUsed"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=ConsoleLogin",
              "description": "CloudTrail console login events with MFA info",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName=\"google.login.LoginService.loginSuccess\"' --format=json",
              "description": "GCP login audit logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "oracle",
              "command": "oci iam user list --compartment-id <tenancy-ocid>",
              "description": "OCI IAM user list",
              "docsUrl": "https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/iam/user/list.html"
            }
          ]
        }
      ]
    },
    "KSI-IAM-02": {
      "name": "Passwordless Authentication",
      "evidence": [
        {
          "type": "configuration",
          "description": "Passwordless authentication settings",
          "tip": "Passwordless methods must still be phishing-resistant. FIDO2/WebAuthn qualifies; magic links and SMS OTP do not. Verify fallback methods don't reintroduce password risk.",
          "sources": [
            {
              "provider": "gcp",
              "api": "admin.googleapis.com/admin/directory/v1/users/{userKey}/twoStepVerification",
              "description": "Google Workspace passwordless (passkeys) enrollment"
            },
            {
              "provider": "gcp",
              "command": "gcloud identity groups memberships list --group-email=<group> --format='table(preferredMemberKey.id,roles)'",
              "description": "GCP Cloud Identity member authentication status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/identity/groups/memberships/list"
            },
            {
              "provider": "azure",
              "api": "/v1.0/policies/authenticationMethodsPolicy",
              "description": "Entra ID passwordless methods"
            },
            {
              "provider": "okta",
              "api": "/api/v1/authenticators",
              "description": "Okta authenticator configuration",
              "docsUrl": "https://developer.okta.com/docs/reference/api/"
            },
            {
              "provider": "duo",
              "api": "/admin/v1/users/{user_id}/webauthncredentials",
              "description": "Duo WebAuthn credentials"
            },
            {
              "provider": "salesforce",
              "api": "/services/data/v59.0/query?q=SELECT+Id,Name+FROM+TwoFactorInfo",
              "description": "Salesforce MFA enrollment status"
            },
            {
              "provider": "salesforce",
              "api": "/services/data/v59.0/tooling/query?q=SELECT+Id,DeveloperName+FROM+SessionSettings",
              "description": "Salesforce session security settings"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/people",
              "description": "Webex user management",
              "docsUrl": "https://developer.webex.com/docs/api/v1/people"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Passwordless adoption rate",
          "tip": "Track percentage of users on passwordless vs password-based auth. Goal should be 100% passwordless for privileged users, high adoption for all users.",
          "sources": [
            {
              "provider": "azure",
              "api": "/v1.0/reports/authenticationMethods/usersRegisteredByMethod",
              "description": "Entra ID authentication method registration stats"
            },
            {
              "provider": "okta",
              "api": "/api/v1/org/factors/catalog",
              "description": "Okta factor enrollment statistics",
              "docsUrl": "https://developer.okta.com/docs/reference/api/factors/"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/people",
              "description": "Webex user management",
              "docsUrl": "https://developer.webex.com/docs/api/v1/people"
            }
          ]
        }
      ]
    },
    "KSI-IAM-03": {
      "name": "Non-User Accounts",
      "evidence": [
        {
          "type": "inventory",
          "description": "Service account inventory",
          "tip": "Every service account needs an owner and documented purpose. Flag accounts with no recent activity (stale) or overly broad permissions. Workload identity (no keys) is preferred over key-based auth.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud iam service-accounts list --format='table(email,displayName,disabled)'",
              "description": "GCP service account inventory",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-iam-policies --query='policy:serviceAccount' --format=json",
              "description": "GCP service account IAM bindings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-iam-policies"
            },
            {
              "provider": "aws",
              "command": "aws iam list-roles --query 'Roles[?contains(RoleName,`service`)]'",
              "description": "AWS service roles",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-roles.html"
            },
            {
              "provider": "azure",
              "command": "az ad sp list --filter \"servicePrincipalType eq 'Application'\"",
              "description": "Azure service principals",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get serviceaccounts --all-namespaces -o json",
              "description": "Kubernetes service accounts"
            },
            {
              "provider": "microsoft365",
              "api": "graph.microsoft.com/v1.0/directoryRoles",
              "description": "Microsoft 365 directory roles",
              "docsUrl": "https://learn.microsoft.com/en-us/graph/api/directoryrole-list"
            }
          ]
        },
        {
          "type": "log",
          "description": "Service account key usage",
          "tip": "Monitor for service account key creation/download events - prefer workload identity over keys. Alert on keys older than 90 days.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"CreateServiceAccountKey\" OR \"google.iam.admin.v1.GetServiceAccountKey\")' --format=json",
              "description": "GCP service account key operations",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateAccessKey",
              "description": "AWS access key creation events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "microsoft365",
              "api": "graph.microsoft.com/v1.0/directoryRoles",
              "description": "Microsoft 365 directory roles",
              "docsUrl": "https://learn.microsoft.com/en-us/graph/api/directoryrole-list"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Workload identity configuration",
          "tip": "Workload Identity Federation eliminates long-lived credentials. Verify GKE workloads use Workload Identity, not node service accounts.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud container clusters describe <cluster> --format='value(workloadIdentityConfig)'",
              "description": "GKE Workload Identity status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/clusters/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud iam workload-identity-pools list --location=global",
              "description": "GCP Workload Identity Federation pools",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/list"
            },
            {
              "provider": "aws",
              "command": "aws iam list-open-id-connect-providers",
              "description": "AWS OIDC providers for workload identity",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-open-id-connect-providers.html"
            },
            {
              "provider": "microsoft365",
              "api": "graph.microsoft.com/v1.0/directoryRoles",
              "description": "Microsoft 365 directory roles",
              "docsUrl": "https://learn.microsoft.com/en-us/graph/api/directoryrole-list"
            },
            {
              "provider": "google-workspace",
              "api": "admin.googleapis.com/admin/directory/v1/customer/{customerId}/roles",
              "description": "Google Workspace admin roles",
              "docsUrl": "https://developers.google.com/admin-sdk/directory/reference/rest/v1/roles"
            }
          ]
        }
      ]
    },
    "KSI-IAM-04": {
      "name": "Just-in-Time Authorization",
      "evidence": [
        {
          "type": "log",
          "description": "JIT access requests and approvals",
          "tip": "JIT access should require approval for privileged roles, have short TTLs (1-8 hours typical), and auto-revoke. Verify no standing admin access exists.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"google.cloud.policytroubleshooter\" OR \"SetIamPolicy\") AND protoPayload.request.policy.bindings.condition' --format=json",
              "description": "GCP conditional IAM bindings (time-based access)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "api": "iam.googleapis.com/v1/projects/{project}/serviceAccounts/{sa}:getIamPolicy",
              "description": "GCP IAM policy with conditions"
            },
            {
              "provider": "cyberark",
              "api": "/PasswordVault/API/AccountsRequests",
              "description": "CyberArk access requests"
            },
            {
              "provider": "azure",
              "api": "/v1.0/identityGovernance/privilegedAccess/group/assignmentRequests",
              "description": "Azure PIM requests"
            },
            {
              "provider": "hashicorp",
              "api": "/v1/sys/leases/lookup",
              "description": "Vault lease information"
            },
            {
              "provider": "teleport",
              "api": "/v1/accessrequests",
              "description": "Teleport access requests"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "JIT policy configuration",
          "tip": "Verify JIT is required for all admin/privileged roles. Maximum session duration should align with policy (typically 1-8 hours). Approval workflows should require manager or security approval.",
          "sources": [
            {
              "provider": "azure",
              "api": "/v1.0/policies/roleManagementPolicies",
              "description": "Azure PIM role settings"
            },
            {
              "provider": "gcp",
              "command": "gcloud organizations get-iam-policy <org> --format=json | jq '.bindings[] | select(.condition != null)'",
              "description": "GCP org-level conditional bindings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/organizations/get-iam-policy"
            },
            {
              "provider": "beyondtrust",
              "api": "/api/v3/access-policies",
              "description": "BeyondTrust Privilege Management policies"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Standing privilege elimination",
          "tip": "Track percentage of admin access that is JIT vs standing. Goal is 0% standing admin access. Measure average access duration and approval times.",
          "sources": [
            {
              "provider": "azure",
              "api": "/v1.0/reports/authenticationMethods/usersRegisteredByFeature",
              "description": "PIM usage statistics"
            },
            {
              "provider": "manual",
              "artifact": "JIT adoption metrics dashboard"
            }
          ]
        }
      ]
    },
    "KSI-IAM-05": {
      "name": "Least Privilege",
      "evidence": [
        {
          "type": "report",
          "description": "Access review and permission analysis",
          "tip": "Look for overly permissive policies: '*' actions, unused permissions, cross-account access. IAM Recommender and Access Analyzer identify these automatically.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud recommender recommendations list --recommender=google.iam.policy.Recommender --project=<project> --format='table(name,description,primaryImpact.category)'",
              "description": "GCP IAM Recommender suggestions",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/recommender/recommendations/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud policy-intelligence query-activity --project=<project> --limit=100",
              "description": "GCP Policy Intelligence activity analysis",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/policy-intelligence/query-activity"
            },
            {
              "provider": "gcp",
              "api": "recommender.googleapis.com/v1/projects/{project}/locations/global/recommenders/google.iam.policy.Recommender/recommendations",
              "description": "GCP IAM policy recommendations API"
            },
            {
              "provider": "aws",
              "command": "aws accessanalyzer list-findings --analyzer-arn <arn>",
              "description": "IAM Access Analyzer findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/accessanalyzer/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az role assignment list --all",
              "description": "Azure RBAC assignments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/role"
            },
            {
              "provider": "manual",
              "artifact": "Quarterly access review records"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Role and permission definitions",
          "tip": "Custom roles should be preferred over primitive roles (Owner/Editor/Viewer). Verify no users have Owner role in production projects.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud projects get-iam-policy <project> --format='table(bindings.role,bindings.members)'",
              "description": "GCP project IAM policy",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/projects/get-iam-policy"
            },
            {
              "provider": "gcp",
              "command": "gcloud iam roles list --project=<project> --format='table(name,title,stage)'",
              "description": "GCP custom roles inventory",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/iam/roles/list"
            },
            {
              "provider": "aws",
              "command": "aws iam list-attached-user-policies --user-name <user>",
              "description": "AWS user attached policies",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-attached-user-policies.html"
            },
            {
              "provider": "azure",
              "command": "az role definition list --custom-role-only",
              "description": "Azure custom role definitions",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/role"
            }
          ]
        },
        {
          "type": "scan",
          "description": "Excessive permission detection",
          "tip": "Scan for dormant permissions (granted but never used), admin access to non-admin resources, and service accounts with user-level roles.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-iam-policies --query='policy.role.permissions:*' --format=json",
              "description": "GCP Cloud Asset Inventory IAM search",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-iam-policies"
            },
            {
              "provider": "aws",
              "command": "aws iam generate-service-last-accessed-details --arn <arn>",
              "description": "AWS service last accessed details",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/generate-service-last-accessed-details.html"
            },
            {
              "provider": "bridgecrew",
              "api": "/api/v1/suppressions",
              "description": "Bridgecrew/Checkov least privilege findings"
            }
          ]
        }
      ]
    },
    "KSI-IAM-06": {
      "name": "Suspicious Activity",
      "evidence": [
        {
          "type": "configuration",
          "description": "Automated account protection rules",
          "tip": "Configure automated detection of suspicious login behavior: impossible travel, unusual devices, anomalous access patterns. Alert and block high-risk activity automatically.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName=\"google.login.LoginService.loginSuccess\" AND severity>=WARNING' --format=json",
              "description": "GCP Cloud Identity suspicious login events",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category:(\"IAM_ANOMALOUS_GRANT\" OR \"BRUTE_FORCE_SSH\" OR \"ACCOUNT_HAS_LEAKED_CREDENTIALS\")'",
              "description": "GCP SCC IAM-related suspicious activity findings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=category:IAM*",
              "description": "GCP SCC IAM threat findings API"
            },
            {
              "provider": "okta",
              "api": "/api/v1/behaviors",
              "description": "Okta behavior detection rules",
              "docsUrl": "https://developer.okta.com/docs/reference/api/"
            },
            {
              "provider": "azure",
              "api": "/v1.0/identityProtection/riskDetections",
              "description": "Entra ID risk detections"
            },
            {
              "provider": "aws",
              "command": "aws guardduty list-findings --detector-id <id>",
              "description": "GuardDuty IAM-related findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/guardduty/list-findings.html"
            }
          ]
        }
      ]
    },
    "KSI-IAM-07": {
      "name": "Automated Account Management",
      "evidence": [
        {
          "type": "log",
          "description": "Account lifecycle automation logs",
          "tip": "User provisioning/deprovisioning should be automated via SCIM or HR integration. Departing users must be disabled within 24 hours. Review orphaned accounts monthly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud identity groups memberships list --group-email=<group>",
              "description": "GCP Cloud Identity group memberships",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/identity/groups/memberships/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"CreateUser\" OR \"DeleteUser\")' --format=json",
              "description": "GCP user lifecycle audit logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=CreateUser",
              "description": "IAM user creation events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az ad user list --query '[?accountEnabled==`false`].{name:displayName,created:createdDateTime}'",
              "description": "Azure AD disabled users",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "azure",
              "api": "graph.microsoft.com/v1.0/auditLogs/directoryAudits?$filter=activityDisplayName eq 'Add user'",
              "description": "Azure AD user provisioning audit"
            },
            {
              "provider": "okta",
              "api": "/api/v1/logs?filter=eventType eq \"user.lifecycle.create\"",
              "description": "Okta user lifecycle events",
              "docsUrl": "https://developer.okta.com/docs/reference/api/system-log/"
            },
            {
              "provider": "scim",
              "description": "SCIM provisioning logs"
            }
          ]
        }
      ]
    },
    "KSI-INR-01": {
      "name": "Incident Response Procedure",
      "evidence": [
        {
          "type": "documentation",
          "description": "Incident response procedures",
          "tip": "IR plan must cover detection, analysis, containment, eradication, recovery, and lessons learned. Include FedRAMP notification requirements (1 hour for significant incidents).",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc notifications list --organization=<org>",
              "description": "GCP SCC notification channels for incident alerting",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/notifications/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud monitoring alert-policies list --filter='severity=CRITICAL OR severity=ERROR'",
              "description": "GCP critical alerting policies",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/alert-policies/list"
            },
            {
              "provider": "aws",
              "command": "aws sns list-subscriptions-by-topic --topic-arn <security-alerts-topic>",
              "description": "AWS SNS security alert subscriptions",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/sns/list-subscriptions-by-topic.html"
            },
            {
              "provider": "azure",
              "command": "az monitor action-group list --query '[?contains(name,`security`) || contains(name,`incident`)].{name:name,email:emailReceivers}'",
              "description": "Azure incident action groups",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Incident Response Plan document"
            },
            {
              "provider": "pagerduty",
              "api": "/response_plays",
              "description": "PagerDuty response plays"
            },
            {
              "provider": "opsgenie",
              "api": "/v2/policies",
              "description": "Opsgenie escalation policies"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Incident detection and alerting",
          "tip": "Automated detection should cover: unauthorized access attempts, malware, data exfiltration, DoS, and privilege escalation. Response should be automated where possible.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='state=\"ACTIVE\" AND severity=\"CRITICAL\"'",
              "description": "GCP SCC critical findings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "aws",
              "command": "aws guardduty list-findings --detector-id <id> --finding-criteria '{\"Criterion\":{\"severity\":{\"Gte\":7}}}'",
              "description": "AWS GuardDuty high-severity findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/guardduty/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security alert list --query '[?status==`Active`].{name:name,severity:severity}'",
              "description": "Azure Security Center active alerts",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "crowdstrike",
              "api": "/detects/queries/detects/v1",
              "description": "CrowdStrike detection alerts"
            },
            {
              "provider": "sentinel",
              "api": "/incidents",
              "description": "Azure Sentinel incidents"
            }
          ]
        }
      ]
    },
    "KSI-INR-02": {
      "name": "Incident Logging",
      "evidence": [
        {
          "type": "log",
          "description": "Incident records",
          "tip": "Every incident must be logged with: timeline, affected systems, root cause, containment actions, and resolution. Include severity classification and FedRAMP notification status.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'severity>=ERROR' --format='table(timestamp,resource.type,jsonPayload)' --limit=100",
              "description": "GCP error-level logs for incident correlation",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/findings?filter=state=\"ACTIVE\"",
              "description": "GCP SCC active findings"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventSource,AttributeValue=guardduty.amazonaws.com",
              "description": "AWS GuardDuty incident events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?level==`Critical` || level==`Error`].{time:eventTimestamp,level:level,resource:resourceId}'",
              "description": "Azure critical/error activity logs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "servicenow",
              "api": "/api/now/table/incident",
              "description": "ServiceNow incidents"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=type=Incident",
              "description": "Jira incident tickets"
            },
            {
              "provider": "pagerduty",
              "api": "/incidents",
              "description": "PagerDuty incident history"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Incident metrics",
          "tip": "Track MTTD (detect), MTTA (acknowledge), MTTR (resolve). Monitor incident volume trends. High-severity incidents should decrease over time.",
          "sources": [
            {
              "provider": "aws",
              "command": "aws securityhub get-insights --insight-arns <arn>",
              "description": "AWS Security Hub incident insights",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-insights.html"
            },
            {
              "provider": "azure",
              "command": "az security alert list --query 'length([?status==`Resolved`])'",
              "description": "Azure resolved security alerts count",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "pagerduty",
              "api": "/analytics/metrics/incidents/all",
              "description": "PagerDuty incident analytics"
            },
            {
              "provider": "manual",
              "artifact": "Incident metrics dashboard"
            }
          ]
        }
      ]
    },
    "KSI-INR-03": {
      "name": "Incident After Action Reports",
      "evidence": [
        {
          "type": "documentation",
          "description": "Post-incident reviews",
          "tip": "Every significant incident requires a blameless post-mortem within 5 business days. Document root cause, timeline, impact, and corrective actions. Track action item completion.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:\"scc\" AND severity>=WARNING' --format=json",
              "description": "GCP SCC activity during incident window",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws ssm-incidents list-incident-records --query 'incidentRecordSummaries[].{title:title,status:status,impact:impact}'",
              "description": "AWS Incident Manager records",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ssm-incidents/list-incident-records.html"
            },
            {
              "provider": "azure",
              "command": "az security alert list --query '[?status==`Resolved`].{name:name,time:timeGeneratedUtc}'",
              "description": "Azure resolved security alerts for post-mortem",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "manual",
              "artifact": "Post-mortem/After Action Report documents"
            },
            {
              "provider": "blameless",
              "api": "/api/v1/incidents/{id}/retrospective",
              "description": "Blameless retrospectives"
            },
            {
              "provider": "incidentio",
              "api": "/v2/post_incident_tasks",
              "description": "Incident.io follow-up tasks"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Post-incident action tracking",
          "tip": "Track action item completion rate and time to completion. Recurring incidents indicate systemic issues. Root causes should be permanently addressed.",
          "sources": [
            {
              "provider": "azure",
              "command": "az boards work-item query --wiql \"SELECT [System.Id] FROM WorkItems WHERE [System.Tags] CONTAINS 'post-mortem'\"",
              "description": "Azure DevOps post-mortem work items",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/boards"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=post-mortem-action",
              "description": "JIRA post-mortem action items"
            },
            {
              "provider": "manual",
              "artifact": "Action item completion report"
            }
          ]
        }
      ]
    },
    "KSI-MLA-01": {
      "name": "Security Information and Event Management (SIEM)",
      "evidence": [
        {
          "type": "configuration",
          "description": "SIEM configuration and coverage",
          "tip": "SIEM must be centralized and tamper-resistant. Verify all log sources are connected and retention meets FedRAMP requirements (typically 1 year online, 3 years archived for moderate).",
          "sources": [
            {
              "provider": "splunk",
              "api": "/services/data/inputs",
              "description": "Splunk data inputs - verify all critical sources"
            },
            {
              "provider": "splunk",
              "api": "/services/saved/searches",
              "description": "Splunk correlation rules and alerts"
            },
            {
              "provider": "azure",
              "command": "az sentinel data-connector list --workspace-name <ws> --resource-group <rg>",
              "description": "Sentinel data connectors",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/sentinel"
            },
            {
              "provider": "azure",
              "command": "az monitor log-analytics workspace show --workspace-name <ws> --query 'retentionInDays'",
              "description": "Log Analytics retention setting",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "elastic",
              "api": "/_cat/indices?v",
              "description": "Elasticsearch log indices"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging sinks list --format='table(name,destination,filter)'",
              "description": "GCP Cloud Logging sinks",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/sinks/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging buckets describe _Default --location=global --format='value(retentionDays)'",
              "description": "GCP log bucket retention",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/buckets/describe/_Default"
            },
            {
              "provider": "aws",
              "command": "aws logs describe-log-groups --query 'logGroups[*].{Name:logGroupName,Retention:retentionInDays}'",
              "description": "CloudWatch Logs retention settings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/logs/describe-log-groups.html"
            },
            {
              "provider": "chronicle",
              "api": "/v1/detect/rules",
              "description": "Google Chronicle detection rules"
            },
            {
              "provider": "akamai",
              "api": "/siem/v1/configs",
              "description": "Akamai SIEM integration configurations"
            },
            {
              "provider": "akamai",
              "api": "/datastream/v2/streams",
              "description": "Akamai DataStream log delivery"
            },
            {
              "provider": "salesforce",
              "api": "/services/data/v59.0/query?q=SELECT+Id,LogDate+FROM+EventLogFile",
              "description": "Salesforce Event Monitoring logs"
            },
            {
              "provider": "salesforce",
              "api": "/services/data/v59.0/query?q=SELECT+Id,Action+FROM+SetupAuditTrail",
              "description": "Salesforce Setup Audit Trail"
            },
            {
              "provider": "zscaler",
              "api": "/webApplicationRules",
              "description": "Zscaler ZIA policy configurations"
            },
            {
              "provider": "zscaler",
              "api": "/adminAuditLogs",
              "description": "Zscaler admin audit logs"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/admin/events",
              "description": "Webex admin audit events",
              "docsUrl": "https://developer.webex.com/docs/api/v1/admin-audit-events"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Log source coverage",
          "tip": "Document all systems in scope and verify each has log forwarding enabled. Missing sources = compliance gaps.",
          "sources": [
            {
              "provider": "splunk",
              "api": "/services/data/indexes",
              "description": "Splunk index inventory with sourcetypes"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail describe-trails --query 'trailList[*].{Name:Name,S3Bucket:S3BucketName,IsMultiRegion:IsMultiRegionTrail}'",
              "description": "CloudTrail configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/describe-trails.html"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging logs list --format='table(name)'",
              "description": "GCP log types being captured",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/logs/list"
            },
            {
              "provider": "azure",
              "command": "az monitor diagnostic-settings list --resource <resource-id>",
              "description": "Azure diagnostic settings per resource",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Log source matrix mapping systems to SIEM data sources"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/admin/events",
              "description": "Webex admin audit events",
              "docsUrl": "https://developer.webex.com/docs/api/v1/admin-audit-events"
            }
          ]
        },
        {
          "type": "log",
          "description": "SIEM operational health",
          "tip": "Monitor SIEM itself for gaps in ingestion. Alert on missing data or ingestion delays.",
          "sources": [
            {
              "provider": "splunk",
              "api": "/services/server/introspection/indexer",
              "description": "Splunk indexer health metrics"
            },
            {
              "provider": "datadog",
              "api": "/api/v1/logs/analytics/aggregate",
              "description": "Datadog log analytics"
            },
            {
              "provider": "sumo",
              "api": "/api/v1/collectors",
              "description": "Sumo Logic collector status"
            },
            {
              "provider": "newrelic",
              "api": "/v2/applications.json",
              "description": "New Relic monitored applications"
            },
            {
              "provider": "newrelic",
              "api": "/v2/alerts_policies.json",
              "description": "New Relic alert policies"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/admin/events",
              "description": "Webex admin audit events",
              "docsUrl": "https://developer.webex.com/docs/api/v1/admin-audit-events"
            },
            {
              "provider": "google-workspace",
              "api": "admin.googleapis.com/admin/reports/v1/activity/users/all/applications/admin",
              "description": "Google Workspace admin audit logs",
              "docsUrl": "https://developers.google.com/admin-sdk/reports/reference/rest"
            },
            {
              "provider": "microsoft365",
              "api": "graph.microsoft.com/v1.0/auditLogs/directoryAudits",
              "description": "Microsoft 365 directory audit logs",
              "docsUrl": "https://learn.microsoft.com/en-us/graph/api/directoryaudit-list"
            },
            {
              "provider": "sumologic",
              "api": "/api/v1/logs/search",
              "description": "Sumo Logic log search",
              "docsUrl": "https://help.sumologic.com/docs/api/search-job/"
            },
            {
              "provider": "zoom",
              "api": "api.zoom.us/v2/report/operationlogs",
              "description": "Zoom operation logs",
              "docsUrl": "https://developers.zoom.us/docs/api/rest/reference/report/methods/"
            },
            {
              "provider": "box",
              "api": "api.box.com/2.0/events?stream_type=admin_logs",
              "description": "Box admin audit logs",
              "docsUrl": "https://developer.box.com/guides/events/enterprise-events/"
            },
            {
              "provider": "docusign",
              "api": "monitor.docusign.com/api/v2/datasets/monitor/stream",
              "description": "DocuSign Monitor audit events",
              "docsUrl": "https://developers.docusign.com/docs/monitor-api/"
            },
            {
              "provider": "oracle",
              "command": "oci audit event list --compartment-id <compartment-ocid>",
              "description": "OCI audit events",
              "docsUrl": "https://docs.oracle.com/en-us/iaas/tools/oci-cli/latest/oci_cli_docs/cmdref/audit/event/list.html"
            }
          ]
        }
      ]
    },
    "KSI-MLA-02": {
      "name": "Audit Logging",
      "evidence": [
        {
          "type": "log",
          "description": "Log review evidence",
          "tip": "Log reviews should be documented with findings, actions taken, and sign-off. Automated anomaly detection supplements but doesn't replace human review.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'logName:\"logs/cloudaudit.googleapis.com\"' --limit=100 --format=json",
              "description": "GCP Cloud Audit Logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging sinks list --format='table(name,destination,filter)'",
              "description": "GCP audit log export sinks",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/sinks/list"
            },
            {
              "provider": "splunk",
              "api": "/services/saved/searches",
              "description": "Splunk scheduled searches"
            },
            {
              "provider": "manual",
              "artifact": "Log review records and findings"
            },
            {
              "provider": "azure",
              "command": "az monitor log-analytics query -w <workspace-id> --analytics-query <query>",
              "description": "Log Analytics query results",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "sumologic",
              "api": "/api/v1/dashboards",
              "description": "Sumo Logic dashboards",
              "docsUrl": "https://help.sumologic.com/docs/api/dashboard/"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Audit log configuration",
          "tip": "Verify audit logs capture all admin actions, authentication events, and data access. GCP Data Access logs may need explicit enablement.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud projects get-iam-policy <project> --format=json | jq '.auditConfigs'",
              "description": "GCP Data Access audit log configuration",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/projects/get-iam-policy"
            },
            {
              "provider": "gcp",
              "command": "gcloud organizations get-iam-policy <org> --format=json | jq '.auditConfigs'",
              "description": "GCP org-level audit config",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/organizations/get-iam-policy"
            },
            {
              "provider": "sumologic",
              "api": "/api/v1/dashboards",
              "description": "Sumo Logic dashboards",
              "docsUrl": "https://help.sumologic.com/docs/api/dashboard/"
            },
            {
              "provider": "google-workspace",
              "api": "vault.googleapis.com/v1/matters",
              "description": "Google Vault eDiscovery matters",
              "docsUrl": "https://developers.google.com/vault/reference/rest"
            },
            {
              "provider": "microsoft365",
              "api": "graph.microsoft.com/v1.0/security/alerts_v2",
              "description": "Microsoft 365 security alerts",
              "docsUrl": "https://learn.microsoft.com/en-us/graph/api/security-list-alerts_v2"
            }
          ]
        }
      ]
    },
    "KSI-MLA-03": {
      "name": "Log Integrity",
      "retired": {
        "version": "25.12A",
        "note": "Retired in FedRAMP 25.12A release. Log integrity requirements consolidated into KSI-MLA-01 and KSI-MLA-02."
      },
      "evidence": [
        {
          "type": "configuration",
          "description": "Log tamper protection",
          "tip": "Logs must be immutable - use locked retention policies, write-once storage, or cryptographic validation. No one (including admins) should be able to delete or modify historical logs.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud storage buckets describe gs://<bucket> --format='value(retentionPolicy,iamConfiguration.bucketPolicyOnly)'",
              "description": "GCP Cloud Storage retention policy",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/storage/buckets/describe/gs://<bucket>"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging buckets describe <bucket> --location=<location> --format='value(locked,retentionDays)'",
              "description": "GCP Log bucket lock status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/buckets/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging buckets update <bucket> --location=<location> --locked",
              "description": "GCP Lock log bucket (prevents deletion)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/buckets/update"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail describe-trails --query 'trailList[].{Name:Name,LogFileValidation:LogFileValidationEnabled}'",
              "description": "CloudTrail log validation",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/describe-trails.html"
            },
            {
              "provider": "aws",
              "command": "aws s3api get-bucket-versioning --bucket <bucket>",
              "description": "S3 log bucket versioning",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/s3api/get-bucket-versioning.html"
            },
            {
              "provider": "azure",
              "command": "az storage account show --name <account> --query 'immutableStorageWithVersioning'",
              "description": "Azure immutable storage",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/storage"
            }
          ]
        },
        {
          "type": "log",
          "description": "Log integrity validation evidence",
          "tip": "Regularly validate log integrity (hashes, checksums). Alert on any validation failures or gaps in log continuity.",
          "sources": [
            {
              "provider": "aws",
              "command": "aws cloudtrail validate-logs --trail-arn <arn> --start-time <start>",
              "description": "CloudTrail log validation results",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/validate-logs.html"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:\"storage.objects.delete\" AND resource.labels.bucket_name:<log-bucket>'",
              "description": "GCP log deletion attempt monitoring",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            }
          ]
        }
      ]
    },
    "KSI-MLA-04": {
      "name": "Log Retention",
      "retired": {
        "version": "25.12A",
        "note": "Retired in FedRAMP 25.12A release. Log retention requirements consolidated into KSI-MLA-01 and KSI-MLA-02."
      },
      "evidence": [
        {
          "type": "configuration",
          "description": "Log retention policies",
          "tip": "FedRAMP requirements: Low=90 days, Moderate=1 year online + 3 years archived, High=1 year online + 6 years archived. Verify ALL log sources meet these thresholds.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging buckets list --format='table(name,retentionDays,locked)'",
              "description": "GCP Log bucket retention settings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/buckets/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud storage buckets describe gs://<bucket> --format='value(lifecycle)'",
              "description": "GCP Cloud Storage lifecycle (for archived logs)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/storage/buckets/describe/gs://<bucket>"
            },
            {
              "provider": "aws",
              "command": "aws logs describe-log-groups --query 'logGroups[].{name:logGroupName,retention:retentionInDays}'",
              "description": "CloudWatch Logs retention",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/logs/describe-log-groups.html"
            },
            {
              "provider": "splunk",
              "api": "/services/data/indexes",
              "description": "Splunk index retention settings"
            },
            {
              "provider": "azure",
              "command": "az monitor log-analytics workspace show --workspace-name <ws> --query 'retentionInDays'",
              "description": "Log Analytics retention",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "newrelic",
              "api": "/graphql (data retention query)",
              "description": "New Relic data retention settings"
            },
            {
              "provider": "datadog",
              "api": "/api/v2/logs/config/data-retention",
              "description": "Datadog log retention configuration"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Log source retention mapping",
          "tip": "Document retention period for each log source. Any source below required threshold is a compliance gap. Include archived/cold storage in retention calculations.",
          "sources": [
            {
              "provider": "manual",
              "artifact": "Log retention matrix by source and impact level"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging sinks list --format='table(name,destination)'",
              "description": "GCP log export destinations (for retention verification)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/sinks/list"
            }
          ]
        }
      ]
    },
    "KSI-MLA-05": {
      "name": "Infrastructure as Code",
      "evidence": [
        {
          "type": "scan",
          "description": "IaC security scanning results",
          "tip": "IaC scanning should run on every PR/commit. Block merges on HIGH/CRITICAL findings. Track findings over time to show improvement.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud builds list --filter='substitutions.TRIGGER_NAME:*security*' --format='table(id,status,createTime)'",
              "description": "GCP Cloud Build security scan runs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/builds/list"
            },
            {
              "provider": "aws",
              "command": "aws codepipeline list-action-executions --pipeline-name <pipeline> --filter pipelineExecutionId=<execution>",
              "description": "AWS CodePipeline IaC scan actions",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/codepipeline/list-action-executions.html"
            },
            {
              "provider": "azure",
              "command": "az pipelines runs list --query '[?contains(name,`security`) || contains(name,`scan`)].{id:id,result:result}'",
              "description": "Azure Pipelines security scan runs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/pipelines"
            },
            {
              "provider": "checkov",
              "command": "checkov -d . --output json",
              "description": "Checkov IaC scan"
            },
            {
              "provider": "tfsec",
              "command": "tfsec . --format json",
              "description": "tfsec Terraform scan"
            },
            {
              "provider": "kics",
              "command": "kics scan -p . -o json",
              "description": "KICS IaC scan"
            },
            {
              "provider": "snyk",
              "command": "snyk iac test --json",
              "description": "Snyk IaC scanning"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "IaC pipeline integration",
          "tip": "Verify IaC scanning is mandatory in CI/CD. Check that bypass requires approval. All infrastructure changes should flow through IaC (no manual changes).",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud builds triggers list --format='table(name,github.owner,github.name)'",
              "description": "GCP Cloud Build triggers",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/builds/triggers/list"
            },
            {
              "provider": "azure",
              "command": "az repos policy list --query '[?type.displayName==`Required reviewers`].{repo:repositoryId,enabled:isEnabled}'",
              "description": "Azure DevOps required reviewer policies",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/repos"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/branches/{branch}/protection",
              "description": "GitHub branch protection with required checks"
            },
            {
              "provider": "gitlab",
              "api": "/projects/{id}/merge_request_approval_rules",
              "description": "GitLab MR approval rules"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "IaC scan findings trends",
          "tip": "Show declining trend in IaC findings over time. Track time-to-remediate for identified issues. Report on scan coverage (% of repos scanned).",
          "sources": [
            {
              "provider": "azure",
              "command": "az security sub-assessment list --query '[?status.code==`Unhealthy`].{name:displayName,severity:status.severity}'",
              "description": "Azure Defender for DevOps findings",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "bridgecrew",
              "api": "/api/v1/suppressions/justifications",
              "description": "Bridgecrew suppression justifications"
            },
            {
              "provider": "snyk",
              "api": "/org/{orgId}/project/{projectId}/history",
              "description": "Snyk project issue history"
            }
          ]
        }
      ]
    },
    "KSI-MLA-06": {
      "name": "Alerting",
      "retired": {
        "version": "25.12A",
        "note": "Retired in FedRAMP 25.12A release. Alerting requirements consolidated into other MLA KSIs."
      },
      "evidence": [
        {
          "type": "configuration",
          "description": "Security alerting configuration",
          "tip": "Critical security alerts should page on-call 24/7. Verify escalation paths exist. Test alerting regularly (fire drills). Alert fatigue indicates tuning needed.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring alert-policies list --format='table(displayName,enabled,notificationChannels)'",
              "description": "GCP Cloud Monitoring alert policies",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/alert-policies/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud monitoring channels list --format='table(displayName,type,enabled)'",
              "description": "GCP notification channels",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/channels/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/notificationConfigs",
              "description": "GCP SCC notification configs"
            },
            {
              "provider": "aws",
              "command": "aws cloudwatch describe-alarms --alarm-types MetricAlarm",
              "description": "CloudWatch alarms",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudwatch/describe-alarms.html"
            },
            {
              "provider": "azure",
              "command": "az monitor alert-rules list --query '[].{name:name,enabled:isEnabled,severity:severity}'",
              "description": "Azure Monitor alert rules",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az monitor action-group list --query '[].{name:name,email:emailReceivers,sms:smsReceivers}'",
              "description": "Azure Monitor action groups",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "pagerduty",
              "api": "/services",
              "description": "PagerDuty service integrations"
            },
            {
              "provider": "splunk",
              "api": "/services/alerts/fired_alerts",
              "description": "Splunk alert history"
            }
          ]
        },
        {
          "type": "log",
          "description": "Alert response evidence",
          "tip": "Document response to every critical alert. Track Mean Time to Acknowledge (MTTA) and Mean Time to Resolve (MTTR). Alerts without response are compliance gaps.",
          "sources": [
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?category==`Alert`].{time:eventTimestamp,name:operationName.value,status:status.value}'",
              "description": "Azure alert activity log",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "pagerduty",
              "api": "/incidents",
              "description": "PagerDuty incident history with response times"
            },
            {
              "provider": "opsgenie",
              "api": "/v2/alerts",
              "description": "OpsGenie alert history"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging read 'resource.type=\"cloud_function\" AND severity>=ERROR'",
              "description": "GCP alert function executions",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Alerting health metrics",
          "tip": "Track alert volume, false positive rate, and response times. High volume or low response rate indicates problems. Report on alert coverage (% of critical systems monitored).",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring alert-policies list --filter='enabled=true' --format='value(displayName)' | wc -l",
              "description": "GCP active alert count",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/alert-policies/list"
            },
            {
              "provider": "azure",
              "command": "az monitor metrics alert list --query 'length([?enabled==`true`])'",
              "description": "Azure active alert count",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "datadog",
              "api": "/api/v1/monitor",
              "description": "Datadog monitor inventory"
            }
          ]
        }
      ]
    },
    "KSI-MLA-07": {
      "name": "Event Types",
      "evidence": [
        {
          "type": "documentation",
          "description": "Monitored event types documentation",
          "tip": "Document all event types being collected: authentication, authorization, data access, configuration changes, network events. Ensure coverage of NIST AU-2 requirements.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging sinks list --format='table(name,destination,filter)'",
              "description": "GCP log sinks with event filters",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/sinks/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging logs list --format='table(name)'",
              "description": "GCP available log types",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/logs/list"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail get-event-selectors --trail-name <trail>",
              "description": "CloudTrail event selectors",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/get-event-selectors.html"
            },
            {
              "provider": "azure",
              "command": "az monitor diagnostic-settings list --resource <resource> --query '[].logs[].category'",
              "description": "Azure diagnostic log categories",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az monitor log-analytics workspace table list --workspace-name <workspace> --resource-group <rg> --query '[].name'",
              "description": "Azure Log Analytics tables (event types)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "manual",
              "artifact": "Log source inventory with event types"
            },
            {
              "provider": "splunk",
              "api": "/services/data/inputs",
              "description": "Splunk input configurations"
            }
          ]
        }
      ]
    },
    "KSI-MLA-08": {
      "name": "Log Data Access",
      "evidence": [
        {
          "type": "configuration",
          "description": "Log access controls",
          "tip": "Restrict log access to authorized personnel only. Prevent log tampering/deletion. Audit log access. Separate duties between log administrators and security analysts.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging buckets describe <bucket> --location=<location> --format='value(retentionDays,locked)'",
              "description": "GCP log bucket access and retention",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/buckets/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud projects get-iam-policy <project> --flatten='bindings[].members' --filter='bindings.role:roles/logging*'",
              "description": "GCP logging IAM bindings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/projects/get-iam-policy"
            },
            {
              "provider": "aws",
              "command": "aws logs describe-resource-policies",
              "description": "CloudWatch Logs resource policies",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/logs/describe-resource-policies.html"
            },
            {
              "provider": "azure",
              "command": "az monitor log-analytics workspace show --workspace-name <workspace> --resource-group <rg> --query 'retentionInDays'",
              "description": "Azure Log Analytics retention",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az role assignment list --scope <log-analytics-workspace-id> --query '[].{principal:principalName,role:roleDefinitionName}'",
              "description": "Azure Log Analytics access controls",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/role"
            },
            {
              "provider": "splunk",
              "api": "/services/authorization/roles",
              "description": "Splunk role-based access"
            },
            {
              "provider": "elastic",
              "api": "/_security/role",
              "description": "Elasticsearch security roles"
            }
          ]
        }
      ]
    },
    "KSI-PIY-01": {
      "name": "Automated Inventory",
      "evidence": [
        {
          "type": "inventory",
          "description": "Real-time asset inventory",
          "tip": "Inventory must be automated and real-time, not manual spreadsheets. Must capture all asset types: compute, storage, network, serverless, containers. Tag all assets with owner, classification, and environment.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-resources --scope=organizations/<org> --format='table(assetType,name,location,createTime)'",
              "description": "GCP Cloud Asset Inventory - all resources",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-resources"
            },
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-resources --scope=organizations/<org> --asset-types='compute.googleapis.com/Instance' --format=json",
              "description": "GCP compute instances inventory",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-resources"
            },
            {
              "provider": "gcp",
              "api": "cloudasset.googleapis.com/v1/organizations/{org}/assets?contentType=RESOURCE",
              "description": "GCP Cloud Asset API - full inventory export"
            },
            {
              "provider": "aws",
              "command": "aws configservice list-discovered-resources --resource-type AWS::EC2::Instance",
              "description": "AWS Config discovered resources",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/configservice/list-discovered-resources.html"
            },
            {
              "provider": "azure",
              "command": "az graph query -q 'Resources | summarize count() by type'",
              "description": "Azure Resource Graph inventory",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/graph"
            },
            {
              "provider": "servicenow",
              "api": "/api/now/table/cmdb_ci",
              "description": "ServiceNow CMDB"
            },
            {
              "provider": "salesforce",
              "api": "/services/data/v59.0/limits",
              "description": "Salesforce org limits and usage"
            },
            {
              "provider": "salesforce",
              "api": "/services/data/v59.0/query?q=SELECT+Id,Name+FROM+User",
              "description": "Salesforce user inventory"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Inventory automation configuration",
          "tip": "Configure Cloud Asset Inventory exports to run daily. Set up feeds for real-time change notifications. Ensure all projects are included in scope.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset feeds list --organization=<org>",
              "description": "GCP Cloud Asset feeds (real-time inventory updates)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/feeds/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud asset export --organization=<org> --output-path=gs://<bucket>/inventory --content-type=resource",
              "description": "GCP scheduled inventory export configuration",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/export"
            },
            {
              "provider": "aws",
              "command": "aws config describe-configuration-recorders",
              "description": "AWS Config recorder status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/config/describe-configuration-recorders.html"
            }
          ]
        }
      ]
    },
    "KSI-PIY-02": {
      "name": "Security Objectives and Requirements",
      "evidence": [
        {
          "type": "documentation",
          "description": "Security requirements documentation",
          "tip": "Security objectives must trace from NIST 800-53 controls to implementation. Document which controls are inherited vs CSP-implemented vs customer-configured.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc posture-deployments list --organization=<org>",
              "description": "GCP SCC security posture deployments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/posture-deployments/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/securityHealthAnalyticsSettings",
              "description": "GCP Security Health Analytics requirements"
            },
            {
              "provider": "manual",
              "artifact": "System Security Plan security objectives"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=security-requirement",
              "description": "Security requirements in Jira"
            }
          ]
        },
        {
          "type": "report",
          "description": "Security requirements compliance",
          "tip": "Track compliance percentage for each control family. Prioritize gaps in high-impact controls. Review quarterly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category=\"COMPLIANCE\"' --format='table(finding.category,finding.description,finding.state)'",
              "description": "GCP SCC compliance findings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=sourceProperties.compliance_standard:*",
              "description": "GCP SCC compliance-mapped findings"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"ComplianceStatus\":[{\"Value\":\"FAILED\",\"Comparison\":\"EQUALS\"}]}'",
              "description": "AWS Security Hub compliance failures",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security regulatory-compliance-assessments list --standard-name <standard>",
              "description": "Azure regulatory compliance assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Security/secureScores?api-version=2020-01-01",
              "description": "Azure Secure Score (compliance metric)"
            }
          ]
        }
      ]
    },
    "KSI-PIY-03": {
      "name": "Vulnerability Disclosure Program",
      "evidence": [
        {
          "type": "documentation",
          "description": "VDP policy and security contact",
          "tip": "Publish security.txt at /.well-known/security.txt per RFC 9116. Include contact email, PGP key, policy URL, and acknowledgments page. Respond to valid reports within 5 business days.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute url-maps describe <url-map> --format='value(defaultService)'",
              "description": "GCP URL map for security.txt hosting",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/url-maps/describe"
            },
            {
              "provider": "aws",
              "command": "aws s3 cp s3://<bucket>/.well-known/security.txt -",
              "description": "AWS S3 security.txt verification",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/s3/cp.html"
            },
            {
              "provider": "azure",
              "command": "az storage blob download --account-name <account> --container-name '$web' --name '.well-known/security.txt' --file -",
              "description": "Azure Blob security.txt verification",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/storage"
            },
            {
              "provider": "manual",
              "artifact": "security.txt file and VDP policy"
            },
            {
              "provider": "manual",
              "artifact": "Vulnerability disclosure policy document"
            }
          ]
        },
        {
          "type": "report",
          "description": "VDP submissions and status",
          "tip": "Track all vulnerability reports: time to acknowledge, time to triage, time to remediate. Target SLAs: acknowledge in 24 hours, triage in 5 days, remediate critical in 15 days.",
          "sources": [
            {
              "provider": "hackerone",
              "api": "/v1/reports",
              "description": "HackerOne reports"
            },
            {
              "provider": "bugcrowd",
              "api": "/submissions",
              "description": "Bugcrowd submissions"
            },
            {
              "provider": "manual",
              "artifact": "VDP metrics report (acknowledgment, triage, remediation times)"
            }
          ]
        }
      ]
    },
    "KSI-PIY-04": {
      "name": "CISA Secure By Design",
      "evidence": [
        {
          "type": "configuration",
          "description": "Secure-by-design pipeline controls",
          "tip": "Implement CISA Secure by Design principles: memory-safe languages, eliminate default passwords, MFA by default, audit logging. Shift security left in SDLC.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud container binauthz policy export",
              "description": "GCP Binary Authorization policy (secure deployments)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/binauthz/policy/export"
            },
            {
              "provider": "gcp",
              "command": "gcloud artifacts repositories list --format='table(name,format,mode)'",
              "description": "GCP Artifact Registry repos (secure artifact storage)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/repositories/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud builds triggers list --format='table(name,filename,substitutions)'",
              "description": "GCP Cloud Build triggers with security steps",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/builds/triggers/list"
            },
            {
              "provider": "aws",
              "command": "aws codepipeline list-pipelines",
              "description": "AWS CodePipeline CI/CD pipelines",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/codepipeline/list-pipelines.html"
            },
            {
              "provider": "aws",
              "command": "aws codebuild batch-get-projects --names <project>",
              "description": "AWS CodeBuild security configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/codebuild/batch-get-projects.html"
            },
            {
              "provider": "azure",
              "command": "az pipelines list --query '[].{name:name,path:path}'",
              "description": "Azure DevOps pipelines",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/pipelines"
            },
            {
              "provider": "azure",
              "command": "az acr task list --registry <registry> --query '[].{name:name,status:status}'",
              "description": "Azure ACR build tasks with security steps",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/code-scanning/alerts",
              "description": "GitHub code scanning alerts"
            },
            {
              "provider": "sonarqube",
              "api": "/api/issues/search",
              "description": "SonarQube security hotspots"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Secure SDLC practices",
          "tip": "Document security requirements in design phase, threat modeling, security code review, automated security testing (SAST/DAST), and security sign-off for releases.",
          "sources": [
            {
              "provider": "manual",
              "artifact": "SDLC documentation with security integration"
            },
            {
              "provider": "manual",
              "artifact": "Threat modeling templates and completed models"
            },
            {
              "provider": "manual",
              "artifact": "Security release checklist"
            }
          ]
        }
      ]
    },
    "KSI-PIY-05": {
      "name": "Evaluate Implementations",
      "evidence": [
        {
          "type": "report",
          "description": "Security assessment results",
          "tip": "Conduct penetration testing annually at minimum. Use independent assessors. Test both external and internal attack surfaces. Include social engineering and physical security if applicable.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='category=\"VULNERABILITY\" OR category=\"MISCONFIGURATION\"' --format='table(finding.severity,finding.category,finding.name)'",
              "description": "GCP SCC vulnerability and misconfiguration findings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "websecurityscanner.googleapis.com/v1/projects/{project}/scanConfigs/{scanConfig}/scanRuns",
              "description": "GCP Web Security Scanner results"
            },
            {
              "provider": "manual",
              "artifact": "Penetration test reports"
            },
            {
              "provider": "manual",
              "artifact": "Security assessment methodology documentation"
            }
          ]
        },
        {
          "type": "scan",
          "description": "Automated security evaluation",
          "tip": "Run automated assessments continuously. Include infrastructure-as-code scanning, container image scanning, and runtime security monitoring.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc sources list --organization=<org>",
              "description": "GCP SCC assessment sources configured",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/sources/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud artifacts docker images list <repo> --show-occurrences --occurrence-filter='kind=\"VULNERABILITY\"'",
              "description": "GCP container vulnerability assessments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/docker/images/list"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 list-coverage",
              "description": "AWS Inspector coverage",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/list-coverage.html"
            },
            {
              "provider": "azure",
              "command": "az security assessment list --query '[].{name:displayName,status:status.code}'",
              "description": "Azure Defender security assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "command": "az acr task logs list --registry <registry> --query '[?contains(run.task, `scan`)]'",
              "description": "Azure ACR security scan logs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            }
          ]
        }
      ]
    },
    "KSI-PIY-06": {
      "name": "Security Investment Effectiveness",
      "evidence": [
        {
          "type": "metrics",
          "description": "Security program KPIs",
          "tip": "Track ROI metrics: vulnerability density trends, MTTD/MTTR improvements, security incident costs, audit finding reduction. Compare to industry benchmarks.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --compare-duration=2592000s --filter='state=\"ACTIVE\"' --format='table(finding.category,stateChange)'",
              "description": "GCP SCC 30-day trend (new vs resolved findings)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/findings:group?groupBy=category",
              "description": "GCP SCC findings grouped by category (trends)"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-insight-results --insight-arn <arn>",
              "description": "AWS Security Hub insight trends",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-insight-results.html"
            },
            {
              "provider": "azure",
              "command": "az security secure-score-controls list --query '[].{name:displayName,current:current,max:max}'",
              "description": "Azure Secure Score controls (KPI tracking)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Security/secureScoreControlDefinitions?api-version=2020-01-01",
              "description": "Azure Secure Score trends"
            },
            {
              "provider": "manual",
              "artifact": "Security metrics dashboard"
            },
            {
              "provider": "manual",
              "artifact": "Security program effectiveness reports"
            }
          ]
        },
        {
          "type": "report",
          "description": "Security tool utilization",
          "tip": "Demonstrate that security tools are actively used. Show alert volumes, investigation rates, and automation effectiveness. Unused tools indicate wasted investment.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud billing budgets list --billing-account=<account> --filter='displayName:security'",
              "description": "GCP security-related budget tracking",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/billing/budgets/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud logging metrics list --format='table(name,filter)'",
              "description": "GCP security logging metrics defined",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/metrics/list"
            },
            {
              "provider": "aws",
              "command": "aws ce get-cost-and-usage --time-period Start=2025-01-01,End=2025-12-31 --granularity MONTHLY --filter '{\"Tags\":{\"Key\":\"security\"}}'",
              "description": "AWS security cost tracking",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ce/get-cost-and-usage.html"
            },
            {
              "provider": "azure",
              "command": "az consumption usage list --query '[?contains(instanceName, `security`)]'",
              "description": "Azure security resource consumption",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/consumption"
            },
            {
              "provider": "manual",
              "artifact": "Security tool utilization reports"
            }
          ]
        }
      ]
    },
    "KSI-PIY-07": {
      "name": "Supply Chain Risk Management",
      "evidence": [
        {
          "type": "inventory",
          "description": "Software Bill of Materials (SBOM)",
          "tip": "Generate SBOMs for all software in the boundary. Use SPDX or CycloneDX format. Include transitive dependencies. Regenerate on every build. Store and version SBOMs.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud artifacts sbom export --uri=<artifact-uri>",
              "description": "GCP Artifact Registry SBOM export",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/sbom/export"
            },
            {
              "provider": "gcp",
              "api": "containeranalysis.googleapis.com/v1/projects/{project}/occurrences?filter=kind=\"SBOM\"",
              "description": "GCP Container Analysis SBOM occurrences"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 list-findings --filter-criteria '{\"findingType\":[{\"comparison\":\"EQUALS\",\"value\":\"SBOM\"}]}'",
              "description": "AWS Inspector SBOM inventory",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az acr manifest list-metadata --registry <registry> --name <repo>",
              "description": "Azure ACR container manifest inventory",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Security/softwareInventories?api-version=2021-05-01-preview",
              "description": "Azure Defender software inventory"
            },
            {
              "provider": "syft",
              "command": "syft <image> -o spdx-json",
              "description": "SBOM generation with Syft"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/dependency-graph/sbom",
              "description": "GitHub SBOM export"
            }
          ]
        },
        {
          "type": "scan",
          "description": "Supply chain vulnerability scanning",
          "tip": "Scan all dependencies for known vulnerabilities (CVEs). Block deployments with critical/high vulns. Require manual approval for medium. Update dependencies regularly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud artifacts docker images list <repo> --show-occurrences --occurrence-filter='kind=\"VULNERABILITY\"' --format=json",
              "description": "GCP Artifact Registry vulnerability scan results",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/docker/images/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud container binauthz attestations list --artifact-url=<image>",
              "description": "GCP Binary Authorization attestations (supply chain verification)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/binauthz/attestations/list"
            },
            {
              "provider": "aws",
              "command": "aws ecr describe-image-scan-findings --repository-name <repo> --image-id imageTag=<tag>",
              "description": "AWS ECR vulnerability scan results",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ecr/describe-image-scan-findings.html"
            },
            {
              "provider": "azure",
              "command": "az acr repository show-manifests --name <registry> --repository <repo> --detail",
              "description": "Azure ACR image manifest details",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "azure",
              "command": "az security sub-assessment list --assessed-resource-id <registry-id>",
              "description": "Azure container vulnerability sub-assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "grype",
              "command": "grype sbom:<sbom-file> -o json",
              "description": "SBOM vulnerability scan with Grype"
            },
            {
              "provider": "snyk",
              "api": "/v1/org/{orgId}/dependencies",
              "description": "Snyk dependency vulnerabilities"
            }
          ]
        }
      ]
    },
    "KSI-PIY-08": {
      "name": "Executive Support",
      "evidence": [
        {
          "type": "documentation",
          "description": "Executive security engagement",
          "tip": "Demonstrate executive commitment: regular security briefings, budget allocation, security in strategic planning. Executive sponsor should sign off on risk acceptance decisions.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud organizations get-iam-policy <org> --flatten='bindings[].members' --filter='bindings.role:roles/securitycenter*' --format='table(bindings.role,bindings.members)'",
              "description": "GCP organization security role assignments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/organizations/get-iam-policy"
            },
            {
              "provider": "gcp",
              "command": "gcloud access-context-manager policies list --organization=<org>",
              "description": "GCP organization access policies (executive-level controls)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/access-context-manager/policies/list"
            },
            {
              "provider": "aws",
              "command": "aws organizations describe-organization",
              "description": "AWS Organization structure (governance)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/organizations/describe-organization.html"
            },
            {
              "provider": "aws",
              "command": "aws iam list-policies --scope Local --only-attached --query 'Policies[?contains(PolicyName, `Security`)]'",
              "description": "AWS security policies (executive oversight)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-policies.html"
            },
            {
              "provider": "azure",
              "command": "az role assignment list --scope /providers/Microsoft.Management/managementGroups/<mg> --query '[?contains(roleDefinitionName, `Security`)]'",
              "description": "Azure management group security roles",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/role"
            },
            {
              "provider": "azure",
              "command": "az policy assignment list --scope /providers/Microsoft.Management/managementGroups/<mg>",
              "description": "Azure top-level policy assignments (governance)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "manual",
              "artifact": "Security steering committee meeting minutes"
            },
            {
              "provider": "manual",
              "artifact": "Executive security briefing records"
            }
          ]
        },
        {
          "type": "report",
          "description": "Executive security metrics",
          "tip": "Provide executive-level dashboards showing security posture, risk trends, and compliance status. Monthly or quarterly reporting cadence recommended.",
          "sources": [
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/securityHealthAnalyticsSettings",
              "description": "GCP organization security posture for executive reporting"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"SeverityLabel\":[{\"Value\":\"CRITICAL\",\"Comparison\":\"EQUALS\"}]}' --max-items 10",
              "description": "AWS Security Hub critical findings summary",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security secure-score list --query '[].{name:displayName,score:currentScore,max:maxScore}'",
              "description": "Azure Secure Score executive summary",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Security/secureScores?api-version=2020-01-01",
              "description": "Azure security posture API"
            },
            {
              "provider": "manual",
              "artifact": "Board-level security reports"
            },
            {
              "provider": "manual",
              "artifact": "Risk register with executive sign-off"
            }
          ]
        }
      ]
    },
    "KSI-RPL-01": {
      "name": "Recovery Objectives",
      "evidence": [
        {
          "type": "documentation",
          "description": "RTO/RPO definitions",
          "tip": "Define RTO (Recovery Time Objective) and RPO (Recovery Point Objective) for each critical system. FedRAMP typically expects RTO < 24 hours for Moderate. Document justification for each objective.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute disks describe <disk> --format='table(name,replicaZones)'",
              "description": "GCP disk replication zones (affects RPO)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/disks/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud sql instances describe <instance> --format='table(settings.backupConfiguration)'",
              "description": "GCP Cloud SQL backup configuration (RPO indicator)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/sql/instances/describe"
            },
            {
              "provider": "aws",
              "command": "aws rds describe-db-instances --query 'DBInstances[].{Name:DBInstanceIdentifier,BackupRetention:BackupRetentionPeriod}'",
              "description": "AWS RDS backup retention (RPO indicator)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html"
            },
            {
              "provider": "azure",
              "command": "az sql db show --name <db> --server <server> --resource-group <rg> --query '{backup:earliestRestoreDate,redundancy:currentBackupStorageRedundancy}'",
              "description": "Azure SQL backup configuration (RPO indicator)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/sql"
            },
            {
              "provider": "azure",
              "command": "az disk show --name <disk> --resource-group <rg> --query '{name:name,zones:zones,sku:sku.name}'",
              "description": "Azure disk replication zones",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/disk"
            },
            {
              "provider": "manual",
              "artifact": "Business Impact Analysis with RTO/RPO"
            },
            {
              "provider": "manual",
              "artifact": "Disaster Recovery Plan"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Recovery configuration alignment",
          "tip": "Technical configuration must support defined objectives. If RPO is 1 hour, backups must run at least hourly. If RTO is 4 hours, failover automation must be in place.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instances describe <instance> --format='table(scheduling.automaticRestart,scheduling.onHostMaintenance)'",
              "description": "GCP VM automatic restart settings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute instance-groups managed describe <mig> --format='table(autoHealingPolicies)'",
              "description": "GCP managed instance group auto-healing",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instance-groups/managed/describe"
            },
            {
              "provider": "aws",
              "command": "aws rds describe-db-instances --query 'DBInstances[].{Name:DBInstanceIdentifier,MultiAZ:MultiAZ,BackupRetention:BackupRetentionPeriod}'",
              "description": "AWS RDS multi-AZ and backup settings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html"
            },
            {
              "provider": "azure",
              "command": "az vm availability-set list --query '[].{name:name,faultDomains:platformFaultDomainCount}'",
              "description": "Azure availability set configuration",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "azure",
              "command": "az sql db failover-group list --server <server> --resource-group <rg>",
              "description": "Azure SQL failover groups for automatic failover",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/sql"
            }
          ]
        }
      ]
    },
    "KSI-RPL-02": {
      "name": "Recovery Plan",
      "evidence": [
        {
          "type": "documentation",
          "description": "Disaster recovery procedures",
          "tip": "DR plan must include: trigger criteria, communication tree, recovery steps by system priority, rollback procedures, and success criteria. Update annually or after major changes.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud deployment-manager deployments list --format='table(name,operation.status)'",
              "description": "GCP Deployment Manager deployments (infrastructure-as-code for recovery)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/deployment-manager/deployments/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute snapshots list --format='table(name,sourceDisk,creationTimestamp,status)'",
              "description": "GCP disk snapshots available for recovery",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/snapshots/list"
            },
            {
              "provider": "azure",
              "command": "az snapshot list --query '[].{name:name,source:creationData.sourceResourceId,timeCreated:timeCreated}'",
              "description": "Azure disk snapshots for recovery",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/snapshot"
            },
            {
              "provider": "azure",
              "command": "az deployment group list --resource-group <rg> --query '[].{name:name,state:properties.provisioningState}'",
              "description": "Azure ARM deployments (infrastructure-as-code)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/deployment"
            },
            {
              "provider": "manual",
              "artifact": "Disaster Recovery Plan document"
            },
            {
              "provider": "manual",
              "artifact": "Business Continuity Plan"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Recovery infrastructure",
          "tip": "Pre-provision recovery infrastructure or use infrastructure-as-code for rapid deployment. Document all dependencies and recovery order.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute regions list --format='table(name,status)'",
              "description": "GCP available regions for DR",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/regions/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud container clusters list --format='table(name,location,status)'",
              "description": "GCP GKE clusters (multi-region availability)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/clusters/list"
            },
            {
              "provider": "terraform",
              "command": "terraform plan -var='environment=dr'",
              "description": "Terraform DR environment plan"
            },
            {
              "provider": "aws",
              "command": "aws cloudformation describe-stacks --query 'Stacks[?contains(StackName,`dr`)].{Name:StackName,Status:StackStatus}'",
              "description": "AWS CloudFormation DR stacks",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudformation/describe-stacks.html"
            },
            {
              "provider": "azure",
              "command": "az account list-locations --query '[].{name:displayName,paired:metadata.pairedRegion[0].name}'",
              "description": "Azure regions with paired DR regions",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/account"
            },
            {
              "provider": "azure",
              "command": "az aks list --query '[].{name:name,location:location}'",
              "description": "Azure AKS clusters (multi-region availability)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/aks"
            }
          ]
        }
      ]
    },
    "KSI-RPL-03": {
      "name": "System Backups",
      "evidence": [
        {
          "type": "report",
          "description": "Backup status and compliance",
          "tip": "Backups must cover all data and configurations: databases, file storage, secrets, and infrastructure state. Verify backup completion daily. Test restore monthly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud sql backups list --instance=<instance> --format='table(id,status,startTime,endTime)'",
              "description": "GCP Cloud SQL backup status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/sql/backups/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute snapshots list --filter='creationTimestamp>2025-01-01' --format='table(name,sourceDisk,status,storageBytes)'",
              "description": "GCP compute disk snapshots",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/snapshots/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud filestore backups list --format='table(name,sourceFileShare,state,createTime)'",
              "description": "GCP Filestore backups",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/filestore/backups/list"
            },
            {
              "provider": "aws",
              "command": "aws backup list-backup-jobs --by-state COMPLETED",
              "description": "AWS Backup job status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/backup/list-backup-jobs.html"
            },
            {
              "provider": "azure",
              "command": "az backup job list --resource-group <rg> --vault-name <vault>",
              "description": "Azure Backup jobs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/backup"
            },
            {
              "provider": "veeam",
              "api": "/api/v1/backupServers/{id}/sessions",
              "description": "Veeam backup sessions"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Backup policies and retention",
          "tip": "Configure automated backup schedules aligned with RPO. Retain backups per data retention policy (typically 30 days operational, 1 year archive). Encrypt backups at rest.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud sql instances describe <instance> --format='json(settings.backupConfiguration)'",
              "description": "GCP Cloud SQL backup policy",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/sql/instances/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute resource-policies list --filter='snapshotSchedulePolicy:*' --format='table(name,snapshotSchedulePolicy)'",
              "description": "GCP snapshot schedule policies",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/resource-policies/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud storage buckets describe gs://<backup-bucket> --format='table(lifecycle,versioning)'",
              "description": "GCP backup bucket lifecycle/versioning",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/storage/buckets/describe/gs://<backup-bucket>"
            },
            {
              "provider": "aws",
              "command": "aws backup list-backup-plans",
              "description": "AWS Backup plans",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/backup/list-backup-plans.html"
            },
            {
              "provider": "azure",
              "command": "az backup policy list --resource-group <rg> --vault-name <vault> --query '[].{name:name,retention:properties.retentionPolicy}'",
              "description": "Azure Backup policies and retention",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/backup"
            },
            {
              "provider": "azure",
              "command": "az sql db show --name <db> --server <server> --resource-group <rg> --query 'longTermRetentionBackupResourceId'",
              "description": "Azure SQL long-term retention",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/sql"
            }
          ]
        }
      ]
    },
    "KSI-RPL-04": {
      "name": "Recovery Testing",
      "evidence": [
        {
          "type": "report",
          "description": "DR test execution and results",
          "tip": "Test DR annually at minimum, quarterly recommended. Document test scope, procedures, results, and lessons learned. Verify RTO/RPO are achievable in practice.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud sql backups describe <backup-id> --instance=<instance>",
              "description": "GCP Cloud SQL backup details for restore testing",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/sql/backups/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute instances create <dr-test-vm> --source-snapshot=<snapshot>",
              "description": "GCP snapshot restore test",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/create"
            },
            {
              "provider": "aws",
              "command": "aws drs describe-recovery-instances",
              "description": "AWS Elastic Disaster Recovery status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/drs/describe-recovery-instances.html"
            },
            {
              "provider": "azure",
              "command": "az site-recovery protected-item list --resource-group <rg> --vault-name <vault>",
              "description": "Azure Site Recovery protected items",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/site-recovery"
            },
            {
              "provider": "azure",
              "command": "az backup restore restore-azurefiles --vault-name <vault> --resource-group <rg> --target-storage-account <account>",
              "description": "Azure Backup restore test",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/backup"
            },
            {
              "provider": "manual",
              "artifact": "DR test execution records and results"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Recovery performance metrics",
          "tip": "Track actual vs target RTO/RPO during tests. Measure time to detect failure, time to failover, and time to full recovery. Document any gaps and remediation plans.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud monitoring metrics list --filter='metric.type:uptime'",
              "description": "GCP uptime metrics for availability tracking",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/monitoring/metrics/list"
            },
            {
              "provider": "gcp",
              "api": "monitoring.googleapis.com/v3/projects/{project}/timeSeries?filter=metric.type=\"custom.googleapis.com/dr/recovery_time\"",
              "description": "GCP custom DR metrics"
            },
            {
              "provider": "azure",
              "command": "az monitor metrics list --resource <id> --metric 'Availability' --interval PT1H",
              "description": "Azure availability metrics",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az site-recovery job list --resource-group <rg> --vault-name <vault> --query '[].{name:name,status:status,startTime:startTime}'",
              "description": "Azure Site Recovery job history (failover times)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/site-recovery"
            },
            {
              "provider": "manual",
              "artifact": "DR test metrics report (actual RTO/RPO vs targets)"
            },
            {
              "provider": "manual",
              "artifact": "Chaos engineering experiment results"
            }
          ]
        }
      ]
    },
    "KSI-SVC-01": {
      "name": "Continuous Improvement",
      "evidence": [
        {
          "type": "documentation",
          "description": "Security improvement tracking",
          "tip": "Demonstrate ongoing security maturity improvements. Track POA&M closures, vulnerability reduction trends, and security control enhancements over time.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud scc findings list --organization=<org> --filter='state=\"INACTIVE\"' --format='table(finding.category,finding.eventTime)'",
              "description": "GCP SCC resolved findings (improvements)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/scc/findings/list"
            },
            {
              "provider": "aws",
              "command": "aws securityhub get-findings --filters '{\"RecordState\":[{\"Value\":\"ARCHIVED\",\"Comparison\":\"EQUALS\"}]}'",
              "description": "AWS Security Hub archived/resolved findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/securityhub/get-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security assessment list --query '[?status.code==`Healthy`].{name:displayName,time:metadata.assessmentType}'",
              "description": "Azure healthy security assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "jira",
              "api": "/rest/api/3/search?jql=labels=security-improvement",
              "description": "Security improvement tickets"
            },
            {
              "provider": "manual",
              "artifact": "Security roadmap and improvement plans"
            },
            {
              "provider": "manual",
              "artifact": "POA&M closure reports"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Security posture improvement metrics",
          "tip": "Show measurable improvement: fewer vulnerabilities, faster remediation, better coverage. Compare current state to baseline from 6-12 months ago.",
          "sources": [
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/securityHealthAnalyticsSettings",
              "description": "GCP Security Health Analytics posture"
            },
            {
              "provider": "azure",
              "command": "az security secure-score list --query '[].{name:displayName,current:current,max:max}'",
              "description": "Azure Secure Score trends",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "qualys",
              "api": "/api/2.0/fo/report/scorecards/",
              "description": "Qualys security scorecard trends"
            }
          ]
        }
      ]
    },
    "KSI-SVC-02": {
      "name": "Network Encryption",
      "evidence": [
        {
          "type": "scan",
          "description": "TLS/encryption configuration",
          "tip": "Minimum TLS 1.2 required, TLS 1.3 preferred. Verify no weak ciphers (RC4, DES, export ciphers). Certificate chains must be valid and not expiring soon.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute ssl-policies list --format='table(name,minTlsVersion,profile)'",
              "description": "GCP SSL policies with TLS version",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/ssl-policies/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute target-https-proxies list --format='table(name,sslPolicy)'",
              "description": "GCP HTTPS proxies SSL policy assignment",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/target-https-proxies/list"
            },
            {
              "provider": "aws",
              "command": "aws elbv2 describe-listeners --load-balancer-arn <arn> --query 'Listeners[].{Port:Port,Protocol:Protocol}'",
              "description": "Load balancer TLS configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/elbv2/describe-listeners.html"
            },
            {
              "provider": "azure",
              "command": "az network application-gateway ssl-policy show --gateway-name <gw> --resource-group <rg>",
              "description": "Azure App Gateway SSL policy",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "azure",
              "command": "az keyvault certificate list --vault-name <vault> --query '[].{name:name,expires:attributes.expires}'",
              "description": "Azure Key Vault certificates",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "ssllabs",
              "api": "/api/v3/analyze?host=<domain>",
              "description": "SSL Labs scan results"
            },
            {
              "provider": "testssl",
              "command": "testssl.sh --json <domain>",
              "description": "testssl.sh scan"
            },
            {
              "provider": "akamai",
              "api": "/cps/v2/enrollments",
              "description": "Akamai CPS certificate enrollments"
            },
            {
              "provider": "akamai",
              "api": "/hapi/v1/dns-zones/{zone}/edge-hostnames",
              "description": "Akamai edge hostnames with TLS config"
            }
          ]
        },
        {
          "type": "configuration",
          "description": "Internal service encryption",
          "tip": "Internal service-to-service communication should also use TLS/mTLS. Verify mesh encryption if using service mesh. Check for any plaintext internal traffic.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute backend-services describe <service> --format='value(securitySettings)'",
              "description": "GCP backend service security settings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/backend-services/describe"
            },
            {
              "provider": "azure",
              "command": "az webapp config show --name <app> --resource-group <rg> --query 'minTlsVersion'",
              "description": "Azure App Service minimum TLS version",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/webapp"
            },
            {
              "provider": "istio",
              "command": "istioctl analyze --all-namespaces",
              "description": "Istio mTLS analysis"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get peerauthentication --all-namespaces -o yaml",
              "description": "Kubernetes mTLS policies"
            }
          ]
        }
      ]
    },
    "KSI-SVC-03": {
      "name": "Data Encryption",
      "evidence": [
        {
          "type": "configuration",
          "description": "Data-at-rest encryption",
          "tip": "All data stores must be encrypted. Use customer-managed keys (CMEK) for FedRAMP High. Verify encryption covers databases, file storage, backups, and logs.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud sql instances list --format='table(name,settings.ipConfiguration.requireSsl,settings.dataDiskSizeGb)'",
              "description": "GCP Cloud SQL encryption (default encrypted)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/sql/instances/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud storage buckets describe gs://<bucket> --format='value(encryption)'",
              "description": "GCP Cloud Storage CMEK configuration",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/storage/buckets/describe/gs://<bucket>"
            },
            {
              "provider": "gcp",
              "command": "gcloud kms keys list --location=<location> --keyring=<keyring> --format='table(name,purpose,primary.state)'",
              "description": "GCP Cloud KMS keys",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/kms/keys/list"
            },
            {
              "provider": "aws",
              "command": "aws rds describe-db-instances --query 'DBInstances[].{id:DBInstanceIdentifier,encrypted:StorageEncrypted}'",
              "description": "RDS encryption status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/rds/describe-db-instances.html"
            },
            {
              "provider": "aws",
              "command": "aws s3api get-bucket-encryption --bucket <bucket>",
              "description": "S3 encryption configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/s3api/get-bucket-encryption.html"
            },
            {
              "provider": "azure",
              "command": "az storage account show --name <account> --query 'encryption'",
              "description": "Azure storage encryption",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/storage"
            },
            {
              "provider": "veracode",
              "api": "api.veracode.com/appsec/v1/applications",
              "description": "Veracode application inventory",
              "docsUrl": "https://docs.veracode.com/r/c_apps_intro"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Data store encryption inventory",
          "tip": "Maintain inventory of all data stores with encryption status. Any unencrypted data store is a compliance gap. Include ephemeral storage and caches.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-resources --asset-types='sqladmin.googleapis.com/Instance,storage.googleapis.com/Bucket,compute.googleapis.com/Disk'",
              "description": "GCP data store inventory",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-resources"
            },
            {
              "provider": "aws",
              "command": "aws resourcegroupstaggingapi get-resources --tag-filters Key=DataClassification",
              "description": "AWS tagged data resources",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/resourcegroupstaggingapi/get-resources.html"
            },
            {
              "provider": "veracode",
              "api": "api.veracode.com/appsec/v1/applications",
              "description": "Veracode application inventory",
              "docsUrl": "https://docs.veracode.com/r/c_apps_intro"
            }
          ]
        }
      ]
    },
    "KSI-SVC-04": {
      "name": "Configuration Automation",
      "evidence": [
        {
          "type": "configuration",
          "description": "Configuration management automation",
          "tip": "100% of systems should be under configuration management. No manual configuration changes. Verify drift detection is enabled and alerts on changes.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instances list --format='table(name,metadata.items[0].value)'",
              "description": "GCP VM metadata (startup scripts)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud deployment-manager deployments list --format='table(name,operation.status)'",
              "description": "GCP Deployment Manager deployments",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/deployment-manager/deployments/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud config configurations list",
              "description": "GCP config configurations",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/config/configurations/list"
            },
            {
              "provider": "ansible",
              "command": "ansible-inventory --list",
              "description": "Ansible managed inventory"
            },
            {
              "provider": "aws",
              "command": "aws ssm describe-instance-information",
              "description": "SSM managed instances",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-information.html"
            },
            {
              "provider": "azure",
              "command": "az vm run-command list --resource-group <rg> --vm-name <vm>",
              "description": "Azure VM run commands (automation)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "azure",
              "command": "az automation account list --query '[].{name:name,state:state}'",
              "description": "Azure Automation accounts",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/automation"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Compute/virtualMachines?api-version=2023-09-01",
              "description": "Azure VM configuration API"
            },
            {
              "provider": "puppet",
              "api": "/pdb/query/v4/nodes",
              "description": "Puppet managed nodes"
            }
          ]
        },
        {
          "type": "log",
          "description": "Configuration drift detection",
          "tip": "Monitor for configuration drift. Any manual changes should be flagged and reverted. Track compliance percentage over time.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"compute.instances.setMetadata\" OR \"compute.instances.setTags\")' --format=json",
              "description": "GCP VM configuration change audit",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws config get-compliance-details-by-config-rule --config-rule-name <rule>",
              "description": "AWS Config compliance details",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/config/get-compliance-details-by-config-rule.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --resource-type Microsoft.Compute/virtualMachines --query '[?contains(operationName.value, `write`)].{time:eventTimestamp,operation:operationName.localizedValue}'",
              "description": "Azure VM configuration change audit",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az policy state list --filter \"complianceState eq 'NonCompliant'\" --query '[].{resource:resourceId,policy:policyDefinitionName}'",
              "description": "Azure Policy drift detection",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/policy"
            },
            {
              "provider": "chef",
              "api": "/compliance/reporting/nodes",
              "description": "Chef InSpec compliance reports"
            }
          ]
        }
      ]
    },
    "KSI-SVC-05": {
      "name": "Resource Integrity",
      "evidence": [
        {
          "type": "scan",
          "description": "File and resource integrity monitoring",
          "tip": "FIM should cover critical system files, binaries, and configurations. Alert on any unexpected changes. Container images should be immutable and verified with signatures.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instances describe <instance> --format='value(shieldedInstanceConfig)'",
              "description": "GCP Shielded VM integrity monitoring",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/describe"
            },
            {
              "provider": "gcp",
              "command": "gcloud container images describe <image> --format='value(image_summary.fully_qualified_digest)'",
              "description": "GCP container image digest verification",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/images/describe"
            },
            {
              "provider": "gcp",
              "api": "binaryauthorization.googleapis.com/v1/projects/{project}/policy",
              "description": "GCP Binary Authorization policy"
            },
            {
              "provider": "aws",
              "command": "aws configservice get-resource-config-history --resource-type AWS::EC2::Instance --resource-id <id>",
              "description": "AWS Config resource history",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/configservice/get-resource-config-history.html"
            },
            {
              "provider": "azure",
              "command": "az vm show --name <vm> --resource-group <rg> --query '{integrityMonitoring:securityProfile}'",
              "description": "Azure VM integrity monitoring status",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "azure",
              "command": "az acr manifest list-metadata --registry <registry> --name <repo> --query '[].{digest:digest,createdTime:createdTime}'",
              "description": "Azure ACR container image digests",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.ContainerRegistry/registries/{registry}/webhooks",
              "description": "Azure ACR webhooks for image verification"
            },
            {
              "provider": "tripwire",
              "api": "/api/v1/elements",
              "description": "Tripwire element status"
            },
            {
              "provider": "ossec",
              "artifact": "OSSEC syscheck reports"
            },
            {
              "provider": "sigstore",
              "command": "cosign verify <image>",
              "description": "Sigstore container signature verification"
            }
          ]
        },
        {
          "type": "log",
          "description": "Integrity violation alerts",
          "tip": "Track integrity alerts over time. Any alert should trigger investigation. Repeated alerts on same resource indicate potential compromise or misconfiguration.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'resource.type=\"gce_instance\" AND jsonPayload.event_type=\"integrity_violation\"'",
              "description": "GCP Shielded VM integrity violation logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws guardduty list-findings --detector-id <id> --finding-criteria '{\"Criterion\":{\"type\":{\"Eq\":[\"Persistence:IAMUser/UserPermissions\"]}}}'",
              "description": "AWS GuardDuty persistence findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/guardduty/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az security alert list --query '[?contains(alertType, `Integrity`)].{name:alertDisplayName,severity:severity,status:status}'",
              "description": "Azure Defender integrity alerts",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --resource-type Microsoft.Compute/virtualMachines --query '[?operationName.value==`Microsoft.Compute/virtualMachines/write`]'",
              "description": "Azure VM modification audit",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "crowdstrike",
              "api": "/detects/queries/detects/v1",
              "description": "CrowdStrike detection events"
            }
          ]
        }
      ]
    },
    "KSI-SVC-06": {
      "name": "Secret Management",
      "evidence": [
        {
          "type": "configuration",
          "description": "Secret management policy and rotation settings",
          "tip": "Verify automatic rotation is enabled. For high-impact systems, secrets should rotate at least every 90 days. Service account keys should rotate more frequently (30-60 days).",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud secrets list --format='table(name,replication.automatic,rotation.nextRotationTime,rotation.rotationPeriod)'",
              "description": "GCP Secret Manager with rotation config",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/secrets/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud secrets describe <secret> --format='value(rotation)'",
              "description": "GCP secret rotation policy details",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/secrets/describe"
            },
            {
              "provider": "aws",
              "command": "aws secretsmanager describe-secret --secret-id <id> --query '{Name:Name,RotationEnabled:RotationEnabled,RotationRules:RotationRules}'",
              "description": "AWS Secrets Manager rotation config",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/secretsmanager/describe-secret.html"
            },
            {
              "provider": "azure",
              "command": "az keyvault secret show --vault-name <vault> --name <secret> --query '{expires:attributes.expires,enabled:attributes.enabled}'",
              "description": "Key Vault secret attributes",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "hashicorp",
              "api": "/v1/sys/mounts/<mount>/tune",
              "description": "Vault mount configuration and TTL settings"
            },
            {
              "provider": "cyberark",
              "api": "/PasswordVault/api/Safes/<safe>/Members",
              "description": "CyberArk safe membership and permissions"
            },
            {
              "provider": "veracode",
              "api": "analysiscenter.veracode.com/api/5.0/getbuildinfo.do",
              "description": "Veracode scan build info",
              "docsUrl": "https://docs.veracode.com/r/c_build_intro"
            }
          ]
        },
        {
          "type": "log",
          "description": "Secret access and rotation audit logs",
          "tip": "Monitor for unauthorized access attempts, failed retrievals, and verify rotation events occur on schedule. Alert on any manual secret access by humans (should be rare).",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'resource.type=\"secretmanager.googleapis.com/Secret\" AND protoPayload.methodName:(\"AccessSecretVersion\" OR \"AddSecretVersion\")' --format=json",
              "description": "GCP Secret Manager access logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventSource,AttributeValue=secretsmanager.amazonaws.com --query 'Events[].{Time:EventTime,Event:CloudTrailEvent}'",
              "description": "AWS Secrets Manager CloudTrail events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "hashicorp",
              "api": "/v1/sys/audit",
              "description": "Vault audit logs"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --resource-group <rg> --resource-type Microsoft.KeyVault/vaults --query '[].{time:eventTimestamp,operation:operationName.localizedValue,status:status.localizedValue}'",
              "description": "Key Vault activity logs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "veracode",
              "api": "analysiscenter.veracode.com/api/5.0/getbuildinfo.do",
              "description": "Veracode scan build info",
              "docsUrl": "https://docs.veracode.com/r/c_build_intro"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Secret inventory and ownership",
          "tip": "Maintain a complete inventory of all secrets with clear ownership. Identify any secrets that haven't rotated recently or have no defined owner - these are compliance risks.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud secrets list --format='table(name,createTime,labels)'",
              "description": "GCP Secret Manager inventory with labels",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/secrets/list"
            },
            {
              "provider": "aws",
              "command": "aws secretsmanager list-secrets --query 'SecretList[].{Name:Name,LastRotatedDate:LastRotatedDate,Tags:Tags}'",
              "description": "AWS Secrets Manager inventory",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/secretsmanager/list-secrets.html"
            },
            {
              "provider": "azure",
              "command": "az keyvault secret list --vault-name <vault> --query '[].{name:name,created:attributes.created,updated:attributes.updated}'",
              "description": "Key Vault secret inventory",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "hashicorp",
              "api": "/v1/secret/metadata?list=true",
              "description": "Vault secrets list with metadata"
            },
            {
              "provider": "veracode",
              "api": "analysiscenter.veracode.com/api/5.0/getbuildinfo.do",
              "description": "Veracode scan build info",
              "docsUrl": "https://docs.veracode.com/r/c_build_intro"
            }
          ]
        },
        {
          "type": "scan",
          "description": "Secret exposure detection",
          "tip": "Continuously scan for exposed secrets in code, logs, and configuration. Any detected exposure requires immediate rotation and incident response.",
          "sources": [
            {
              "provider": "gcp",
              "api": "securitycenter.googleapis.com/v1/organizations/{org}/sources/-/findings?filter=category=\"SECRETS_IN_SOURCE_CODE\"",
              "description": "GCP Security Command Center secret findings"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/secret-scanning/alerts",
              "description": "GitHub secret scanning alerts"
            },
            {
              "provider": "gitleaks",
              "command": "gitleaks detect --source <repo> --report-format json",
              "description": "Gitleaks secret detection"
            },
            {
              "provider": "trufflehog",
              "command": "trufflehog git file://<repo> --json",
              "description": "TruffleHog secret scanning"
            },
            {
              "provider": "veracode",
              "api": "analysiscenter.veracode.com/api/5.0/getbuildinfo.do",
              "description": "Veracode scan build info",
              "docsUrl": "https://docs.veracode.com/r/c_build_intro"
            }
          ]
        }
      ]
    },
    "KSI-SVC-07": {
      "name": "Patching",
      "evidence": [
        {
          "type": "report",
          "description": "Patch compliance status",
          "tip": "FedRAMP patch SLAs: Critical within 30 days, High within 30 days, Moderate within 90 days. Track percentage of systems at 100% compliance. Containerized workloads need image update tracking.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute instances os-inventory list-instances --format='table(instance,shortName,installedPackages)'",
              "description": "GCP OS inventory for patch status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/instances/os-inventory/list-instances"
            },
            {
              "provider": "gcp",
              "command": "gcloud container images list-tags <image> --format='table(digest,timestamp)'",
              "description": "GCP container image update history",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/container/images/list-tags"
            },
            {
              "provider": "aws",
              "command": "aws ssm describe-instance-patch-states",
              "description": "SSM Patch Manager status",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-patch-states.html"
            },
            {
              "provider": "azure",
              "command": "az vm assess-patches --resource-group <rg> --name <vm>",
              "description": "Azure Update Manager assessment",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "qualys",
              "api": "/api/2.0/fo/scan/compliance/",
              "description": "Qualys patch compliance"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Patch SLA compliance metrics",
          "tip": "Track Mean Time to Patch (MTTP) by severity. Report on percentage meeting SLA and any exceptions. Show trending improvement over time.",
          "sources": [
            {
              "provider": "gcp",
              "api": "osconfig.googleapis.com/v1/projects/{project}/patchJobs",
              "description": "GCP OS Config patch job history"
            },
            {
              "provider": "tenable",
              "api": "/workbenches/assets",
              "description": "Tenable asset patch status"
            },
            {
              "provider": "manual",
              "artifact": "Patch compliance dashboard with SLA tracking"
            }
          ]
        }
      ]
    },
    "KSI-SVC-08": {
      "name": "Shared Resources",
      "evidence": [
        {
          "type": "configuration",
          "description": "Multi-tenant isolation configuration",
          "tip": "Verify strong isolation between tenants. GCP uses projects, AWS uses accounts, K8s uses namespaces+NetworkPolicies. Shared resources need additional controls.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud projects list --format='table(projectId,parent)'",
              "description": "GCP project hierarchy (isolation boundary)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/projects/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud resource-manager folders list --organization=<org>",
              "description": "GCP folder structure for tenant isolation",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/resource-manager/folders/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud compute sole-tenancy node-templates list",
              "description": "GCP sole-tenant nodes (dedicated hardware)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/sole-tenancy/node-templates/list"
            },
            {
              "provider": "aws",
              "command": "aws ec2 describe-instances --query 'Reservations[].Instances[].{id:InstanceId,tenancy:Placement.Tenancy}'",
              "description": "EC2 tenancy configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-instances.html"
            },
            {
              "provider": "azure",
              "command": "az account management-group list --query '[].{name:displayName,id:id}'",
              "description": "Azure management groups (isolation hierarchy)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/account"
            },
            {
              "provider": "azure",
              "command": "az vm list --query '[].{name:name,hostGroup:hostGroup}'",
              "description": "Azure dedicated hosts (tenant isolation)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/vm"
            },
            {
              "provider": "azure",
              "command": "az aks show --resource-group <rg> --name <cluster> --query 'networkProfile'",
              "description": "Azure AKS network isolation",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/aks"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get networkpolicies --all-namespaces -o json",
              "description": "Kubernetes network policies for isolation"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get resourcequotas --all-namespaces -o yaml",
              "description": "Kubernetes resource quotas per namespace"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Tenant isolation architecture",
          "tip": "Document isolation boundaries between tenants. Include network, compute, storage, and data isolation. Shared services should be explicitly called out with additional controls.",
          "sources": [
            {
              "provider": "azure",
              "api": "management.azure.com/providers/Microsoft.Management/managementGroups?api-version=2021-04-01",
              "description": "Azure management group hierarchy API"
            },
            {
              "provider": "manual",
              "artifact": "Multi-tenancy architecture diagram"
            },
            {
              "provider": "manual",
              "artifact": "Shared services risk assessment"
            }
          ]
        }
      ]
    },
    "KSI-SVC-09": {
      "name": "Communication Integrity",
      "evidence": [
        {
          "type": "configuration",
          "description": "Service-to-service communication security",
          "tip": "All internal service communication should use mTLS. Verify mutual authentication (both sides validate certificates). Check for any plaintext internal traffic.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute backend-services list --format='table(name,protocol,securitySettings)'",
              "description": "GCP backend service security settings",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/backend-services/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud anthos auth describe <membership>",
              "description": "GCP Anthos service mesh mTLS status",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/anthos/auth/describe"
            },
            {
              "provider": "istio",
              "command": "istioctl proxy-config cluster <pod>",
              "description": "Istio service mesh mTLS"
            },
            {
              "provider": "aws",
              "command": "aws appmesh describe-virtual-service --mesh-name <mesh> --virtual-service-name <svc>",
              "description": "App Mesh TLS configuration",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/appmesh/describe-virtual-service.html"
            },
            {
              "provider": "azure",
              "command": "az aks show --resource-group <rg> --name <cluster> --query 'serviceMeshProfile'",
              "description": "Azure AKS service mesh profile",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/aks"
            },
            {
              "provider": "azure",
              "command": "az network application-gateway ssl-policy show --gateway-name <gw> --resource-group <rg>",
              "description": "Azure Application Gateway SSL/TLS policy",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/resourceGroups/{rg}/providers/Microsoft.ServiceFabric/clusters/{cluster}?api-version=2023-11-01-preview",
              "description": "Azure Service Fabric cluster security settings"
            },
            {
              "provider": "kubernetes",
              "command": "kubectl get peerauthentication --all-namespaces -o json",
              "description": "Istio PeerAuthentication policies"
            },
            {
              "provider": "linkerd",
              "command": "linkerd viz stat deploy -n <namespace>",
              "description": "Linkerd mTLS status"
            },
            {
              "provider": "zscaler",
              "api": "/webApplicationRules",
              "description": "Zscaler ZIA web application rules"
            },
            {
              "provider": "zscaler",
              "api": "/sslInspectionRules",
              "description": "Zscaler SSL inspection policies"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/organizations/{orgId}/security",
              "description": "Webex security settings",
              "docsUrl": "https://developer.webex.com/docs/api/v1/organization-settings"
            }
          ]
        },
        {
          "type": "scan",
          "description": "Internal traffic encryption verification",
          "tip": "Periodically verify no plaintext internal traffic. Network captures should show only encrypted payloads between services.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud compute packet-mirrorings list",
              "description": "GCP packet mirroring for traffic analysis",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/compute/packet-mirrorings/list"
            },
            {
              "provider": "azure",
              "command": "az network watcher packet-capture list --query '[].{name:name,target:target}'",
              "description": "Azure Network Watcher packet capture",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "azure",
              "command": "az network watcher flow-log list --location <location> --query '[].{name:name,enabled:enabled}'",
              "description": "Azure NSG flow logs for traffic analysis",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/network"
            },
            {
              "provider": "istio",
              "command": "istioctl analyze --all-namespaces",
              "description": "Istio configuration analysis for mTLS gaps"
            },
            {
              "provider": "webex",
              "api": "webexapis.com/v1/organizations/{orgId}/security",
              "description": "Webex security settings",
              "docsUrl": "https://developer.webex.com/docs/api/v1/organization-settings"
            }
          ]
        }
      ]
    },
    "KSI-SVC-10": {
      "name": "Data Destruction",
      "evidence": [
        {
          "type": "log",
          "description": "Data deletion records",
          "tip": "Maintain audit trail of all data deletion requests and completions. Include requestor, approval, execution, and verification. Cryptographic erasure may be used for encrypted data.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.methodName:(\"storage.objects.delete\" OR \"bigquery.tables.delete\")' --format=json",
              "description": "GCP data deletion audit logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "gcp",
              "command": "gcloud kms keys versions destroy <version> --key=<key> --keyring=<ring> --location=<location>",
              "description": "GCP crypto-shredding via key destruction",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/kms/keys/versions/destroy"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=EventName,AttributeValue=DeleteObject",
              "description": "S3 deletion events",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?contains(operationName.value, `delete`)].{time:eventTimestamp,resource:resourceId,operation:operationName.localizedValue}'",
              "description": "Azure data deletion audit logs",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az keyvault key delete --vault-name <vault> --name <key>",
              "description": "Azure Key Vault key deletion (crypto-shredding)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/keyvault"
            },
            {
              "provider": "azure",
              "command": "az storage blob delete-batch --source <container> --account-name <account> --dryrun",
              "description": "Azure blob deletion (dry run for verification)",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/storage"
            },
            {
              "provider": "manual",
              "artifact": "Data destruction certificates"
            },
            {
              "provider": "manual",
              "artifact": "Customer data deletion request logs"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Data destruction procedures",
          "tip": "Document data destruction procedures including media sanitization, verification, and certificate issuance. Procedures should cover all data locations including backups.",
          "sources": [
            {
              "provider": "manual",
              "artifact": "Data destruction policy and procedures"
            },
            {
              "provider": "manual",
              "artifact": "Backup data retention and destruction schedule"
            }
          ]
        }
      ]
    },
    "KSI-TPR-01": {
      "name": "Third-Party Dependencies",
      "evidence": [
        {
          "type": "inventory",
          "description": "Third-party service inventory",
          "tip": "Maintain complete inventory of all third-party services, APIs, and SaaS. Include data classification for each (what data they access). FedRAMP requires vendors to be authorized or have equivalent security.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud services list --enabled --format='table(config.name,config.title)'",
              "description": "GCP enabled APIs (third-party integrations)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/services/list"
            },
            {
              "provider": "gcp",
              "command": "gcloud iam service-accounts list --filter='email:*gserviceaccount.com' --format='table(email,displayName)'",
              "description": "GCP service accounts (potential third-party access)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/list"
            },
            {
              "provider": "aws",
              "command": "aws iam list-open-id-connect-providers",
              "description": "AWS OIDC providers (third-party identity federation)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-open-id-connect-providers.html"
            },
            {
              "provider": "aws",
              "command": "aws lambda list-functions --query 'Functions[].{name:FunctionName,runtime:Runtime}'",
              "description": "AWS Lambda functions (potential third-party integrations)",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/lambda/list-functions.html"
            },
            {
              "provider": "azure",
              "command": "az ad app list --filter=\"publisherDomain ne 'your-tenant.onmicrosoft.com'\" --query '[].{name:displayName,id:appId}'",
              "description": "Azure third-party app registrations",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "azure",
              "command": "az provider list --query '[?registrationState==`Registered`].{namespace:namespace}'",
              "description": "Azure registered resource providers",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/provider"
            },
            {
              "provider": "manual",
              "artifact": "Third-party vendor inventory"
            },
            {
              "provider": "manual",
              "artifact": "Vendor risk assessments"
            },
            {
              "provider": "saasops",
              "api": "/api/v1/applications",
              "description": "SaaS management platform inventory"
            }
          ]
        },
        {
          "type": "documentation",
          "description": "Third-party security documentation",
          "tip": "For each critical vendor: SOC 2 Type II, FedRAMP authorization status, data processing agreements, and incident notification SLAs.",
          "sources": [
            {
              "provider": "manual",
              "artifact": "Vendor SOC 2 reports"
            },
            {
              "provider": "manual",
              "artifact": "Data Processing Agreements (DPAs)"
            },
            {
              "provider": "fedramp",
              "artifact": "FedRAMP Marketplace authorization status"
            }
          ]
        }
      ]
    },
    "KSI-TPR-02": {
      "name": "Third-Party Access",
      "evidence": [
        {
          "type": "configuration",
          "description": "Third-party access controls",
          "tip": "Third-party access should follow least privilege. Use dedicated service accounts, not shared credentials. Implement JIT access where possible. Review and recertify quarterly.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud asset search-all-iam-policies --query='policy.bindings.members:*@*.iam.gserviceaccount.com' --format=json",
              "description": "GCP IAM bindings with external service accounts",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/asset/search-all-iam-policies"
            },
            {
              "provider": "gcp",
              "command": "gcloud iam workload-identity-pools list --location=global --format='table(name,state)'",
              "description": "GCP Workload Identity pools (external identity federation)",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/list"
            },
            {
              "provider": "aws",
              "command": "aws iam list-roles --query 'Roles[?contains(AssumeRolePolicyDocument,`sts:AssumeRole`)]'",
              "description": "Cross-account IAM roles",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/iam/list-roles.html"
            },
            {
              "provider": "okta",
              "api": "/api/v1/apps",
              "description": "Third-party app integrations",
              "docsUrl": "https://developer.okta.com/docs/reference/api/apps/"
            },
            {
              "provider": "azure",
              "command": "az ad sp list --filter=\"servicePrincipalType eq 'Application'\" --query '[].{name:displayName,id:appId}'",
              "description": "Azure third-party service principals",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "box",
              "api": "api.box.com/2.0/collaborations",
              "description": "Box external collaborations",
              "docsUrl": "https://developer.box.com/reference/get-collaborations/"
            }
          ]
        },
        {
          "type": "log",
          "description": "Third-party access audit",
          "tip": "Monitor all third-party access activity. Alert on unusual patterns or access outside expected hours. Track data accessed by each vendor.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud logging read 'protoPayload.authenticationInfo.principalEmail:*gserviceaccount.com' --format=json",
              "description": "GCP service account activity logs",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/logging/read"
            },
            {
              "provider": "aws",
              "command": "aws cloudtrail lookup-events --lookup-attributes AttributeKey=Username,AttributeValue=<third-party-role>",
              "description": "AWS third-party role activity",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/cloudtrail/lookup-events.html"
            },
            {
              "provider": "azure",
              "command": "az monitor activity-log list --query '[?authorization.scope contains `Microsoft.Authorization`].{time:eventTimestamp,caller:caller,action:authorization.action}'",
              "description": "Azure third-party access audit",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/monitor"
            },
            {
              "provider": "azure",
              "command": "az ad audit sign-in list --filter=\"appDisplayName ne 'Internal App'\" --query '[].{user:userPrincipalName,app:appDisplayName,time:createdDateTime}'",
              "description": "Azure AD third-party app sign-ins",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/ad"
            },
            {
              "provider": "box",
              "api": "api.box.com/2.0/collaborations",
              "description": "Box external collaborations",
              "docsUrl": "https://developer.box.com/reference/get-collaborations/"
            }
          ]
        }
      ]
    },
    "KSI-TPR-03": {
      "name": "Supply Chain Risk Management",
      "evidence": [
        {
          "type": "report",
          "description": "Vendor security assessments",
          "tip": "Assess vendors based on data sensitivity and criticality. Critical vendors need annual security reviews. Use standardized questionnaires (SIG, CAIQ) for consistency.",
          "sources": [
            {
              "provider": "gcp",
              "api": "assuredworkloads.googleapis.com/v1/organizations/{org}/locations/{location}/workloads",
              "description": "GCP Assured Workloads compliance status"
            },
            {
              "provider": "aws",
              "command": "aws artifact list-reports --query 'reports[?category==`COMPLIANCE_REPORTS`]'",
              "description": "AWS Artifact compliance reports",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/artifact/list-reports.html"
            },
            {
              "provider": "azure",
              "command": "az security regulatory-compliance-standards list --query '[].{name:name,state:state}'",
              "description": "Azure regulatory compliance standards",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/providers/Microsoft.Security/regulatoryComplianceStandards?api-version=2019-01-01-preview",
              "description": "Azure compliance standards API"
            },
            {
              "provider": "securityscorecard",
              "api": "/portfolios/{id}/companies",
              "description": "SecurityScorecard vendor ratings"
            },
            {
              "provider": "bitsight",
              "api": "/ratings/v1/companies",
              "description": "BitSight vendor ratings"
            },
            {
              "provider": "manual",
              "artifact": "Vendor security questionnaire responses"
            },
            {
              "provider": "manual",
              "artifact": "Vendor SOC 2 Type II reports"
            }
          ]
        },
        {
          "type": "metrics",
          "description": "Vendor risk metrics",
          "tip": "Track vendor risk scores over time. Require remediation plans for vendors below threshold. Report on percentage of vendors with current assessments.",
          "sources": [
            {
              "provider": "securityscorecard",
              "api": "/portfolios/{id}/scores/history",
              "description": "SecurityScorecard score history"
            },
            {
              "provider": "manual",
              "artifact": "Vendor risk dashboard"
            }
          ]
        }
      ]
    },
    "KSI-TPR-04": {
      "name": "Supply Chain Risk Monitoring",
      "evidence": [
        {
          "type": "scan",
          "description": "Dependency vulnerability monitoring",
          "tip": "Scan all dependencies continuously. Block builds with critical vulnerabilities. Generate SBOMs for all releases. Track transitive dependencies.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud artifacts docker images list <repo> --include-tags --show-occurrences",
              "description": "GCP Artifact Registry vulnerability occurrences",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/docker/images/list"
            },
            {
              "provider": "gcp",
              "api": "containeranalysis.googleapis.com/v1/projects/{project}/occurrences?filter=kind=\"PACKAGE_VULNERABILITY\"",
              "description": "GCP Container Analysis vulnerabilities"
            },
            {
              "provider": "aws",
              "command": "aws ecr describe-image-scan-findings --repository-name <repo> --image-id imageTag=<tag>",
              "description": "AWS ECR image scan findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/ecr/describe-image-scan-findings.html"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 list-findings --filter-criteria '{\"findingType\":[{\"comparison\":\"EQUALS\",\"value\":\"PACKAGE_VULNERABILITY\"}]}'",
              "description": "AWS Inspector package vulnerabilities",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az acr task list --registry <registry> --query '[?name contains `scan`]'",
              "description": "Azure ACR vulnerability scan tasks",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "azure",
              "command": "az security sub-assessment list --assessed-resource-id <registry-id> --query '[].{name:displayName,severity:status.severity}'",
              "description": "Azure container vulnerability assessments",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/security"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/dependabot/alerts",
              "description": "Dependabot alerts"
            },
            {
              "provider": "snyk",
              "api": "/org/{orgId}/projects",
              "description": "Snyk project vulnerabilities"
            },
            {
              "provider": "dependencycheck",
              "command": "dependency-check --scan . --format JSON",
              "description": "OWASP Dependency-Check scan"
            },
            {
              "provider": "syft",
              "command": "syft <image> -o spdx-json",
              "description": "Syft SBOM generation"
            }
          ]
        },
        {
          "type": "inventory",
          "description": "Software Bill of Materials (SBOM)",
          "tip": "Generate SBOM for every release. Include all direct and transitive dependencies. Store SBOMs for incident response and vulnerability triage.",
          "sources": [
            {
              "provider": "gcp",
              "command": "gcloud artifacts sbom export --uri=<image>",
              "description": "GCP Artifact Registry SBOM export",
              "docsUrl": "https://cloud.google.com/sdk/gcloud/reference/artifacts/sbom/export"
            },
            {
              "provider": "aws",
              "command": "aws inspector2 list-findings --filter-criteria '{\"findingType\":[{\"comparison\":\"EQUALS\",\"value\":\"SBOM\"}]}'",
              "description": "AWS Inspector SBOM findings",
              "docsUrl": "https://docs.aws.amazon.com/cli/latest/reference/inspector2/list-findings.html"
            },
            {
              "provider": "azure",
              "command": "az acr manifest list-metadata --registry <registry> --name <repo> --query '[].{digest:digest,tags:tags}'",
              "description": "Azure ACR image manifest metadata",
              "docsUrl": "https://learn.microsoft.com/en-us/cli/azure/acr"
            },
            {
              "provider": "azure",
              "api": "management.azure.com/subscriptions/{sub}/providers/Microsoft.Security/softwareInventories?api-version=2021-05-01-preview",
              "description": "Azure Defender for Cloud software inventory"
            },
            {
              "provider": "cyclonedx",
              "command": "cyclonedx-cli analyze --input-file <manifest>",
              "description": "CycloneDX SBOM"
            },
            {
              "provider": "github",
              "api": "/repos/{owner}/{repo}/dependency-graph/sbom",
              "description": "GitHub SBOM export"
            }
          ]
        }
      ]
    }
  }
}
